<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.246">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Univariate TS Models (ARIMA/SARIMA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><a href="https://samikshathikekar.georgetown.domains/time-series-project-website/_site/intro.html">DSAN-5600 PROJECT</a></span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://samikshathikekar.georgetown.domains/time-series-project-layout/_site/">
 <span class="menu-text">Author</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://samikshathikekar.georgetown.domains/time-series-project-layout/_site/ts.html">
 <span class="menu-text">Time Series Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./intro.qmd">
 <span class="menu-text">Time Series Project</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Univariate TS Models (ARIMA/SARIMA)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasrc.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataviz.html" class="sidebar-item-text sidebar-link">Data Visualization</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">Exploratory Data Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./univariate.html" class="sidebar-item-text sidebar-link active">Univariate TS Models (ARIMA / SARIMA)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate.html" class="sidebar-item-text sidebar-link">Multivariate TS Models (ARIMAX / SARIMAX / VAR)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial.html" class="sidebar-item-text sidebar-link">Financial TS Models (ARCH / GARCH)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dl.html" class="sidebar-item-text sidebar-link">Deep Learning for TS</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">Conclusions / Discussion</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#arima-modeling" id="toc-arima-modeling" class="nav-link active" data-scroll-target="#arima-modeling">ARIMA Modeling</a>
  <ul class="collapse">
  <li><a href="#acf-and-pcf-plots" id="toc-acf-and-pcf-plots" class="nav-link" data-scroll-target="#acf-and-pcf-plots">ACF and PCF Plots</a></li>
  <li><a href="#differencing" id="toc-differencing" class="nav-link" data-scroll-target="#differencing">Differencing</a></li>
  <li><a href="#adjusted-dickey-fuller-test" id="toc-adjusted-dickey-fuller-test" class="nav-link" data-scroll-target="#adjusted-dickey-fuller-test">Adjusted Dickey-Fuller Test</a></li>
  <li><a href="#model-parameter-selection" id="toc-model-parameter-selection" class="nav-link" data-scroll-target="#model-parameter-selection">Model Parameter Selection</a></li>
  <li><a href="#auto-arima" id="toc-auto-arima" class="nav-link" data-scroll-target="#auto-arima">Auto ARIMA</a></li>
  <li><a href="#model-selection-fitting" id="toc-model-selection-fitting" class="nav-link" data-scroll-target="#model-selection-fitting">Model Selection &amp; Fitting</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#final-model-fitting" id="toc-final-model-fitting" class="nav-link" data-scroll-target="#final-model-fitting">Final Model Fitting</a></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting</a></li>
  <li><a href="#arima-vs.-benchmark-methods." id="toc-arima-vs.-benchmark-methods." class="nav-link" data-scroll-target="#arima-vs.-benchmark-methods.">ARIMA vs.&nbsp;benchmark methods.</a></li>
  </ul></li>
  <li><a href="#sarima-modeling" id="toc-sarima-modeling" class="nav-link" data-scroll-target="#sarima-modeling">SARIMA Modeling</a>
  <ul class="collapse">
  <li><a href="#seasonal-time-series" id="toc-seasonal-time-series" class="nav-link" data-scroll-target="#seasonal-time-series">Seasonal Time Series</a></li>
  <li><a href="#model-selection-fitting-1" id="toc-model-selection-fitting-1" class="nav-link" data-scroll-target="#model-selection-fitting-1">Model Selection &amp; Fitting</a></li>
  <li><a href="#model-diagnostics-1" id="toc-model-diagnostics-1" class="nav-link" data-scroll-target="#model-diagnostics-1">Model Diagnostics</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross-Validation</a></li>
  <li><a href="#final-model-fitting-1" id="toc-final-model-fitting-1" class="nav-link" data-scroll-target="#final-model-fitting-1">Final Model Fitting</a></li>
  <li><a href="#sarima-vs.-benchmark-methods" id="toc-sarima-vs.-benchmark-methods" class="nav-link" data-scroll-target="#sarima-vs.-benchmark-methods">SARIMA vs.&nbsp;Benchmark methods</a></li>
  <li><a href="#forecasting-1" id="toc-forecasting-1" class="nav-link" data-scroll-target="#forecasting-1">Forecasting</a></li>
  <li><a href="#seasonal-cross-validation" id="toc-seasonal-cross-validation" class="nav-link" data-scroll-target="#seasonal-cross-validation">Seasonal Cross-Validation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Univariate TS Models (ARIMA/SARIMA)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>On this page, we’re diving into an in-depth exploration of our time series data. We’ll start by examining its stationarity using ACF graphs and the Augmented Dickey-Fuller Test. If our data isn’t stationary, we’ll apply differencing to correct it. Next, we’ll analyze ACF and PACF plots to pinpoint the optimal parameters for our ARIMA model. Once we’ve built the model, we’ll conduct a comprehensive evaluation of the residuals. Additionally, we’ll compare our model with the results from auto.arima() to see how they stack up. Finally, we’ll forecast future values using our model and assess its accuracy against standard benchmark methods, ensuring our analysis is robust and reliable.</p>
<section id="arima-modeling" class="level2">
<h2 class="anchored" data-anchor-id="arima-modeling">ARIMA Modeling</h2>
<section id="acf-and-pcf-plots" class="level3">
<h3 class="anchored" data-anchor-id="acf-and-pcf-plots">ACF and PCF Plots</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)   </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)          </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)   </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>prices<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Henry_Hub_Natural_Gas_Spot_Price.csv"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>prices<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(prices<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> <span class="fu">subset</span>(prices, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(prices)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"prices"</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> prices[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"prices"</span>)]</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>prices_ts <span class="ot">=</span> <span class="fu">ts</span>(prices<span class="sc">$</span>prices, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>), <span class="at">frequency =</span><span class="dv">12</span> )</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>pricesacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(prices_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Prices (Henry Hub)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>pricespacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(prices_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Prices (Henry Hub)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(pricesacf, pricespacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ACF Plot has significant lags from 1-24. PACF Plot has significant lags at 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>consumption_ts <span class="ot">=</span> <span class="fu">ts</span>(consumption<span class="sc">$</span>Consumption, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>consumptionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(consumption_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Consumption "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>consumptionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(consumption_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Consumption "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(consumptionacf, consumptionpacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ACF Plot has significant lags at 1, 2. PACF Plot has significant lags at 1 and 2. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>production_ts <span class="ot">=</span> <span class="fu">ts</span>(production<span class="sc">$</span>Production, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>productionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(production_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Production "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>productionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(production_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Production "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(productionacf, productionpacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ACF Plot has significant lags from 1 to 55. PACF Plot has significant lags at 1 and 2. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>imports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Imports.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>imports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(imports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>imports_ts <span class="ot">=</span> <span class="fu">ts</span>(imports<span class="sc">$</span>Imports, <span class="at">start =</span> <span class="dv">1997</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>importsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(imports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Imports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>importspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(imports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Imports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(importsacf, importspacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the visualization above, it looks like there are significant lags at 1-60, with the first lag being the most pronounced. The PACF plot, on the other hand, shows strong correlation at lag 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</p>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>exports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Exports.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>exports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(exports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>exports_ts <span class="ot">=</span> <span class="fu">ts</span>(exports<span class="sc">$</span>Exports, <span class="at">start =</span> <span class="dv">1997</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>exportsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(exports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Exports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>exportspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(exports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Exports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(exportsacf, exportspacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the visualization above, it looks like there are significant lags at 1-60, with the first lag being the most pronounced. The PACF plot, on the other hand, shows strong correlation at lag 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</p>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.warning4.0"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.yahoo.warning"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tickers <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CVX"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tickers){</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getSymbols</span>(i,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">from =</span> <span class="st">"2000-01-02"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">to =</span> <span class="st">"2022-12-29"</span>)}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"date"</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"value"</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>cvx_stk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(CVX<span class="sc">$</span>CVX.Adjusted)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>cvx_stk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cvx_stk,<span class="fu">rownames</span>(cvx_stk))</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cvx_stk) <span class="ot">&lt;-</span> <span class="fu">append</span>(tickers,<span class="st">'Dates'</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>cvx_stk<span class="sc">$</span>Dates<span class="ot">&lt;-</span><span class="fu">as.Date</span>(cvx_stk<span class="sc">$</span>Dates,<span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>cvx_stk_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(cvx_stk<span class="sc">$</span>CVX, <span class="at">start =</span> <span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2000-01-02"</span>)), <span class="at">frequency =</span> <span class="fl">365.25</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>stocksacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(cvx_stk_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Chevron Corp Stock "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>stockspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(cvx_stk_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Chevron Corp Stock "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(stocksacf, stockspacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the visualization above, it looks like there are significant lags at 1-100. The PACF plot, on the other hand, shows strong correlation at lag 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</p>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/co2_emissions.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(co2_emissions<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>co2_ts <span class="ot">=</span> <span class="fu">ts</span>(co2_emissions<span class="sc">$</span>co2_value, <span class="at">start =</span> <span class="dv">2000</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2023</span>,<span class="dv">11</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>carbonacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(co2_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas CO2 emission"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>carbonpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(co2_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas CO2 emission"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(carbonacf, carbonpacf, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the visualization above, a little autocorrelation at lags 13 in the Autocorrelation Function (ACF) plot is seen. In the Partial Autocorrelation Function (PACF) plot, this close relationship shows up at lag 9, 10, 11, 12 and 13. Seeing this kind of pattern, points to the data being stationary and won’t require further differencing.</p>
</div>
</div>
</div>
</section>
<section id="differencing" class="level3">
<h3 class="anchored" data-anchor-id="differencing">Differencing</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">CVX Stocks</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(prices_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Residential Prices"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pricesacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(prices_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>pricespacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(prices_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (pricesacf <span class="sc">|</span> pricespacf)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary. However, we can see over differencing here.</p>
<p>Here the parameters are d = 0,1 p = 1-4 (PACF Plot) q = 1-4 (ACF Plot)</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(consumption_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Consumption"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>consumptionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(consumption_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>consumptionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(consumption_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (consumptionacf <span class="sc">|</span> consumptionpacf)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</p>
<p>Here the parameters are d = 0,1 p = 1,2,3 (PACF Plot) q = 1 (ACF Plot)</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(production_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Production"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>productionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(production_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>productionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(production_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (productionacf <span class="sc">|</span> productionpacf)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</p>
<p>Here the parameters are d = 0,1 p = 1,2,3,4 (PACF Plot) q = 1 (ACF Plot)</p>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(imports_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Imports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>importsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(imports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>importspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(imports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (importsacf <span class="sc">|</span> importspacf)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</p>
<p>Here the parameters are d = 0,1 p = 1,2 (PACF Plot) q = 1 (ACF Plot)</p>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(exports_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Exports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>exportsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(exports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>exportspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(exports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (exportsacf <span class="sc">|</span> exportspacf)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</p>
<p>Here the parameters are d = 0,1 p = 1 (PACF Plot) q = 1,2 (ACF Plot)</p>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(cvx_stk_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Chevron Corp Stocks"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>stocksacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(cvx_stk_ts),<span class="dv">24</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>stockspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(cvx_stk_ts),<span class="dv">24</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (stocksacf <span class="sc">|</span> stockspacf)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</p>
<p>Here the parameters are d = 0,1 p = 1,2 (PACF Plot) q = 1,2 (ACF Plot)</p>
</div>
</div>
</div>
</section>
<section id="adjusted-dickey-fuller-test" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-dickey-fuller-test">Adjusted Dickey-Fuller Test</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(prices_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(prices_ts)
Dickey-Fuller = -6.7747, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(consumption_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(consumption_ts)
Dickey-Fuller = -7.984, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(production_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(production_ts)
Dickey-Fuller = -7.9263, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(imports_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(imports_ts)
Dickey-Fuller = -8.4953, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(exports_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(exports_ts)
Dickey-Fuller = -10.846, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(cvx_stk_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(cvx_stk_ts)
Dickey-Fuller = -18.023, Lag order = 17, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(co2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  co2_ts
Dickey-Fuller = -10.018, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ADF test shows that the p-value less than 0.05, therefore we can conclude that all the data used for this analysis is stationary. And it also validates all the observations above.</p>
</section>
<section id="model-parameter-selection" class="level3">
<h3 class="anchored" data-anchor-id="model-parameter-selection">Model Parameter Selection</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-7" role="tab" aria-controls="tabset-4-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 1, 2,3,4</p>
<p>d = 0, 1</p>
<p>p = 1,2,3,4</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">32</span>),<span class="at">nrow=</span><span class="dv">32</span>) </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">534.4715</td>
<td style="text-align: right;">551.3479</td>
<td style="text-align: right;">534.7572</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">525.3043</td>
<td style="text-align: right;">538.7868</td>
<td style="text-align: right;">525.4947</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">525.6674</td>
<td style="text-align: right;">545.9191</td>
<td style="text-align: right;">526.0693</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">529.3414</td>
<td style="text-align: right;">546.1946</td>
<td style="text-align: right;">529.6285</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">525.1855</td>
<td style="text-align: right;">548.8125</td>
<td style="text-align: right;">525.7240</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">531.1267</td>
<td style="text-align: right;">551.3506</td>
<td style="text-align: right;">531.5306</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">526.3796</td>
<td style="text-align: right;">553.3819</td>
<td style="text-align: right;">527.0753</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">524.1385</td>
<td style="text-align: right;">547.7329</td>
<td style="text-align: right;">524.6795</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">524.5163</td>
<td style="text-align: right;">544.7680</td>
<td style="text-align: right;">524.9182</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">529.5400</td>
<td style="text-align: right;">546.3932</td>
<td style="text-align: right;">529.8270</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">526.2553</td>
<td style="text-align: right;">549.8822</td>
<td style="text-align: right;">526.7937</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">518.2534</td>
<td style="text-align: right;">538.4773</td>
<td style="text-align: right;">518.6573</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">526.9990</td>
<td style="text-align: right;">554.0013</td>
<td style="text-align: right;">527.6947</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">519.9304</td>
<td style="text-align: right;">543.5249</td>
<td style="text-align: right;">520.4715</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">523.9014</td>
<td style="text-align: right;">554.2789</td>
<td style="text-align: right;">524.7752</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">518.9747</td>
<td style="text-align: right;">545.9398</td>
<td style="text-align: right;">519.6738</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">526.2301</td>
<td style="text-align: right;">549.8570</td>
<td style="text-align: right;">526.7685</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">531.5072</td>
<td style="text-align: right;">551.7310</td>
<td style="text-align: right;">531.9110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">517.5471</td>
<td style="text-align: right;">544.5493</td>
<td style="text-align: right;">518.2427</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">519.8723</td>
<td style="text-align: right;">543.4667</td>
<td style="text-align: right;">520.4133</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">518.3086</td>
<td style="text-align: right;">548.6861</td>
<td style="text-align: right;">519.1824</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">526.0474</td>
<td style="text-align: right;">553.0125</td>
<td style="text-align: right;">526.7464</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">522.0558</td>
<td style="text-align: right;">555.8086</td>
<td style="text-align: right;">523.1290</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">527.9813</td>
<td style="text-align: right;">558.3170</td>
<td style="text-align: right;">528.8593</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">527.8569</td>
<td style="text-align: right;">554.8591</td>
<td style="text-align: right;">528.5526</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">529.2224</td>
<td style="text-align: right;">552.8169</td>
<td style="text-align: right;">529.7635</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">528.5765</td>
<td style="text-align: right;">558.9540</td>
<td style="text-align: right;">529.4502</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">520.9628</td>
<td style="text-align: right;">547.9279</td>
<td style="text-align: right;">521.6618</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">519.3728</td>
<td style="text-align: right;">553.1256</td>
<td style="text-align: right;">520.4460</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">527.0536</td>
<td style="text-align: right;">557.3894</td>
<td style="text-align: right;">527.9317</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">516.2053</td>
<td style="text-align: right;">553.3334</td>
<td style="text-align: right;">517.4994</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">518.3734</td>
<td style="text-align: right;">552.0798</td>
<td style="text-align: right;">519.4518</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
31 4 0 4 516.2053 553.3334 517.4994</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
12 2 1 2 518.2534 538.4773 518.6573</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
31 4 0 4 516.2053 553.3334 517.4994</code></pre>
</div>
</div>
<p>According to the above results the <strong>Best Models are :</strong> ARIMA(4,0,4) and ARIMA(2,1,2) .</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 1</p>
<p>d = 0, 1</p>
<p>p = 1,2,3</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">6</span>),<span class="at">nrow=</span><span class="dv">6</span>) </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5997.884</td>
<td style="text-align: right;">6014.760</td>
<td style="text-align: right;">5998.169</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6010.820</td>
<td style="text-align: right;">6024.303</td>
<td style="text-align: right;">6011.011</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5936.317</td>
<td style="text-align: right;">5956.569</td>
<td style="text-align: right;">5936.719</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5934.341</td>
<td style="text-align: right;">5951.194</td>
<td style="text-align: right;">5934.628</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5951.472</td>
<td style="text-align: right;">5975.099</td>
<td style="text-align: right;">5952.010</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5928.213</td>
<td style="text-align: right;">5948.436</td>
<td style="text-align: right;">5928.616</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 3 1 1 5928.213 5948.436 5928.616</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 3 1 1 5928.213 5948.436 5928.616</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 3 1 1 5928.213 5948.436 5928.616</code></pre>
</div>
</div>
<p>According to the above results the <strong>Best Model is :</strong> ARIMA(3,1,1).</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 1</p>
<p>d = 0, 1</p>
<p>p = 1,2,3,4</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">8</span>),<span class="at">nrow=</span><span class="dv">8</span>) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5607.921</td>
<td style="text-align: right;">5624.797</td>
<td style="text-align: right;">5608.207</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5570.284</td>
<td style="text-align: right;">5583.766</td>
<td style="text-align: right;">5570.474</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5597.967</td>
<td style="text-align: right;">5618.219</td>
<td style="text-align: right;">5598.369</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5571.833</td>
<td style="text-align: right;">5588.686</td>
<td style="text-align: right;">5572.120</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5609.138</td>
<td style="text-align: right;">5632.765</td>
<td style="text-align: right;">5609.677</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5573.352</td>
<td style="text-align: right;">5593.575</td>
<td style="text-align: right;">5573.755</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5600.933</td>
<td style="text-align: right;">5627.935</td>
<td style="text-align: right;">5601.628</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5555.680</td>
<td style="text-align: right;">5579.275</td>
<td style="text-align: right;">5556.221</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q     AIC      BIC     AICc
8 4 1 1 5555.68 5579.275 5556.221</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q     AIC      BIC     AICc
8 4 1 1 5555.68 5579.275 5556.221</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q     AIC      BIC     AICc
8 4 1 1 5555.68 5579.275 5556.221</code></pre>
</div>
</div>
<p>According to the above results the <strong>Best Model is :</strong> ARIMA(4,1,1).</p>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 1</p>
<p>d = 0, 1</p>
<p>p = 1,2</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">4</span>) </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7186.709</td>
<td style="text-align: right;">7205.424</td>
<td style="text-align: right;">7186.905</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7137.596</td>
<td style="text-align: right;">7152.555</td>
<td style="text-align: right;">7137.727</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7163.893</td>
<td style="text-align: right;">7186.351</td>
<td style="text-align: right;">7164.168</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7137.858</td>
<td style="text-align: right;">7156.557</td>
<td style="text-align: right;">7138.055</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 7137.596 7152.555 7137.727</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 7137.596 7152.555 7137.727</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 7137.596 7152.555 7137.727</code></pre>
</div>
</div>
<p>According to the above results the <strong>Best Model is :</strong> ARIMA(1,1,1).</p>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 1,2</p>
<p>d = 0, 1</p>
<p>p = 1</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">4</span>) </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">diff</span>(exports_ts),<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7078.048</td>
<td style="text-align: right;">7096.747</td>
<td style="text-align: right;">7078.245</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7062.332</td>
<td style="text-align: right;">7077.278</td>
<td style="text-align: right;">7062.463</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7080.008</td>
<td style="text-align: right;">7102.447</td>
<td style="text-align: right;">7080.285</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7062.534</td>
<td style="text-align: right;">7081.217</td>
<td style="text-align: right;">7062.731</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 7062.332 7077.278 7062.463</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 7062.332 7077.278 7062.463</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 7062.332 7077.278 7062.463</code></pre>
</div>
</div>
<p>According to the above results the <strong>Best Model is :</strong> ARIMA(1,1,1).</p>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 1,2</p>
<p>d = 0, 1</p>
<p>p = 1,2</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">8</span>),<span class="at">nrow=</span><span class="dv">8</span>) </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18058.94</td>
<td style="text-align: right;">18092.25</td>
<td style="text-align: right;">18058.95</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18047.16</td>
<td style="text-align: right;">18073.81</td>
<td style="text-align: right;">18047.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">18063.98</td>
<td style="text-align: right;">18103.96</td>
<td style="text-align: right;">18063.99</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">18048.21</td>
<td style="text-align: right;">18081.53</td>
<td style="text-align: right;">18048.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18067.50</td>
<td style="text-align: right;">18107.48</td>
<td style="text-align: right;">18067.51</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18048.25</td>
<td style="text-align: right;">18081.57</td>
<td style="text-align: right;">18048.26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">18060.33</td>
<td style="text-align: right;">18106.97</td>
<td style="text-align: right;">18060.35</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">18050.38</td>
<td style="text-align: right;">18090.35</td>
<td style="text-align: right;">18050.39</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 18047.16 18073.81 18047.17</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 18047.16 18073.81 18047.17</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 1 1 1 18047.16 18073.81 18047.17</code></pre>
</div>
</div>
<p>According to the above results the <strong>Best Model is :</strong> ARIMA(1,1,1).</p>
</div>
<div id="tabset-4-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-7-tab">
<p>Best Parameters Selected from the ACF/PACF plot.</p>
<p>q = 13</p>
<p>d = 0</p>
<p>p = 9, 10, 11, 12, 13</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">45</span>),<span class="at">nrow=</span><span class="dv">45</span>) </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4123.294</td>
<td style="text-align: right;">4141.592</td>
<td style="text-align: right;">4123.508</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4119.382</td>
<td style="text-align: right;">4141.339</td>
<td style="text-align: right;">4119.682</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4118.255</td>
<td style="text-align: right;">4143.871</td>
<td style="text-align: right;">4118.657</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4118.279</td>
<td style="text-align: right;">4147.555</td>
<td style="text-align: right;">4118.797</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4119.820</td>
<td style="text-align: right;">4152.755</td>
<td style="text-align: right;">4120.470</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4018.293</td>
<td style="text-align: right;">4054.887</td>
<td style="text-align: right;">4019.090</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3988.080</td>
<td style="text-align: right;">4028.334</td>
<td style="text-align: right;">3989.040</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4016.451</td>
<td style="text-align: right;">4060.365</td>
<td style="text-align: right;">4017.590</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">3963.506</td>
<td style="text-align: right;">4011.079</td>
<td style="text-align: right;">3964.839</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4116.750</td>
<td style="text-align: right;">4138.707</td>
<td style="text-align: right;">4117.050</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4033.124</td>
<td style="text-align: right;">4058.740</td>
<td style="text-align: right;">4033.525</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3986.191</td>
<td style="text-align: right;">4015.467</td>
<td style="text-align: right;">3986.709</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4078.157</td>
<td style="text-align: right;">4111.093</td>
<td style="text-align: right;">4078.807</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3924.227</td>
<td style="text-align: right;">3960.822</td>
<td style="text-align: right;">3925.024</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4008.551</td>
<td style="text-align: right;">4048.806</td>
<td style="text-align: right;">4009.511</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4026.254</td>
<td style="text-align: right;">4070.168</td>
<td style="text-align: right;">4027.393</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">3973.050</td>
<td style="text-align: right;">4020.623</td>
<td style="text-align: right;">3974.383</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4110.960</td>
<td style="text-align: right;">4136.576</td>
<td style="text-align: right;">4111.361</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4025.402</td>
<td style="text-align: right;">4054.678</td>
<td style="text-align: right;">4025.920</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3982.143</td>
<td style="text-align: right;">4015.079</td>
<td style="text-align: right;">3982.793</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4068.003</td>
<td style="text-align: right;">4104.598</td>
<td style="text-align: right;">4068.800</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4070.827</td>
<td style="text-align: right;">4111.081</td>
<td style="text-align: right;">4071.787</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4000.836</td>
<td style="text-align: right;">4044.749</td>
<td style="text-align: right;">4001.974</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3921.485</td>
<td style="text-align: right;">3969.058</td>
<td style="text-align: right;">3922.818</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4104.329</td>
<td style="text-align: right;">4133.605</td>
<td style="text-align: right;">4104.847</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4014.453</td>
<td style="text-align: right;">4047.388</td>
<td style="text-align: right;">4015.103</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4058.114</td>
<td style="text-align: right;">4094.709</td>
<td style="text-align: right;">4058.911</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3959.653</td>
<td style="text-align: right;">3999.907</td>
<td style="text-align: right;">3960.613</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3943.570</td>
<td style="text-align: right;">3987.484</td>
<td style="text-align: right;">3944.708</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3998.277</td>
<td style="text-align: right;">4045.850</td>
<td style="text-align: right;">3999.611</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4097.628</td>
<td style="text-align: right;">4130.563</td>
<td style="text-align: right;">4098.278</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3997.889</td>
<td style="text-align: right;">4034.484</td>
<td style="text-align: right;">3998.686</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3999.315</td>
<td style="text-align: right;">4039.570</td>
<td style="text-align: right;">4000.275</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3989.337</td>
<td style="text-align: right;">4033.251</td>
<td style="text-align: right;">3990.476</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3975.231</td>
<td style="text-align: right;">4022.805</td>
<td style="text-align: right;">3976.565</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4088.320</td>
<td style="text-align: right;">4124.914</td>
<td style="text-align: right;">4089.117</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3974.011</td>
<td style="text-align: right;">4014.266</td>
<td style="text-align: right;">3974.971</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4045.323</td>
<td style="text-align: right;">4089.237</td>
<td style="text-align: right;">4046.462</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3970.586</td>
<td style="text-align: right;">4018.159</td>
<td style="text-align: right;">3971.919</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4075.743</td>
<td style="text-align: right;">4115.997</td>
<td style="text-align: right;">4076.703</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3947.457</td>
<td style="text-align: right;">3991.370</td>
<td style="text-align: right;">3948.595</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3957.330</td>
<td style="text-align: right;">4004.903</td>
<td style="text-align: right;">3958.663</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4058.311</td>
<td style="text-align: right;">4102.225</td>
<td style="text-align: right;">4059.450</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4028.919</td>
<td style="text-align: right;">4076.493</td>
<td style="text-align: right;">4030.253</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4033.149</td>
<td style="text-align: right;">4080.722</td>
<td style="text-align: right;">4034.483</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, let’s get the lowest AIC, BIC, AICc</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
24 3 0 7 3921.485 3969.058 3922.818</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
14 2 0 5 3924.227 3960.822 3925.024</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
24 3 0 7 3921.485 3969.058 3922.818</code></pre>
</div>
</div>
<p>According to the above results the <strong>First Best Model is :</strong> ARIMA(3,0,7) and <strong>Next Best Model is :</strong> ARIMA(2,0,5).</p>
</div>
</div>
</div>
</section>
<section id="auto-arima" class="level3">
<h3 class="anchored" data-anchor-id="auto-arima">Auto ARIMA</h3>
<p>Now, let’s find the best model using Auto ARIMA and compare the results to the models found above.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(prices_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: prices_ts 
ARIMA(1,1,1)(2,0,0)[12] 

Coefficients:
          ar1     ma1     sar1     sar2
      -0.9618  0.9071  -0.1570  -0.1649
s.e.   0.0728  0.1003   0.0865   0.0996

sigma^2 = 0.6418:  log likelihood = -255.84
AIC=521.68   AICc=521.96   BIC=538.53</code></pre>
</div>
</div>
<p>The superior performance of the ARIMA(1,1,1)(2,0,0)[12] model with drift as compared to the ARIMA(4,0,4) and ARIMA(2,1,2) model could be due to the former’s ability to more effectively capture the seasonality within the dataset. While the ARIMA(4,0,4) and ARIMA(2,1,2) model were decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(consumption_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: consumption_ts 
ARIMA(2,0,3)(2,1,2)[12] with drift 

Coefficients:
          ar1     ar2     ma1      ma2      ma3    sar1     sar2     sma1
      -0.1423  0.8233  0.4830  -0.5788  -0.1284  0.6048  -0.3901  -1.3803
s.e.   0.1536  0.1483  0.1688   0.2451   0.1228  0.1723   0.0885   0.1878
        sma2      drift
      0.5664  4319.2878
s.e.  0.1680   366.7623

sigma^2 = 1.06e+10:  log likelihood = -2648.06
AIC=5318.11   AICc=5319.49   BIC=5354.61</code></pre>
</div>
</div>
<p>The superior performance of the ARIMA(2,0,3)(2,1,2)[12] model with drift as compared to the ARIMA(3,1,1) model could be due to the former’s ability to more effectively capture the seasonality within the dataset. While the ARIMA(3,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(production_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: production_ts 
ARIMA(0,1,1)(1,1,1)[12] 

Coefficients:
          ma1     sar1     sma1
      -0.2318  -0.1148  -0.6329
s.e.   0.0806   0.0976   0.0785

sigma^2 = 3.033e+09:  log likelihood = -2506.58
AIC=5021.16   AICc=5021.36   BIC=5034.41</code></pre>
</div>
</div>
<p>The superior performance of the ARIMA(0,1,1)(1,1,1)[12] model with drift as compared to the ARIMA(4,1,1) model could be due to the former’s ability to more effectively capture the seasonality within the dataset. While the ARIMA(4,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</p>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(imports_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: imports_ts 
ARIMA(0,1,3)(1,1,1)[12] 

Coefficients:
          ma1      ma2      ma3    sar1     sma1
      -0.3251  -0.0821  -0.1358  0.1119  -0.8805
s.e.   0.0578   0.0629   0.0633  0.0780   0.0621

sigma^2 = 232480233:  log likelihood = -3309.68
AIC=6631.35   AICc=6631.64   BIC=6653.55</code></pre>
</div>
</div>
<p>The superior performance of the ARIMA(0,1,3)(1,1,1)[12] model with drift as compared to the ARIMA(1,1,1) model could be due to the former’s ability to more effectively capture the seasonality within the dataset. While the ARIMA(1,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</p>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(exports_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: exports_ts 
ARIMA(0,1,1)(1,0,0)[12] 

Coefficients:
          ma1    sar1
      -0.1145  0.5996
s.e.   0.0595  0.0505

sigma^2 = 316782460:  log likelihood = -3486.68
AIC=6979.36   AICc=6979.44   BIC=6990.58</code></pre>
</div>
</div>
<p>The superior performance of the ARIMA(0,1,1)(1,0,0)[12] model with drift as compared to the ARIMA(1,1,1) model could be due to the former’s ability to more effectively capture the seasonality within the dataset. While the ARIMA(1,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</p>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(cvx_stk_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: cvx_stk_ts 
ARIMA(0,1,2) with drift 

Coefficients:
          ma1     ma2   drift
      -0.0394  0.0292  0.0262
s.e.   0.0132  0.0129  0.0150

sigma^2 = 1.325:  log likelihood = -9019.92
AIC=18047.84   AICc=18047.84   BIC=18074.49</code></pre>
</div>
</div>
<p>The best model from the step above was ARIMA(1,1,1), while the best model Auto ARIMA gave me is ARIMA(0,1,2). We see that model from the step above has lower AIC, BIC and AICc than auto ARIMA model. Therefore, we’ll do further analysis to choose the best model.</p>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(co2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: co2_ts 
ARIMA(5,0,1) with non-zero mean 

Coefficients:
         ar1      ar2      ar3      ar4      ar5      ma1      mean
      0.6614  -0.0637  -0.0522  -0.0591  -0.1393  -0.7994  208.6951
s.e.  0.0680   0.0716   0.0724   0.0723   0.0625   0.0377    5.8139

sigma^2 = 101719:  log likelihood = -2058.67
AIC=4133.33   AICc=4133.85   BIC=4162.61</code></pre>
</div>
</div>
<p>The best model from the step above was ARIMA(3,0,7), while the best model Auto ARIMA gave me is ARIMA(5,0,1). We see that model from the step above has lower AIC, BIC and AICc than auto ARIMA model. Therefore, we’ll do further analysis to choose the best model.</p>
</div>
</div>
</div>
</section>
<section id="model-selection-fitting" class="level3">
<h3 class="anchored" data-anchor-id="model-selection-fitting">Model Selection &amp; Fitting</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-7" role="tab" aria-controls="tabset-9-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>The best models selected from the steps above was ARIMA(4,0,4) and ARIMA(2,1,2)</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Model1: ARIMA(4,0,4)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Model2: ARIMA(2,1,2)</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>fit1_prices_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_prices_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: prices_ts 
ARIMA(4,0,4) with drift 

Coefficients:
          ar1      ar2     ar3     ar4     ma1     ma2     ma3     ma4
      -0.0912  -0.0787  0.1295  0.6641  0.9785  1.1009  0.9370  0.1999
s.e.   0.1294   0.1153  0.1130  0.1103  0.1405  0.0901  0.1283  0.0818
      intercept    drift
         6.4281  -0.0171
s.e.     1.0489   0.0082

sigma^2 = 0.5963:  log likelihood = -247.1
AIC=516.21   AICc=517.5   BIC=553.33

Training set error measures:
                      ME      RMSE       MAE      MPE     MAPE      MASE
Training set 0.002023897 0.7541294 0.5065611 -2.23019 11.14678 0.3582668
                    ACF1
Training set 0.008495682</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>fit2_prices_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_prices_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: prices_ts 
ARIMA(2,1,2) with drift 

Coefficients:
          ar1      ar2      ma1     ma2    drift
      -0.0683  -0.8735  -0.0422  0.9555  -0.0038
s.e.   0.0496   0.0630   0.0353  0.0456   0.0526

sigma^2 = 0.6278:  log likelihood = -253.13
AIC=518.25   AICc=518.66   BIC=538.48

Training set error measures:
                        ME      RMSE       MAE       MPE     MAPE      MASE
Training set -0.0005168475 0.7812559 0.5140828 -1.026128 10.96199 0.3635865
                   ACF1
Training set 0.03286363</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>The best model from the steps above was ARIMA(3,1,1)</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>fit_consumption_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_consumption_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: consumption_ts 
ARIMA(3,1,1) with drift 

Coefficients:
         ar1      ar2      ar3     ma1      drift
      1.0200  -0.3582  -0.1971  -1.000  4252.9427
s.e.  0.0681   0.0946   0.0684   0.013   463.5446

sigma^2 = 5.208e+10:  log likelihood = -2958.11
AIC=5928.21   AICc=5928.62   BIC=5948.44

Training set error measures:
                    ME     RMSE      MAE      MPE     MAPE     MASE      ACF1
Training set -13524.57 225013.1 172525.9 -1.68721 7.774267 1.475835 0.0159957</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>The best model from the steps above was ARIMA(4,1,1)</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>fit_production_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_production_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: production_ts 
ARIMA(4,1,1) with drift 

Coefficients:
          ar1      ar2      ar3      ar4     ma1     drift
      -1.3417  -0.9779  -0.6296  -0.3705  0.4865  8237.759
s.e.   0.1044   0.1221   0.1058   0.0631  0.0969  2251.572

sigma^2 = 9.36e+09:  log likelihood = -2770.84
AIC=5555.68   AICc=5556.22   BIC=5579.27

Training set error measures:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set -200.3845 95168.88 66989.42 -0.1899445 2.545294 0.5141142
                   ACF1
Training set 0.02416993</code></pre>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<p>The best model from the steps above was ARIMA(1,1,1)</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fit_imports_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_imports_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: imports_ts 
ARIMA(1,1,1) with drift 

Coefficients:
         ar1      ma1     drift
      0.4842  -0.8693   -9.8334
s.e.  0.0648   0.0312  336.6107

sigma^2 = 533347952:  log likelihood = -3564.8
AIC=7137.6   AICc=7137.73   BIC=7152.56

Training set error measures:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set -91.77133 22945.81 18085.21 -0.6031078 6.369912 0.8085767
                   ACF1
Training set 0.03378889</code></pre>
</div>
</div>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<p>The best model from the steps above was ARIMA(1,1,1)</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>fit_exports_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(exports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_exports_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: exports_ts 
ARIMA(1,1,1) with drift 

Coefficients:
          ar1     ma1      drift
      -0.5499  0.2305  1853.9829
s.e.   0.1236  0.1427   942.7753

sigma^2 = 442299121:  log likelihood = -3535.47
AIC=7078.94   AICc=7079.07   BIC=7093.9

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE      MASE
Training set -1.271411 20895.66 12323.27 -4.178759 11.35464 0.4469031
                     ACF1
Training set -0.001459686</code></pre>
</div>
</div>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<p>The best model from the steps above were ARIMA(1,1,1) and ARIMA(0,1,2)</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Model1: ARIMA(1,1,1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Model2: ARIMA(0,1,2)</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>fit1_cvx_stk_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_cvx_stk_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: cvx_stk_ts 
ARIMA(1,1,1) with drift 

Coefficients:
          ar1     ma1   drift
      -0.5021  0.4579  0.0264
s.e.   0.1233  0.1264  0.0147

sigma^2 = 1.325:  log likelihood = -9019.58
AIC=18047.16   AICc=18047.17   BIC=18073.81

Training set error measures:
                        ME     RMSE       MAE         MPE     MAPE       MASE
Training set -0.0002444368 1.150707 0.6858501 -0.04429528 1.190633 0.05192604
                    ACF1
Training set 0.004498203</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>fit2_cvx_stk_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_cvx_stk_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: cvx_stk_ts 
ARIMA(0,1,2) with drift 

Coefficients:
          ma1     ma2   drift
      -0.0394  0.0292  0.0262
s.e.   0.0132  0.0129  0.0150

sigma^2 = 1.325:  log likelihood = -9019.92
AIC=18047.84   AICc=18047.84   BIC=18074.49

Training set error measures:
                       ME     RMSE       MAE         MPE    MAPE       MASE
Training set 1.805754e-05 1.150774 0.6860782 -0.04283954 1.19083 0.05194331
                      ACF1
Training set -0.0003619028</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-9-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-7-tab">
<p>The best model from the steps above were ARIMA(3,0,7) and ARIMA(5,0,1)</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Model1: ARIMA(3,0,7)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Model2: ARIMA(5,0,1)</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>fit1_co2_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">7</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_co2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: co2_ts 
ARIMA(3,0,7) with drift 

Coefficients:
          ar1      ar2      ar3     ma1     ma2     ma3      ma4      ma5
      -0.4724  -0.8273  -0.7126  0.3851  0.9296  0.6374  -0.4171  -0.7718
s.e.   0.0632   0.0149   0.0632  0.0683  0.0472  0.0628   0.0616   0.0553
          ma6      ma7  intercept   drift
      -0.2811  -0.9555   163.1111  0.3103
s.e.   0.0692   0.0270     5.1354  0.0317

sigma^2 = 43376:  log likelihood = -1947.74
AIC=3921.48   AICc=3922.82   BIC=3969.06

Training set error measures:
                   ME    RMSE      MAE      MPE     MAPE      MASE       ACF1
Training set 1.142359 203.868 141.2986 -38.8954 101.0743 0.7055152 -0.0175251</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>fit2_co2_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_co2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: co2_ts 
ARIMA(5,0,1) with drift 

Coefficients:
         ar1      ar2      ar3      ar4      ar5      ma1  intercept   drift
      0.6507  -0.0685  -0.0586  -0.0642  -0.1826  -0.9140   163.9672  0.3071
s.e.  0.0605   0.0706   0.0715   0.0714   0.0609   0.0205     4.6257  0.0284

sigma^2 = 89155:  log likelihood = -2039.81
AIC=4097.63   AICc=4098.28   BIC=4130.56

Training set error measures:
                     ME     RMSE      MAE       MPE    MAPE      MASE
Training set 0.01146658 294.3975 186.3157 -54.51261 113.047 0.9302892
                    ACF1
Training set -0.03406336</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-6" role="tab" aria-controls="tabset-13-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-7" role="tab" aria-controls="tabset-13-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Model1: ARIMA(4,0,4)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Model2: ARIMA(2,1,2)</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>model_output_p1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(<span class="fu">diff</span>(prices_ts),<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_p1[<span class="dv">213</span><span class="sc">:</span><span class="dv">228</span>], model_output_p1[<span class="fu">length</span>(model_output_p1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
      Estimate     SE  t.value p.value
ar1    -0.8740 0.2420  -3.6107  0.0004
ar2    -0.3581 0.1188  -3.0141  0.0029
ar3    -0.9334 0.0842 -11.0797  0.0000
ar4    -0.6375 0.2451  -2.6014  0.0100
ma1     0.8473 0.2466   3.4368  0.0007
ma2     0.4485 0.1122   3.9964  0.0001
ma3     1.0546 0.0862  12.2306  0.0000
ma4     0.7297 0.2775   2.6301  0.0092
xmean  -0.0019 0.0574  -0.0329  0.9738

sigma^2 estimated as 0.6155658 on 206 degrees of freedom 
 
AIC = 2.461982  AICc = 2.466066  BIC = 2.618756 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>model_output_p2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(<span class="fu">diff</span>(prices_ts),<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_p2[<span class="dv">79</span><span class="sc">:</span><span class="dv">90</span>], model_output_p2[<span class="fu">length</span>(model_output_p2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
ar1        0.0886 0.5553  0.1595  0.8734
ar2        0.0748 0.0768  0.9734  0.3315
ma1       -1.1562 0.5536 -2.0886  0.0380
ma2        0.1562 0.5534  0.2823  0.7780
constant   0.0003 0.0009  0.3732  0.7094

sigma^2 estimated as 0.6587358 on 209 degrees of freedom 
 
AIC = 2.501603  AICc = 2.502951  BIC = 2.595976 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The standard residual plot for both the models looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot for model 1 reveals no correlation, suggesting that the model 1 has captured all the dependencies in the data, leaving no degree of correlation unexplained. The Q-Q plot for both the models suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces most of the values under the 0.05 significance level for both the models, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data. However, the AIC and AICc values for model 1 i.e.&nbsp;ARIMA(4,0,4) is better than model 2 i.e.&nbsp;ARIMA(2,1,2). Hence, ARIMA(4,0,4) is the best model.</p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>model_output_c1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_c1[<span class="dv">50</span><span class="sc">:</span><span class="dv">64</span>], model_output_c1[<span class="fu">length</span>(model_output_c1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
          Estimate       SE  t.value p.value
ar1         1.0200   0.0681  14.9801  0.0000
ar2        -0.3582   0.0946  -3.7886  0.0002
ar3        -0.1971   0.0684  -2.8828  0.0044
ma1        -1.0000   0.0130 -77.0750  0.0000
constant 4252.9427 463.5446   9.1748  0.0000

sigma^2 estimated as 50866377554 on 210 degrees of freedom 
 
AIC = 27.57308  AICc = 27.57442  BIC = 27.66715 
 
 </code></pre>
</div>
</div>
<p>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</p>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>model_output_prod1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_prod1[<span class="dv">39</span><span class="sc">:</span><span class="dv">54</span>], model_output_prod1[<span class="fu">length</span>(model_output_prod1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
          Estimate        SE  t.value p.value
ar1        -1.3417    0.1044 -12.8463   0e+00
ar2        -0.9779    0.1221  -8.0099   0e+00
ar3        -0.6296    0.1058  -5.9510   0e+00
ar4        -0.3705    0.0631  -5.8766   0e+00
ma1         0.4865    0.0969   5.0230   0e+00
constant 8237.7592 2251.5716   3.6587   3e-04

sigma^2 estimated as 9099221908 on 209 degrees of freedom 
 
AIC = 25.84037  AICc = 25.84225  BIC = 25.95012 
 
 </code></pre>
</div>
</div>
<p>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces most of the values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</p>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>model_output_i1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(imports_ts,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_i1[<span class="dv">28</span><span class="sc">:</span><span class="dv">39</span>], model_output_i1[<span class="fu">length</span>(model_output_i1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
         Estimate       SE  t.value p.value
ar1        0.4842   0.0648   7.4731  0.0000
ma1       -0.8693   0.0312 -27.8550  0.0000
constant  -9.8334 336.6107  -0.0292  0.9767

sigma^2 estimated as 528202867 on 308 degrees of freedom 
 
AIC = 22.95047  AICc = 22.95072  BIC = 22.99857 
 </code></pre>
</div>
</div>
<p>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</p>
</div>
<div id="tabset-13-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>model_output_e1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(exports_ts,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_e1[<span class="dv">22</span><span class="sc">:</span><span class="dv">33</span>], model_output_e1[<span class="fu">length</span>(model_output_e1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
          Estimate       SE t.value p.value
ar1        -0.5499   0.1236 -4.4483  0.0000
ma1         0.2305   0.1427  1.6150  0.1073
constant 1853.9829 942.7753  1.9665  0.0501

sigma^2 estimated as 438032570 on 308 degrees of freedom 
 
AIC = 22.76187  AICc = 22.76212  BIC = 22.80997 
 </code></pre>
</div>
</div>
<p>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces most of the values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</p>
</div>
<div id="tabset-13-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-6-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Model1: ARIMA(1,1,1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Model2: ARIMA(0,1,2)</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>model_output_s1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(cvx_stk_ts,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_s1[<span class="dv">21</span><span class="sc">:</span><span class="dv">33</span>], model_output_s1[<span class="fu">length</span>(model_output_s1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
         Estimate     SE t.value p.value
ar1       -0.5021 0.1233 -4.0710  0.0000
ma1        0.4579 0.1264  3.6235  0.0003
constant   0.0264 0.0147  1.7983  0.0722

sigma^2 estimated as 1.324355 on 5781 degrees of freedom 
 
AIC = 3.120187  AICc = 3.120187  BIC = 3.124794 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>model_output_s2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(cvx_stk_ts,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_s2[<span class="dv">15</span><span class="sc">:</span><span class="dv">24</span>], model_output_s2[<span class="fu">length</span>(model_output_s2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
ma1       -0.0394 0.0132 -2.9991  0.0027
ma2        0.0292 0.0129  2.2615  0.0238
constant   0.0262 0.0150  1.7468  0.0807

sigma^2 estimated as 1.32451 on 5781 degrees of freedom 
 
AIC = 3.120303  AICc = 3.120304  BIC = 3.124911 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>For both the models, the Standard Residual Plot looks promising, indicating stationarity with consistent mean and variance across the series. The Autocorrelation Function (ACF) plot presents minimal correlation, suggesting the model has captured the majority of the information in the data, leaving behind what appears to be merely white noise. This is a sign of an appropriate model fit. The Quantile-Quantile (Q-Q) Plot approximates normal distribution, reinforcing the model’s adequacy. Lastly, the Ljung-Box test yields some values exceeding the 0.05 significance level, implying that any remaining correlations in the residuals are not statistically significant, which further supports the model’s suitability. However, the AIC, BIC and AICc values for model 1 i.e.&nbsp;ARIMA(1,1,1) is better than model 2 i.e.&nbsp;ARIMA(0,1,2). Hence, ARIMA(1,1,1) is the best model.</p>
</div>
<div id="tabset-13-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-7-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Model1: ARIMA(3,0,7)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Model2: ARIMA(5,0,1)</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>model_output_ce1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(co2_ts,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_ce1[<span class="dv">57</span><span class="sc">:</span><span class="dv">77</span>], model_output_ce1[<span class="fu">length</span>(model_output_ce1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
      Estimate     SE  t.value p.value
ar1     0.3492 0.0733   4.7602  0.0000
ar2    -0.0203 0.0802  -0.2535  0.8001
ar3    -0.1420 0.0708  -2.0042  0.0460
ma1    -0.3656 0.0473  -7.7354  0.0000
ma2    -0.0197 0.0475  -0.4137  0.6794
ma3     0.0865 0.0456   1.8972  0.0588
ma4     0.0054 0.0396   0.1365  0.8915
ma5     0.1142 0.0410   2.7832  0.0058
ma6     0.5095 0.0382  13.3256  0.0000
ma7    -0.9066 0.0291 -31.1202  0.0000
xmean 209.2478 7.5749  27.6240  0.0000

sigma^2 estimated as 57661.57 on 276 degrees of freedom 
 
AIC = 13.96322  AICc = 13.96657  BIC = 14.11623 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>model_output_ce2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(co2_ts,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_ce2[<span class="dv">36</span><span class="sc">:</span><span class="dv">49</span>], model_output_ce2[<span class="fu">length</span>(model_output_ce2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
      Estimate     SE  t.value p.value
ar1     0.6614 0.0680   9.7219  0.0000
ar2    -0.0637 0.0716  -0.8907  0.3739
ar3    -0.0522 0.0724  -0.7208  0.4717
ar4    -0.0591 0.0723  -0.8172  0.4145
ar5    -0.1393 0.0625  -2.2292  0.0266
ma1    -0.7994 0.0377 -21.2288  0.0000
xmean 208.6951 5.8139  35.8962  0.0000

sigma^2 estimated as 99237.66 on 280 degrees of freedom 
 
AIC = 14.40185  AICc = 14.40325  BIC = 14.50386 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>For both the models, the Standard Residual Plot looks promising, indicating stationarity with consistent mean and variance across the series. The Autocorrelation Function (ACF) plot presents minimal correlation, suggesting the model has captured the majority of the information in the data, leaving behind what appears to be merely white noise. This is a sign of an appropriate model fit. The Quantile-Quantile (Q-Q) Plot approximates near-normal distribution, reinforcing the model’s adequacy. Lastly, the Ljung-Box test yields some values exceeding the 0.05 significance level for model2, implying that any remaining correlations in the residuals are not statistically significant, which further supports the model’s suitability. However, the AIC, BIC and AICc values for model 1 i.e.&nbsp;ARIMA(3,0,7) is better than model 2 i.e.&nbsp;ARIMA(5,0,1). Hence, ARIMA(3,0,7) is the best model.</p>
</div>
</div>
</div>
</section>
<section id="final-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="final-model-fitting">Final Model Fitting</h3>
<p>Here I’ll fit the best model obtained from the above analysis</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-5" role="tab" aria-controls="tabset-14-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-6" role="tab" aria-controls="tabset-14-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-7" role="tab" aria-controls="tabset-14-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>fit_prices <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: prices_ts 
ARIMA(4,0,4) with non-zero mean 

Coefficients:
          ar1      ar2     ar3     ar4     ma1     ma2     ma3     ma4    mean
      -0.0636  -0.0499  0.1538  0.6928  0.9653  1.0853  0.9244  0.1833  4.6011
s.e.   0.1285   0.1163  0.1135  0.1107  0.1406  0.0898  0.1279  0.0811  0.7610

sigma^2 = 0.601:  log likelihood = -248.62
AIC=517.24   AICc=518.31   BIC=550.99

Training set error measures:
                       ME      RMSE       MAE       MPE     MAPE      MASE
Training set -0.009279726 0.7589394 0.5121613 -2.632714 11.30023 0.3622275
                    ACF1
Training set 0.005008433</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= -0.0636x_{t-1}-0.0499x_{t-2}+0.1538x_{t-3}+0.6928x_{t-4}+ w_t+ 0.9653w_{t-1}+1.0853w_{t-2} +0.9244w_{t-3} +0.1833w_{t-4}\)</span></p>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>fit_consumption <span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_consumption)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: consumption_ts 
ARIMA(3,1,1) 

Coefficients:
         ar1      ar2      ar3      ma1
      1.0319  -0.3683  -0.1805  -0.9426
s.e.  0.0695   0.0954   0.0694   0.0172

sigma^2 = 5.56e+10:  log likelihood = -2963.99
AIC=5937.97   AICc=5938.26   BIC=5954.83

Training set error measures:
                   ME     RMSE    MAE       MPE    MAPE     MASE        ACF1
Training set 26124.46 233047.6 179130 0.1997962 7.93188 1.532328 0.007788663</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= 1.0319x_{t-1}-0.3683x_{t-2}-0.1805x_{t-3}+ w_t -0.9426 w_{t-1}\)</span></p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>fit_production <span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_production)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: production_ts 
ARIMA(4,1,1) 

Coefficients:
          ar1      ar2      ar3      ar4     ma1
      -1.3277  -0.9170  -0.5585  -0.3339  0.5135
s.e.   0.1039   0.1217   0.1066   0.0642  0.0928

sigma^2 = 9.867e+09:  log likelihood = -2776.95
AIC=5565.9   AICc=5566.31   BIC=5586.13

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE     MASE        ACF1
Training set 22028.81 97945.77 73544.56 0.6846512 2.767895 0.564422 -0.01775295</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= -1.3277x_{t-1}-0.9170x_{t-2}-0.5585x_{t-3}-0.3339x_{t-4}+ w_t + 0.5135 w_{t-1}\)</span></p>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>fit_imports <span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_imports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: imports_ts 
ARIMA(1,1,1) 

Coefficients:
         ar1      ma1
      0.4841  -0.8693
s.e.  0.0648   0.0312

sigma^2 = 531623633:  log likelihood = -3564.8
AIC=7135.6   AICc=7135.68   BIC=7146.82

Training set error measures:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set -129.5084 22945.85 18087.87 -0.6167255 6.371787 0.8086957
                   ACF1
Training set 0.03376946</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= 0.4841x_{t-1} + w_t -0.8693 w_{t-1}\)</span></p>
</div>
<div id="tabset-14-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>fit_exports <span class="ot">&lt;-</span> <span class="fu">Arima</span>(exports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_exports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: exports_ts 
ARIMA(1,1,1) 

Coefficients:
          ar1     ma1
      -0.5604  0.2505
s.e.   0.1204  0.1387

sigma^2 = 446310196:  log likelihood = -3537.38
AIC=7080.75   AICc=7080.83   BIC=7091.97

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE
Training set 2304.257 21024.24 12413.88 0.3732122 10.45859 0.4501893
                    ACF1
Training set -0.01084399</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= -0.5604x_{t-1} + w_t +0.2505w_{t-1}\)</span></p>
</div>
<div id="tabset-14-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>fit_stocks <span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_stocks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: cvx_stk_ts 
ARIMA(1,1,1) 

Coefficients:
          ar1     ma1
      -0.5014  0.4575
s.e.   0.1239  0.1269

sigma^2 = 1.326:  log likelihood = -9021.17
AIC=18048.33   AICc=18048.34   BIC=18068.32

Training set error measures:
                    ME     RMSE       MAE        MPE     MAPE       MASE
Training set 0.0269576 1.151023 0.6867105 0.02465471 1.191267 0.05199118
                    ACF1
Training set 0.004223936</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= -0.5014x_{t-1} + w_t +0.4575w_{t-1}\)</span></p>
</div>
<div id="tabset-14-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-7-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>fit_co2emissions <span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">7</span>))</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_co2emissions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: co2_ts 
ARIMA(3,0,7) with non-zero mean 

Coefficients:
         ar1      ar2      ar3      ma1      ma2     ma3     ma4     ma5
      0.3492  -0.0203  -0.1420  -0.3656  -0.0197  0.0865  0.0054  0.1142
s.e.  0.0733   0.0802   0.0708   0.0473   0.0475  0.0456  0.0396  0.0410
         ma6      ma7      mean
      0.5095  -0.9066  209.2478
s.e.  0.0382   0.0291    7.5749

sigma^2 = 59960:  log likelihood = -1991.72
AIC=4007.44   AICc=4008.58   BIC=4051.36

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE      MASE
Training set -2.504469 240.1282 153.9421 -54.13229 110.8541 0.7686453
                     ACF1
Training set -0.006218897</code></pre>
</div>
</div>
<p><strong>Equation</strong> <span class="math inline">\(x_t= 0.3492x_{t-1}-0.0203x_{t-2}-0.1420x_{t-3} + w_t -0.3656w_{t-1} -0.0197w_{t-2} +0.0865w_{t-3}+ 0.0054w_{t-4}+ 0.1142w_{t-5}+ 0.5095w_{t-6}-0.9066w_{t-7}\)</span></p>
</div>
</div>
</div>
</section>
<section id="forecasting" class="level3">
<h3 class="anchored" data-anchor-id="forecasting">Forecasting</h3>
<p>Next, we forecast the values and plot the forecasts using the best model selected above.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-5" role="tab" aria-controls="tabset-15-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-6" role="tab" aria-controls="tabset-15-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-7" role="tab" aria-controls="tabset-15-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>pred_prices_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_prices,<span class="dv">15</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_prices_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecasted trend decline downwards. The prediction interval widens as time progresses, which is typical in time series forecasts as uncertainty increases with longer forecast horizons. The model seems to expect the continuation of the cyclical behavior, but with an downward trend in the mean of the series. However, the forecast does not show any sharp increases or decreases, indicating that the model does not anticipate any abrupt changes in the pattern of prices.</p>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>pred_consumption_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_consumption,<span class="dv">15</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_consumption_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecast plot illustrates an initial rise in natural gas consumption, which swiftly dips and then climbs once more. While the model captures the cyclical nature of the demand, it seems to underestimate the magnitude of these seasonal swings. The anticipated peaks in consumption are comparable to or exceed previous levels, indicating the model’s limited ability to fully account for the strength of these seasonal variations.</p>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>pred_production_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_production,<span class="dv">15</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_production_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecast suggests a continued upward trend in production, consistent with the observed increase over the historical period. This aligns with the “with drift” aspect of the model, which typically represents a steady average change over time, rather than a static mean level. The anticipated peaks in production are comparable to or exceed previous levels, indicating the model’s limited ability to fully account for the strength of these seasonal variations.</p>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>pred_imports_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_imports,<span class="dv">15</span>)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_imports_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecast plot predicts a falling trajectory in import data over the forthcoming fifteen-year span. The shaded bands delineate the 95% confidence interval, encapsulating the range within which future data points are expected to fall with a high degree of certainty. However, the forecasted line seems overly smooth, lacking any evident fluctuations. This suggests that the model may not adequately account for potential variability and could be oversimplifying the complex nature of the underlying processes influencing imports.</p>
</div>
<div id="tabset-15-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>pred_exports_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_exports,<span class="dv">15</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_exports_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecast plot predicts a rising trajectory in export data over the forthcoming fifteen-year span. The shaded bands delineate the 95% confidence interval, encapsulating the range within which future data points are expected to fall with a high degree of certainty. However, the forecasted line seems overly smooth, lacking any evident fluctuations. This suggests that the model may not adequately account for potential variability and could be oversimplifying the complex nature of the underlying processes influencing imports.</p>
</div>
<div id="tabset-15-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>pred_cvx_stk_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_stocks,<span class="dv">365</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_cvx_stk_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecast plot predicts a rising trajectory in CVX Stocks data over the forthcoming fifteen-year span. The shaded bands delineate the 95% confidence interval, encapsulating the range within which future data points are expected to fall with a high degree of certainty. However, the forecasted line seems overly smooth, lacking any evident fluctuations. This suggests that the model may not adequately account for potential variability and could be oversimplifying the complex nature of the underlying processes influencing imports.</p>
</div>
<div id="tabset-15-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-7-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>pred_co2_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_co2emissions,<span class="dv">15</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_co2_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The forecast plot projects an ongoing pattern consistent with the historical seasonal trend in CO2 emissions data. While the model replicates the seasonal nature of the post-2020 data, the predicted variations seem to be of a lesser magnitude. Hence, the model appears to underrepresent the full intensity of the seasonal fluctuations observed in the emissions data.</p>
</div>
</div>
</div>
</section>
<section id="arima-vs.-benchmark-methods." class="level3">
<h3 class="anchored" data-anchor-id="arima-vs.-benchmark-methods.">ARIMA vs.&nbsp;benchmark methods.</h3>
<p>This section plots and compares the performance of ARIMA model with the benchmark methods</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-5" role="tab" aria-controls="tabset-16-5" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-6" role="tab" aria-controls="tabset-16-6" aria-selected="false">CVX Stocks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-7" role="tab" aria-controls="tabset-16-7" aria-selected="false">CO2 emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prices_ts) <span class="sc">+</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_prices_ts, </span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Henry Hub Prices ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_prices_ts)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME      RMSE       MAE        MPE     MAPE      MASE
ARIMA -9.279726e-03 0.7589394 0.5121613  -2.632714 11.30023 0.3622275
Meanf  1.517356e-16 2.3123213 1.7996103 -23.725893 46.03433 1.2727795
Naive -2.883721e-03 0.8138242 0.5097674  -1.144999 10.63560 0.3605345
Drift -2.895201e-17 0.8138191 0.5096467  -1.065391 10.62714 0.3604491
              ACF1
ARIMA  0.005008433
Meanf  0.936691654
Naive -0.076051915
Drift -0.076051915</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(consumption_ts) <span class="sc">+</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_consumption_ts, </span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Consumption ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_consumption_ts)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME     RMSE      MAE        MPE     MAPE     MASE        ACF1
ARIMA  2.612446e+04 233047.6 179130.0  0.1997962  7.93188 1.532328 0.007788663
Meanf  2.244115e-10 475539.9 388753.7 -4.5394828 18.15836 3.325507 0.784939243
Naive  3.786088e+03 301268.6 241294.6 -0.7161268 10.68622 2.064101 0.350347620
Drift -3.142357e-11 301244.8 241185.0 -0.8957034 10.68819 2.063164 0.350347620</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(production_ts) <span class="sc">+</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(production_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_production_ts, </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Production ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_production_ts)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(production_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME      RMSE       MAE        MPE      MAPE      MASE
ARIMA  2.202881e+04  97945.77  73544.56  0.6846512  2.767895 0.5644220
Meanf -1.546615e-10 545658.73 456839.53 -4.1435745 17.582835 3.5060416
Naive  7.998926e+03 136882.41 103582.25  0.1519339  3.955783 0.7949480
Drift  1.494482e-10 136648.50 103540.46 -0.1621490  3.957111 0.7946273
             ACF1
ARIMA -0.01775295
Meanf  0.95624518
Naive -0.60115437
Drift -0.60115437</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE, ME and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(imports_ts) <span class="sc">+</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_imports_ts, </span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Imports ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_imports_ts)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME     RMSE      MAE        MPE      MAPE      MASE
ARIMA -1.295084e+02 22945.85 18087.87 -0.6167255  6.371787 0.8086957
Meanf -1.794955e-11 54476.42 46530.12 -3.7116764 16.899929 2.0803278
Naive  4.711254e+01 25084.96 19464.36 -0.3595737  6.791850 0.8702374
Drift  1.225908e-11 25084.91 19464.21 -0.3766501  6.792339 0.8702307
             ACF1
ARIMA  0.03376946
Meanf  0.89426354
Naive -0.18972707
Drift -0.18972707</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE, ME and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
<div id="tabset-16-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exports_ts) <span class="sc">+</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_exports_ts, </span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Exports ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_exports_ts)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME      RMSE       MAE          MPE      MAPE      MASE
ARIMA  2.304257e+03  21024.24  12413.88    0.3732122  10.45859 0.4501893
Meanf  1.042567e-11 162271.31 124173.29 -213.0207422 241.60702 4.5031422
Naive  1.881955e+03  22476.64  12884.71    0.1542360  10.80099 0.4672639
Drift -2.593253e-12  22397.71  12829.33   -3.5443285  11.47689 0.4652556
             ACF1
ARIMA -0.01084399
Meanf  0.97738243
Naive -0.34599428
Drift -0.34599428</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast and Drift benchmark model have similar trajectories for the forecast and follow the trend the best outperforming other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE, ME and MAE values followed by Drift method. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
<div id="tabset-16-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-6-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(cvx_stk_ts) <span class="sc">+</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>),</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>),</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(cvx_stk_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">365</span>),</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_cvx_stk_ts, </span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Chevron Corp Stocks ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_cvx_stk_ts)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>))</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>))</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(cvx_stk_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">365</span>))</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME      RMSE        MAE          MPE      MAPE       MASE
ARIMA  2.695760e-02  1.151023  0.6867105   0.02465471  1.191267 0.05199118
Meanf  2.951653e-15 33.087596 27.3442876 -47.72471755 75.850088 2.07024927
Naive  2.616031e-02  1.152604  0.6876453   0.02383861  1.193310 0.05206196
Drift -1.656820e-15  1.152307  0.6868749  -0.04246424  1.192769 0.05200363
              ACF1
ARIMA  0.004223936
Meanf  0.998301438
Naive -0.041236280
Drift -0.041236280</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
<div id="tabset-16-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-7-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(co2_ts) <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(co2_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_co2_ts, </span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CO2 Emissions from Natural Gas ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_co2_ts)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(co2_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 ME     RMSE      MAE       MPE      MAPE      MASE
ARIMA -2.504469e+00 240.1282 153.9421 -54.13229 110.85413 0.7686453
Meanf  4.471779e-16 337.0111 177.1023 -79.39437  92.33317 0.8842859
Naive  2.035664e-01 480.8640 197.5995 -53.88390  75.55799 0.9866300
Drift -6.405909e-15 480.8639 197.6104 -54.05791  75.58064 0.9866845
              ACF1
ARIMA -0.006218897
Meanf -0.014490610
Naive -0.481297385
Drift -0.481297385</code></pre>
</div>
</div>
<p>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</p>
<p>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sarima-modeling" class="level2">
<h2 class="anchored" data-anchor-id="sarima-modeling">SARIMA Modeling</h2>
<p>The analysis reveals clear seasonality in some of my datasets- Prices, Consumption, Production, Imports, Exports,and Industry Employment. Simple first, second, or third order differencing hasn’t adequately addressed the seasonal patterns observed in these datasets. Therefore, seasonal differencing is necessary, indicating that a SARIMA model is better suited for these types of data.</p>
<section id="seasonal-time-series" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-time-series">Seasonal Time Series</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-5" role="tab" aria-controls="tabset-17-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>prices_diff<span class="ot">&lt;-</span>prices_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(prices_diff, <span class="at">main=</span><span class="st">"First Difference Seasonal Plot for Natural Gas Residential Prices"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>pricesacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(prices_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>pricespacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(prices_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (pricesacf <span class="sc">|</span> pricespacf)</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When we apply seasonal differencing to the original dataset, a correlation still remains, yet it’s less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data might result in over-differencing, which we want to avoid. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</p>
<p><strong>P:</strong> 1 <strong>Q:</strong>1,2,3,4 <strong>D:</strong> 1 <strong>d:</strong> 0</p>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>consumption_diff<span class="ot">&lt;-</span>consumption_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(consumption_diff, <span class="at">main=</span><span class="st">"First Difference Seasonal Plot for Natural Gas Consumption"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>consumptionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(consumption_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>consumptionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(consumption_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (consumptionacf <span class="sc">|</span> consumptionpacf)</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When we apply seasonal differencing to the original dataset, correlation is less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data might result in over-differencing, which we want to avoid. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</p>
<p><strong>P:</strong> 1 <strong>Q:</strong> 1,2,3,4 <strong>D:</strong>1 <strong>d:</strong>0</p>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>production_diff<span class="ot">&lt;-</span>production_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)<span class="sc">%&gt;%</span> diff</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(production_diff, <span class="at">main=</span><span class="st">"Seasonal Plot for Natural Gas Production"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>productionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(production_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>productionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(production_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (productionacf <span class="sc">|</span> productionpacf)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When we apply seasonal differencing to the original dataset, a correlation still remains, yet it’s less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data results in least correlation. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</p>
<p><strong>P:</strong> 1 <strong>Q:</strong> 1 <strong>D:</strong>1 <strong>d:</strong>1</p>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>imports_diff<span class="ot">&lt;-</span>imports_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)<span class="sc">%&gt;%</span> diff</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(imports_diff, <span class="at">main=</span><span class="st">"Seasonal Plot for Natural Gas Imports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>importsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(imports_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>importspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(imports_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (importsacf <span class="sc">|</span> importspacf)</span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When we apply seasonal differencing to the original dataset, a correlation still remains, yet it’s less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data results in least correlation. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</p>
<p><strong>P:</strong> 1 <strong>Q:</strong> 1 <strong>D:</strong>1 <strong>d:</strong>1</p>
</div>
<div id="tabset-17-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exports_diff&lt;-exports_ts %&gt;% diff(lag = 12)%&gt;% diff</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>exports_diff <span class="ot">&lt;-</span> exports_ts <span class="sc">%&gt;%</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>  <span class="co"># First difference</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()  <span class="co"># Remove NAs that result from differencing</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(exports_diff, <span class="at">main=</span><span class="st">"Seasonal Plot for Natural Gas Exports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>exportsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(exports_diff, <span class="at">lag.max =</span> <span class="dv">12</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>exportspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(exports_diff, <span class="at">lag.max =</span> <span class="dv">12</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (exportsacf <span class="sc">|</span> exportspacf)</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When we apply non-seasonal first differencing to the original dataset, the correlation is less pronounced. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 0 and keeping the non-seasonal differencing parameter (d) at 1. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data might result in over-differencing, which we want to avoid. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</p>
<p><strong>P:</strong> 1 <strong>Q:</strong> 1,2 <strong>D:</strong> 0 <strong>d:</strong>1</p>
</div>
</div>
</div>
</section>
<section id="model-selection-fitting-1" class="level3">
<h3 class="anchored" data-anchor-id="model-selection-fitting-1">Model Selection &amp; Fitting</h3>
<p>In this section, we’ll use insights from the ACF and PACF plots, alongside the differencing steps we’ve executed, to fit SARIMA(p,d,q)(P,D,Q) models manually by exploring various combinations of the parameters p, d, q and P, D, Q. And get the best models resulted from manual fitting and from Auto.ARIMA().</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-5" role="tab" aria-controls="tabset-23-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Manual Prameter Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Auto ARIMA</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p><strong>p</strong> :1,2,3,4 <strong>d</strong>: 0 <strong>q</strong> : 1, 2 <strong>P</strong>: 1 <strong>D</strong>: 1 <strong>Q</strong>:1,2,3,4</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb188-36"><a href="#cb188-36" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb188-37"><a href="#cb188-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb188-38"><a href="#cb188-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb188-39"><a href="#cb188-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb188-40"><a href="#cb188-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-41"><a href="#cb188-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb188-42"><a href="#cb188-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-43"><a href="#cb188-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-44"><a href="#cb188-44" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb188-45"><a href="#cb188-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb188-46"><a href="#cb188-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-47"><a href="#cb188-47" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb188-48"><a href="#cb188-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-49"><a href="#cb188-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb188-50"><a href="#cb188-50" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb188-51"><a href="#cb188-51" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">4</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">2</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">4</span>,<span class="at">data=</span>prices_ts)</span>
<span id="cb188-52"><a href="#cb188-52" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb188-53"><a href="#cb188-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-54"><a href="#cb188-54" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
10 1 0 0 0 1 1 534.6674 544.6218 534.7874</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
10 1 0 0 0 1 1 534.6674 544.6218 534.7874</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
10 1 0 0 0 1 1 534.6674 544.6218 534.7874</code></pre>
</div>
</div>
<p>The model with the lowest AIC and BIC is ARIMA(1,0,0)x(0,1,1)[12].</p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(prices_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: prices_ts 
ARIMA(1,1,1)(2,0,0)[12] 

Coefficients:
          ar1     ma1     sar1     sar2
      -0.9618  0.9071  -0.1570  -0.1649
s.e.   0.0728  0.1003   0.0865   0.0996

sigma^2 = 0.6418:  log likelihood = -255.84
AIC=521.68   AICc=521.96   BIC=538.53</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Best Model 1: ARIMA(1,0,0)x(0,1,1)[12] Best Model 2 (from Auto ARIMA): ARIMA(1,1,1)(2,0,0)[12]</p>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">Manual Prameter Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Auto ARIMA</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p><strong>p</strong>: 1,2,3 <strong>d</strong>:0 <strong>q</strong>: 1 <strong>P</strong>: 1 <strong>D</strong>:1 <strong>Q</strong>: 1,2,3,4</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">3</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">1</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">4</span>,<span class="at">data=</span>consumption_ts)</span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
11 2 0 0 0 1 2 5357.089 5373.679 5357.392</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
10 2 0 0 0 1 1 5357.631 5370.904 5357.832</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
11 2 0 0 0 1 2 5357.089 5373.679 5357.392</code></pre>
</div>
</div>
<p>The model with the lowest AIC is ARIMA(2,0,0)x(0,1,2)[12] and the model with the lowest BIC is ARIMA(2,0,0)x(0,1,1)[12]</p>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(consumption_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: consumption_ts 
ARIMA(2,0,3)(2,1,2)[12] with drift 

Coefficients:
          ar1     ar2     ma1      ma2      ma3    sar1     sar2     sma1
      -0.1423  0.8233  0.4830  -0.5788  -0.1284  0.6048  -0.3901  -1.3803
s.e.   0.1536  0.1483  0.1688   0.2451   0.1228  0.1723   0.0885   0.1878
        sma2      drift
      0.5664  4319.2878
s.e.  0.1680   366.7623

sigma^2 = 1.06e+10:  log likelihood = -2648.06
AIC=5318.11   AICc=5319.49   BIC=5354.61</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Best Model 1: ARIMA(2,0,0)x(0,1,2)[12] Best Model 2: ARIMA(2,0,0)x(0,1,1)[12] Best Model 3 (from Auto ARIMA): ARIMA(2,0,3)(2,1,2)[12]</p>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">Manual Prameter Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Auto ARIMA</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<p><strong>p</strong>: 1,2,3,4 <strong>d</strong>:1 <strong>q</strong>: 1 <strong>P</strong>: 1 <strong>D</strong>:1 <strong>Q</strong>: 1</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb204-33"><a href="#cb204-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb204-34"><a href="#cb204-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb204-35"><a href="#cb204-35" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb204-36"><a href="#cb204-36" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb204-37"><a href="#cb204-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb204-38"><a href="#cb204-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb204-39"><a href="#cb204-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb204-40"><a href="#cb204-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb204-41"><a href="#cb204-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb204-42"><a href="#cb204-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-43"><a href="#cb204-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-44"><a href="#cb204-44" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb204-45"><a href="#cb204-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb204-46"><a href="#cb204-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-47"><a href="#cb204-47" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb204-48"><a href="#cb204-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-49"><a href="#cb204-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb204-50"><a href="#cb204-50" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb204-51"><a href="#cb204-51" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">4</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">1</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">1</span>,<span class="at">data=</span>production_ts)</span>
<span id="cb204-52"><a href="#cb204-52" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb204-53"><a href="#cb204-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-54"><a href="#cb204-54" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC     BIC     AICc
4 3 1 0 0 1 0 5101.137 5114.39 5101.339</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
2 1 1 0 0 1 0 5103.996 5110.623 5104.056</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC     BIC     AICc
4 3 1 0 0 1 0 5101.137 5114.39 5101.339</code></pre>
</div>
</div>
<p>The model with the lowest AIC is ARIMA(3,1,0)x(0,1,0)[12] and the model with the lowest BIC is ARIMA(1,1,0)x(0,1,0)[12]</p>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(production_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: production_ts 
ARIMA(0,1,1)(1,1,1)[12] 

Coefficients:
          ma1     sar1     sma1
      -0.2318  -0.1148  -0.6329
s.e.   0.0806   0.0976   0.0785

sigma^2 = 3.033e+09:  log likelihood = -2506.58
AIC=5021.16   AICc=5021.36   BIC=5034.41</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Best Model 1: ARIMA(3,1,0)x(0,1,0)[12] Best Model 2: ARIMA(1,1,0)x(0,1,0)[12]<br>
Best Model 3 (from Auto ARIMA): ARIMA(0,1,1)(1,1,1)[12]</p>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">Manual Prameter Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Auto ARIMA</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p><strong>p</strong>: 1,2 <strong>d</strong>:1 <strong>q</strong>: 1 <strong>P</strong>: 1 <strong>D</strong>:1 <strong>Q</strong>: 1</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a>  output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">2</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">1</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">1</span>,<span class="at">data=</span>imports_ts)</span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
2 1 1 0 0 1 0 6759.272 6766.673 6759.312</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
2 1 1 0 0 1 0 6759.272 6766.673 6759.312</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
2 1 1 0 0 1 0 6759.272 6766.673 6759.312</code></pre>
</div>
</div>
<p>The model with the lowest AIC and BIC is ARIMA(1,1,0)x(0,1,0)[12]</p>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(imports_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: imports_ts 
ARIMA(0,1,3)(1,1,1)[12] 

Coefficients:
          ma1      ma2      ma3    sar1     sma1
      -0.3251  -0.0821  -0.1358  0.1119  -0.8805
s.e.   0.0578   0.0629   0.0633  0.0780   0.0621

sigma^2 = 232480233:  log likelihood = -3309.68
AIC=6631.35   AICc=6631.64   BIC=6653.55</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Best Model 1: ARIMA(1,1,0)x(0,1,0)[12] Best Model 2 (from Auto ARIMA): ARIMA(0,1,3)(1,1,1)[12]</p>
</div>
<div id="tabset-23-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-5-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">Manual Prameter Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Auto ARIMA</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<p><strong>p</strong>: 1 <strong>d</strong>: 1 <strong>q</strong>: 1,2 <strong>P</strong>: 1 <strong>D</strong>: 0 <strong>Q</strong>: 1,2</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb220-32"><a href="#cb220-32" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb220-33"><a href="#cb220-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb220-34"><a href="#cb220-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb220-35"><a href="#cb220-35" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb220-36"><a href="#cb220-36" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb220-37"><a href="#cb220-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb220-38"><a href="#cb220-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb220-39"><a href="#cb220-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb220-40"><a href="#cb220-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-41"><a href="#cb220-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb220-42"><a href="#cb220-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-43"><a href="#cb220-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-44"><a href="#cb220-44" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb220-45"><a href="#cb220-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb220-46"><a href="#cb220-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-47"><a href="#cb220-47" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb220-48"><a href="#cb220-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-49"><a href="#cb220-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb220-50"><a href="#cb220-50" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb220-51"><a href="#cb220-51" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">1</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">2</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">2</span>,<span class="at">data=</span>exports_ts)</span>
<span id="cb220-52"><a href="#cb220-52" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb220-53"><a href="#cb220-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-54"><a href="#cb220-54" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
4 0 1 1 0 0 1 7024.165 7035.384 7024.243</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
4 0 1 1 0 0 1 7024.165 7035.384 7024.243</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
4 0 1 1 0 0 1 7024.165 7035.384 7024.243</code></pre>
</div>
</div>
<p>The model with the lowest AIC and BIC is ARIMA(0,1,1)x(0,0,1)[12].</p>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(exports_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: exports_ts 
ARIMA(0,1,1)(1,0,0)[12] 

Coefficients:
          ma1    sar1
      -0.1145  0.5996
s.e.   0.0595  0.0505

sigma^2 = 316782460:  log likelihood = -3486.68
AIC=6979.36   AICc=6979.44   BIC=6990.58</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Best Model 1: ARIMA(0,1,1)x(0,0,1)[12] Best Model 2 (from Auto ARIMA): ARIMA(0,1,1)(1,0,0)[12]</p>
</div>
</div>
</div>
</section>
<section id="model-diagnostics-1" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-1">Model Diagnostics</h3>
<p>In this part, we’re going to fit all the best model obtained from our earlier analysis, and then dive into some model diagnostics to see how each one of them is performing.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-3" role="tab" aria-controls="tabset-29-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-4" role="tab" aria-controls="tabset-29-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-5" role="tab" aria-controls="tabset-29-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Model 2</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(prices_ts, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-139-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">39</span><span class="sc">:</span><span class="dv">49</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
ar1        0.9188 0.0294 31.2519   0.000
sma1      -0.9387 0.1169 -8.0327   0.000
constant  -0.0161 0.0101 -1.5873   0.114

sigma^2 estimated as 0.6847897 on 201 degrees of freedom 
 
AIC = 2.622464  AICc = 2.623052  BIC = 2.687525 
 
NA
 </code></pre>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(prices_ts, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-141-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">63</span><span class="sc">:</span><span class="dv">73</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE  t.value p.value
ar1       -0.9620 0.0725 -13.2641  0.0000
ma1        0.9073 0.1000   9.0735  0.0000
sar1      -0.1577 0.0865  -1.8223  0.0698
sar2      -0.1657 0.0997  -1.6625  0.0979
constant  -0.0082 0.0406  -0.2021  0.8400

sigma^2 estimated as 0.629751 on 210 degrees of freedom 
 
AIC = 2.43552  AICc = 2.436855  BIC = 2.529584 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for both the models. The Q-Q plot suggest that the residuals are normally distributed for both the models.From the Ljung-Box Test, the p-values for model1 are typically below 0.05 suggesting that the residuals are not random, which is not desirable in a good model fit while for model2 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, and BIC, model 2 has lower values indicating a better fit.</p>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">Model 3</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">30</span><span class="sc">:</span><span class="dv">44</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
          Estimate       SE t.value p.value
ar1         0.3520   0.0705  4.9902  0.0000
ar2         0.1232   0.0703  1.7539  0.0810
sma1       -0.6989   0.0920 -7.5939  0.0000
sma2       -0.1987   0.0944 -2.1045  0.0366
constant 4297.3233 272.1778 15.7887  0.0000

sigma^2 estimated as 10865088632 on 199 degrees of freedom 
 
AIC = 26.09303  AICc = 26.09452  BIC = 26.19062 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-145-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">23</span><span class="sc">:</span><span class="dv">36</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
          Estimate       SE  t.value p.value
ar1         0.3686   0.0697   5.2872  0.0000
ar2         0.1287   0.0697   1.8469  0.0662
sma1       -0.8392   0.0570 -14.7302  0.0000
constant 4295.5678 295.3862  14.5422  0.0000

sigma^2 estimated as 11279302738 on 200 degrees of freedom 
 
AIC = 26.1058  AICc = 26.10679  BIC = 26.18713 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-147-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">79</span><span class="sc">:</span><span class="dv">98</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
          Estimate       SE t.value p.value
ar1        -0.1423   0.1536 -0.9264  0.3554
ar2         0.8233   0.1483  5.5496  0.0000
ma1         0.4830   0.1688  2.8619  0.0047
ma2        -0.5788   0.2451 -2.3615  0.0192
ma3        -0.1284   0.1228 -1.0458  0.2969
sar1        0.6048   0.1723  3.5112  0.0006
sar2       -0.3901   0.0885 -4.4067  0.0000
sma1       -1.3803   0.1878 -7.3481  0.0000
sma2        0.5664   0.1680  3.3726  0.0009
constant 4319.2878 366.7623 11.7768  0.0000

sigma^2 estimated as 10081725505 on 194 degrees of freedom 
 
AIC = 26.06918  AICc = 26.07477  BIC = 26.2481 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for all the models are typically below 0.05 suggesting that the residuals are not random, which may not be desirable in a good model fit. On comparing AIC, AICc, and BIC, model 3 has lower values indicating a better fit.</p>
</div>
<div id="tabset-29-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-3-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">Model 3</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts, <span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-149-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">14</span><span class="sc">:</span><span class="dv">25</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
    Estimate     SE t.value p.value
ar1  -0.2109 0.0701 -3.0085  0.0030
ar2  -0.1593 0.0707 -2.2513  0.0255
ar3  -0.1262 0.0699 -1.8070  0.0723

sigma^2 estimated as 4607287504 on 200 degrees of freedom 
 
AIC = 25.12876  AICc = 25.12935  BIC = 25.19404 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-151-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">13</span><span class="sc">:</span><span class="dv">23</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
    Estimate     SE t.value p.value
ar1  -0.1695 0.0695 -2.4399  0.0156

sigma^2 estimated as 4767628473 on 202 degrees of freedom 
 
AIC = 25.14284  AICc = 25.14294  BIC = 25.17548 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-153-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">21</span><span class="sc">:</span><span class="dv">33</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
     Estimate     SE t.value p.value
ma1   -0.2318 0.0806 -2.8754  0.0045
sar1  -0.1148 0.0976 -1.1759  0.2410
sma1  -0.6329 0.0785 -8.0600  0.0000

sigma^2 estimated as 2988085206 on 200 degrees of freedom 
 
AIC = 24.73479  AICc = 24.73538  BIC = 24.80007 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>On comparing, the ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for model 3. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for the model 3 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, and BIC, model 3 has lower values indicating a better fit.</p>
</div>
<div id="tabset-29-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-4-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">Model 2</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(imports_ts, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-155-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">13</span><span class="sc">:</span><span class="dv">23</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
    Estimate     SE t.value p.value
ar1  -0.2793 0.0558  -5.009       0

sigma^2 estimated as 379640070 on 298 degrees of freedom 
 
AIC = 22.60626  AICc = 22.60631  BIC = 22.63101 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(imports_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-157-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">24</span><span class="sc">:</span><span class="dv">37</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 
Coefficients: 
     Estimate     SE  t.value p.value
ma1   -0.3251 0.0578  -5.6290  0.0000
ma2   -0.0821 0.0629  -1.3051  0.1929
ma3   -0.1358 0.0633  -2.1467  0.0326
sar1   0.1119 0.0780   1.4343  0.1526
sma1  -0.8805 0.0621 -14.1862  0.0000

sigma^2 estimated as 228590051 on 294 degrees of freedom 
 
AIC = 22.17843  AICc = 22.17912  BIC = 22.25269 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>On comparing, the ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for model 2. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for the model 2 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, and BIC, model 2 has lower values indicating a better fit.</p>
</div>
<div id="tabset-29-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-5-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">Model 2</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(exports_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-159-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">21</span><span class="sc">:</span><span class="dv">29</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
          Estimate        SE t.value p.value
ma1        -0.2094    0.0563 -3.7215  0.0002
sma1        0.4025    0.0482  8.3461  0.0000
constant 1770.9787 1188.6144  1.4900  0.1373

sigma^2 estimated as 364702683 on 308 degrees of freedom 
 
AIC = 22.58516  AICc = 22.58541  BIC = 22.63326 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(exports_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-161-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">25</span><span class="sc">:</span><span class="dv">33</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
          Estimate        SE t.value p.value
ma1        -0.1185    0.0600 -1.9752  0.0491
sar1        0.5946    0.0511 11.6266  0.0000
constant 1602.9180 2072.9403  0.7733  0.4400

sigma^2 estimated as 314262815 on 308 degrees of freedom 
 
AIC = 22.44622  AICc = 22.44647  BIC = 22.49432 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>On comparing, the ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for both the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for both the models are typically below 0.05 suggesting that the residuals are not random, which may not be desirable in a good model fit. On comparing AIC, AICc, and BIC, model 2 has lower values indicating a better fit.</p>
</div>
</div>
</div>
</section>
<section id="cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation">Cross-Validation</h3>
<p>In this part, we’ll pinpoint the model that fits our data best by employing cross-validation and identifying the one with the lowest mean absolute error (MAE) and root mean square error (RMSE).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-4" role="tab" aria-controls="tabset-30-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-5" role="tab" aria-controls="tabset-30-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>prices_ts</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb264-28"><a href="#cb264-28" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb264-29"><a href="#cb264-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-30"><a href="#cb264-30" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb264-31"><a href="#cb264-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb264-32"><a href="#cb264-32" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb264-33"><a href="#cb264-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-34"><a href="#cb264-34" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb264-35"><a href="#cb264-35" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb264-36"><a href="#cb264-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-37"><a href="#cb264-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb264-38"><a href="#cb264-38" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb264-39"><a href="#cb264-39" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb264-40"><a href="#cb264-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-41"><a href="#cb264-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-42"><a href="#cb264-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-43"><a href="#cb264-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-44"><a href="#cb264-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb264-45"><a href="#cb264-45" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb264-46"><a href="#cb264-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,0,0)x(0,1,1)12"</span>,<span class="st">"Fit2:SARIMA(1,1,1)(2,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-163-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,0,0)x(0,1,1)12"</span>,<span class="st">"Fit2:SARIMA(1,1,1)(2,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-164-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Overall, Fit 2 pulls ahead with slightly lower errors. So, it looks like Fit 2 is better.</p>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>consumption_ts</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb266-23"><a href="#cb266-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb266-24"><a href="#cb266-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb266-25"><a href="#cb266-25" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb266-26"><a href="#cb266-26" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb266-27"><a href="#cb266-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-28"><a href="#cb266-28" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb266-29"><a href="#cb266-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb266-30"><a href="#cb266-30" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb266-31"><a href="#cb266-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-32"><a href="#cb266-32" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb266-33"><a href="#cb266-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb266-34"><a href="#cb266-34" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb266-35"><a href="#cb266-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-36"><a href="#cb266-36" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb266-37"><a href="#cb266-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb266-38"><a href="#cb266-38" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb266-39"><a href="#cb266-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-40"><a href="#cb266-40" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb266-41"><a href="#cb266-41" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb266-42"><a href="#cb266-42" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb266-43"><a href="#cb266-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-44"><a href="#cb266-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb266-45"><a href="#cb266-45" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb266-46"><a href="#cb266-46" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb266-47"><a href="#cb266-47" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb266-48"><a href="#cb266-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-49"><a href="#cb266-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-50"><a href="#cb266-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb266-51"><a href="#cb266-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-52"><a href="#cb266-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb266-53"><a href="#cb266-53" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb266-54"><a href="#cb266-54" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb266-55"><a href="#cb266-55" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(2,0,0)x(0,1,2)12"</span>,<span class="st">"Fit2:SARIMA(2,0,0)x(0,1,1)12"</span>,<span class="st">"Fit3:SARIMA(2,0,3)x(2,1,2)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-165-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(2,0,0)x(0,1,2)12"</span>,<span class="st">"Fit2:SARIMA(2,0,0)x(0,1,1)12"</span>,<span class="st">"Fit3:SARIMA(2,0,3)x(2,1,2)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-166-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Overall, Fit 3 pulls ahead with slightly lower errors. So, it looks like Fit 3 is better.</p>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>production_ts</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb268-21"><a href="#cb268-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-22"><a href="#cb268-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb268-23"><a href="#cb268-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb268-24"><a href="#cb268-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb268-25"><a href="#cb268-25" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb268-26"><a href="#cb268-26" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb268-27"><a href="#cb268-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-28"><a href="#cb268-28" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb268-29"><a href="#cb268-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb268-30"><a href="#cb268-30" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb268-31"><a href="#cb268-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-32"><a href="#cb268-32" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb268-33"><a href="#cb268-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb268-34"><a href="#cb268-34" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb268-35"><a href="#cb268-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-36"><a href="#cb268-36" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb268-37"><a href="#cb268-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb268-38"><a href="#cb268-38" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb268-39"><a href="#cb268-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-40"><a href="#cb268-40" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb268-41"><a href="#cb268-41" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb268-42"><a href="#cb268-42" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb268-43"><a href="#cb268-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-44"><a href="#cb268-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb268-45"><a href="#cb268-45" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb268-46"><a href="#cb268-46" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb268-47"><a href="#cb268-47" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb268-48"><a href="#cb268-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-49"><a href="#cb268-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-50"><a href="#cb268-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb268-51"><a href="#cb268-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-52"><a href="#cb268-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb268-53"><a href="#cb268-53" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb268-54"><a href="#cb268-54" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb268-55"><a href="#cb268-55" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(3,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit3:SARIMA(0,1,1)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-167-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(3,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit3:SARIMA(0,1,1)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Overall, Fit 3 pulls ahead with slightly lower errors. So, it looks like Fit 3 is better.</p>
</div>
<div id="tabset-30-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>imports_ts</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">51</span><span class="co"># first training set length </span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb270-33"><a href="#cb270-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-34"><a href="#cb270-34" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb270-35"><a href="#cb270-35" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb270-36"><a href="#cb270-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-37"><a href="#cb270-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb270-38"><a href="#cb270-38" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb270-39"><a href="#cb270-39" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb270-40"><a href="#cb270-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-41"><a href="#cb270-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-42"><a href="#cb270-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-43"><a href="#cb270-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-44"><a href="#cb270-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb270-45"><a href="#cb270-45" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb270-46"><a href="#cb270-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(0,1,3)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-169-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(0,1,3)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-170-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Overall, Fit 2 pulls ahead with slightly lower errors. So, it looks like Fit 2 is better.</p>
</div>
<div id="tabset-30-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>exports_ts</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-17"><a href="#cb272-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-18"><a href="#cb272-18" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb272-19"><a href="#cb272-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-20"><a href="#cb272-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb272-21"><a href="#cb272-21" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb272-22"><a href="#cb272-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb272-23"><a href="#cb272-23" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb272-24"><a href="#cb272-24" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb272-25"><a href="#cb272-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-26"><a href="#cb272-26" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb272-27"><a href="#cb272-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb272-28"><a href="#cb272-28" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb272-29"><a href="#cb272-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-30"><a href="#cb272-30" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb272-31"><a href="#cb272-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb272-32"><a href="#cb272-32" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb272-33"><a href="#cb272-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-34"><a href="#cb272-34" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb272-35"><a href="#cb272-35" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb272-36"><a href="#cb272-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-37"><a href="#cb272-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb272-38"><a href="#cb272-38" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb272-39"><a href="#cb272-39" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb272-40"><a href="#cb272-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-41"><a href="#cb272-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-42"><a href="#cb272-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb272-43"><a href="#cb272-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-44"><a href="#cb272-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb272-45"><a href="#cb272-45" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb272-46"><a href="#cb272-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(0,1,1)x(0,0,1)12"</span>,<span class="st">"Fit2:SARIMA(0,1,1)x(1,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-171-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(0,1,1)x(0,0,1)12"</span>,<span class="st">"Fit2:SARIMA(0,1,1)x(1,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Overall, Fit 2 pulls ahead with slightly lower errors. So, it looks like Fit 2 is better.</p>
</div>
</div>
</div>
</section>
<section id="final-model-fitting-1" class="level3">
<h3 class="anchored" data-anchor-id="final-model-fitting-1">Final Model Fitting</h3>
<p>In this part, we’re going to fit the best model from our earlier analysis and jot down its equation.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-3" role="tab" aria-controls="tabset-31-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-4" role="tab" aria-controls="tabset-31-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-5" role="tab" aria-controls="tabset-31-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: prices_ts 
ARIMA(1,1,1)(2,0,0)[12] 

Coefficients:
          ar1     ma1     sar1     sar2
      -0.9618  0.9071  -0.1570  -0.1649
s.e.   0.0728  0.1003   0.0865   0.0996

sigma^2 = 0.6418:  log likelihood = -255.84
AIC=521.68   AICc=521.96   BIC=538.53

Training set error measures:
                       ME      RMSE       MAE      MPE     MAPE      MASE
Training set -0.008181362 0.7918204 0.5223794 -1.36221 11.23393 0.3694543
                     ACF1
Training set -0.001772395</code></pre>
</div>
</div>
<p>Model equation:</p>
<p><span class="math display">\[
(1 - 0.9618B)(1-B)(1-0.1570B^{12}-0.1649B^{24})Y_t =(1+0.9071B)w_t
\]</span></p>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">period=</span><span class="dv">12</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: consumption_ts 
ARIMA(2,0,3)(2,1,2)[12] 

Coefficients:
         ar1     ar2     ma1      ma2      ma3    sar1     sar2     sma1
      0.0163  0.9800  0.3435  -0.8232  -0.2451  0.6047  -0.4146  -1.4154
s.e.  0.0237  0.0238  0.0748   0.0714   0.0781  0.1625   0.0835   0.1879
        sma2
      0.5988
s.e.  0.1635

sigma^2 = 1.071e+10:  log likelihood = -2651.09
AIC=5322.18   AICc=5323.32   BIC=5355.36

Training set error measures:
                  ME     RMSE      MAE       MPE     MAPE      MASE
Training set 10818.3 98342.46 73926.48 0.3489177 3.235926 0.6323878
                     ACF1
Training set -0.007852977</code></pre>
</div>
</div>
<p>Model equation:</p>
<p><span class="math display">\[
(1 - 0.0163B - 0.9800B^2)(1 - 0.6047B^{12} + 0.4146B^{24})(1 - B^{12})^1Y_t = (1 + 0.3435B - 0.8232B^2 - 0.2451B^3)(1 - 1.4154B^{12} + 0.5988B^{24})w_t
\]</span></p>
</div>
<div id="tabset-31-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: production_ts 
ARIMA(0,1,1)(1,1,1)[12] 

Coefficients:
          ma1     sar1     sma1
      -0.2318  -0.1148  -0.6329
s.e.   0.0806   0.0976   0.0785

sigma^2 = 3.033e+09:  log likelihood = -2506.58
AIC=5021.16   AICc=5021.36   BIC=5034.41

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE      ACF1
Training set 2289.614 52995.22 34932.59 0.07971598 1.319548 0.2680922 0.0231852</code></pre>
</div>
</div>
<p>Model equation:</p>
<p><span class="math display">\[
(1 - B)(1 - B^{12}) Y_t = (1−0.2318B) (1−0.1148B^{12}) (1−0.6329B^{12}) w_t
\]</span></p>
</div>
<div id="tabset-31-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: imports_ts 
ARIMA(0,1,1)(1,0,0)[12] 

Coefficients:
          ma1    sar1
      -0.3213  0.6779
s.e.   0.0637  0.0403

sigma^2 = 316104207:  log likelihood = -3487.41
AIC=6980.83   AICc=6980.91   BIC=6992.05

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set 63.52825 17693.64 14186.81 -0.2091907 4.959858 0.6342818
                   ACF1
Training set 0.02733407</code></pre>
</div>
</div>
<p>Model equation:</p>
<p><span class="math display">\[
(1 - B)Y_t = (1−0.3213B) (1−0.6779B^{12})w_t
\]</span></p>
</div>
<div id="tabset-31-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(exports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: exports_ts 
ARIMA(0,1,0)(0,1,3)[12] 

Coefficients:
         sma1    sma2    sma3
      -0.5912  0.1420  0.0031
s.e.   0.0588  0.0829  0.0955

sigma^2 = 280386033:  log likelihood = -3332.9
AIC=6673.8   AICc=6673.94   BIC=6688.6

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set 88.11593 16309.73 9630.989 -0.3729319 9.009833 0.3492677
                    ACF1
Training set -0.08097367</code></pre>
</div>
</div>
<p>Model equation:</p>
<p><span class="math display">\[
(1 - B)(1 - B^{12}) Y_t = (1 + 0.5912 B^{12} - 0.1420 B^{24} - 0.0031 B^{36}) w_t
\]</span></p>
</div>
</div>
</div>
</section>
<section id="sarima-vs.-benchmark-methods" class="level3">
<h3 class="anchored" data-anchor-id="sarima-vs.-benchmark-methods">SARIMA vs.&nbsp;Benchmark methods</h3>
<p>Now, we are going to compare the best model we chose above with the benchmark methods</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-4" role="tab" aria-controls="tabset-32-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-5" role="tab" aria-controls="tabset-32-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prices_ts) <span class="sc">+</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit1,<span class="dv">12</span>), </span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-178-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit1,<span class="dv">12</span>))</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-11"><a href="#cb285-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb285-12"><a href="#cb285-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb285-13"><a href="#cb285-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-14"><a href="#cb285-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME      RMSE       MAE        MPE     MAPE      MASE
SARIMA fit -8.181362e-03 0.7918204 0.5223794  -1.362210 11.23393 0.3694543
Meanf       1.517356e-16 2.3123213 1.7996103 -23.725893 46.03433 1.2727795
Naive      -2.883721e-03 0.8138242 0.5097674  -1.144999 10.63560 0.3605345
Drift      -2.895201e-17 0.8138191 0.5096467  -1.065391 10.62714 0.3604491
                   ACF1
SARIMA fit -0.001772395
Meanf       0.936691654
Naive      -0.076051915
Drift      -0.076051915</code></pre>
</div>
</div>
<p>The Seasonal Naive method’s trend line looked a lot like last year’s. The SARIMA model has lower RMSE so it can be said that it did better than most of the other methods we checked out.</p>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(consumption_ts) <span class="sc">+</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit2,<span class="dv">12</span>), </span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit2,<span class="dv">12</span>))</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb288-13"><a href="#cb288-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-14"><a href="#cb288-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME      RMSE       MAE        MPE      MAPE      MASE
SARIMA fit  1.081830e+04  98342.46  73926.48  0.3489177  3.235926 0.6323878
Meanf       2.244115e-10 475539.86 388753.66 -4.5394828 18.158360 3.3255073
Naive       3.786088e+03 301268.55 241294.60 -0.7161268 10.686221 2.0641013
Drift      -3.142357e-11 301244.76 241185.00 -0.8957034 10.688195 2.0631638
                   ACF1
SARIMA fit -0.007852977
Meanf       0.784939243
Naive       0.350347620
Drift       0.350347620</code></pre>
</div>
</div>
<p>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method’s trend line looked a lot like last year’s, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</p>
</div>
<div id="tabset-32-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(production_ts) <span class="sc">+</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit3,<span class="dv">12</span>), </span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-182-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit3,<span class="dv">12</span>))</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(production_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME      RMSE       MAE         MPE      MAPE      MASE
SARIMA fit  2.289614e+03  52995.22  34932.59  0.07971598  1.319548 0.2680922
Meanf      -1.546615e-10 545658.73 456839.53 -4.14357445 17.582835 3.5060416
Naive       7.998926e+03 136882.41 103582.25  0.15193387  3.955783 0.7949480
Drift       1.494482e-10 136648.50 103540.46 -0.16214898  3.957111 0.7946273
                 ACF1
SARIMA fit  0.0231852
Meanf       0.9562452
Naive      -0.6011544
Drift      -0.6011544</code></pre>
</div>
</div>
<p>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method’s trend line looked a lot like last year’s, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</p>
</div>
<div id="tabset-32-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(imports_ts) <span class="sc">+</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit4,<span class="dv">12</span>), </span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-184-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit4,<span class="dv">12</span>))</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME     RMSE      MAE        MPE      MAPE      MASE
SARIMA fit  6.352825e+01 17693.64 14186.81 -0.2091907  4.959858 0.6342818
Meanf      -1.794955e-11 54476.42 46530.12 -3.7116764 16.899929 2.0803278
Naive       4.711254e+01 25084.96 19464.36 -0.3595737  6.791850 0.8702374
Drift       1.225908e-11 25084.91 19464.21 -0.3766501  6.792339 0.8702307
                  ACF1
SARIMA fit  0.02733407
Meanf       0.89426354
Naive      -0.18972707
Drift      -0.18972707</code></pre>
</div>
</div>
<p>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method’s trend line looked a lot like last year’s, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</p>
</div>
<div id="tabset-32-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exports_ts) <span class="sc">+</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit5,<span class="dv">12</span>), </span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-186-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comparing Accuracy Metrics</strong></p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit5,<span class="dv">12</span>))</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>output_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME      RMSE        MAE          MPE       MAPE      MASE
SARIMA fit  8.811593e+01  16309.73   9630.989   -0.3729319   9.009833 0.3492677
Meanf       1.042567e-11 162271.31 124173.292 -213.0207422 241.607017 4.5031422
Naive       1.881955e+03  22476.64  12884.714    0.1542360  10.800990 0.4672639
Drift      -2.593253e-12  22397.71  12829.335   -3.5443285  11.476894 0.4652556
                  ACF1
SARIMA fit -0.08097367
Meanf       0.97738243
Naive      -0.34599428
Drift      -0.34599428</code></pre>
</div>
</div>
<p>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method’s trend line looked a lot like last year’s, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</p>
</div>
</div>
</div>
</section>
<section id="forecasting-1" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-1">Forecasting</h3>
<p>Finally, we’ll forecast and plot the forecast for the next 3 years using our final fit.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-3" role="tab" aria-controls="tabset-33-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-4" role="tab" aria-controls="tabset-33-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-5" role="tab" aria-controls="tabset-33-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Prices Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prices"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-188-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-33-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Consumption Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Consumption"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-189-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-33-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>fit3 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Production Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Production"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-190-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-33-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>fit4 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Imports Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Imports"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-191-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-33-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-5-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>fit5 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Exports Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Exports"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-192-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>The forecasted values come from the model’s parameters, which we figured out by looking at past data. To see how accurate these forecasts are, we can use cross-validation. This means we split the data into a part for training and another part for testing. Then we see how well the model’s predictions stack up against the real numbers in the test set. This step is key for spotting any issues with the model and tweaking the parameters to get things just right.</p>
</section>
<section id="seasonal-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-cross-validation">Seasonal Cross-Validation</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true">Prices</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false">Consumption</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-3" role="tab" aria-controls="tabset-39-3" aria-selected="false">Production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-4" role="tab" aria-controls="tabset-39-4" aria-selected="false">Imports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-5" role="tab" aria-controls="tabset-39-5" aria-selected="false">Exports</a></li></ul>
<div class="tab-content">
<div id="tabset-39-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true">12-step ahead CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false">1-step ahead CV</a></li></ul>
<div class="tab-content">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)), <span class="at">h=</span>h)}</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(prices_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-193-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span>h)}</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(prices_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-194-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-39-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true">12-step ahead CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false">1-step ahead CV</a></li></ul>
<div class="tab-content">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)), <span class="at">h=</span>h)}</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(consumption_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-195-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-35-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)),<span class="at">h=</span>h)}</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(consumption_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-196-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-39-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-3-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true">12-step ahead CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false">1-step ahead CV</a></li></ul>
<div class="tab-content">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(production_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-197-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)),<span class="at">h=</span>h)}</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(production_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-198-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-39-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-4-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true">12-step ahead CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false">1-step ahead CV</a></li></ul>
<div class="tab-content">
<div id="tabset-37-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)), <span class="at">h=</span>h)}</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(imports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-199-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-37-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span>h)}</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(imports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-200-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-39-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-5-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true">12-step ahead CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-2" role="tab" aria-controls="tabset-38-2" aria-selected="false">1-step ahead CV</a></li></ul>
<div class="tab-content">
<div id="tabset-38-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)), <span class="at">h=</span>h)}</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(exports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb312-11"><a href="#cb312-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb312-12"><a href="#cb312-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-201-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-38-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)),<span class="at">h=</span>h)}</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(exports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="univariate_files/figure-html/unnamed-chunk-202-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The MSE tends to rise by 12 steps at each step of cross-validation it suggests that there’s a pattern of increasing error which indicates that the model becomes less accurate at predicting values one year ahead. However, the one-step-ahead forecasting plots show that the MSE seems to be stable. Indicating that our model’s predictions are consistently close to the actual values for each subsequent time point in the series.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb314" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Univariate TS Models (ARIMA/SARIMA)"</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "View Code"</span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>On this page, we're diving into an in-depth exploration of our time series data. We'll start by examining its stationarity using ACF graphs and the Augmented Dickey-Fuller Test. If our data isn't stationary, we'll apply differencing to correct it. Next, we'll analyze ACF and PACF plots to pinpoint the optimal parameters for our ARIMA model. Once we've built the model, we'll conduct a comprehensive evaluation of the residuals. Additionally, we'll compare our model with the results from auto.arima() to see how they stack up. Finally, we'll forecast future values using our model and assess its accuracy against standard benchmark methods, ensuring our analysis is robust and reliable.</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARIMA Modeling</span></span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a><span class="fu">### ACF and PCF Plots</span></span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-24"><a href="#cb314-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-25"><a href="#cb314-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb314-26"><a href="#cb314-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb314-27"><a href="#cb314-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb314-28"><a href="#cb314-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa) </span>
<span id="cb314-29"><a href="#cb314-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb314-30"><a href="#cb314-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb314-31"><a href="#cb314-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb314-32"><a href="#cb314-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb314-33"><a href="#cb314-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb314-34"><a href="#cb314-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb314-35"><a href="#cb314-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb314-36"><a href="#cb314-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb314-37"><a href="#cb314-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb314-38"><a href="#cb314-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb314-39"><a href="#cb314-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb314-40"><a href="#cb314-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb314-41"><a href="#cb314-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  </span>
<span id="cb314-42"><a href="#cb314-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)   </span>
<span id="cb314-43"><a href="#cb314-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)          </span>
<span id="cb314-44"><a href="#cb314-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)   </span>
<span id="cb314-45"><a href="#cb314-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb314-46"><a href="#cb314-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb314-47"><a href="#cb314-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb314-48"><a href="#cb314-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-49"><a href="#cb314-49" aria-hidden="true" tabindex="-1"></a>prices<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Henry_Hub_Natural_Gas_Spot_Price.csv"</span>)</span>
<span id="cb314-50"><a href="#cb314-50" aria-hidden="true" tabindex="-1"></a>prices<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(prices<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb314-51"><a href="#cb314-51" aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> <span class="fu">subset</span>(prices, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb314-52"><a href="#cb314-52" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(prices)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"prices"</span></span>
<span id="cb314-53"><a href="#cb314-53" aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> prices[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"prices"</span>)]</span>
<span id="cb314-54"><a href="#cb314-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-55"><a href="#cb314-55" aria-hidden="true" tabindex="-1"></a>prices_ts <span class="ot">=</span> <span class="fu">ts</span>(prices<span class="sc">$</span>prices, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>), <span class="at">frequency =</span><span class="dv">12</span> )</span>
<span id="cb314-56"><a href="#cb314-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-57"><a href="#cb314-57" aria-hidden="true" tabindex="-1"></a>pricesacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(prices_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Prices (Henry Hub)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-58"><a href="#cb314-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-59"><a href="#cb314-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-60"><a href="#cb314-60" aria-hidden="true" tabindex="-1"></a>pricespacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(prices_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Prices (Henry Hub)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-61"><a href="#cb314-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-62"><a href="#cb314-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-63"><a href="#cb314-63" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(pricesacf, pricespacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-64"><a href="#cb314-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-65"><a href="#cb314-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-66"><a href="#cb314-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-67"><a href="#cb314-67" aria-hidden="true" tabindex="-1"></a>ACF Plot has significant lags from 1-24. PACF Plot has significant lags at 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</span>
<span id="cb314-68"><a href="#cb314-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-69"><a href="#cb314-69" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-70"><a href="#cb314-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-73"><a href="#cb314-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-74"><a href="#cb314-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-75"><a href="#cb314-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-76"><a href="#cb314-76" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb314-77"><a href="#cb314-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb314-78"><a href="#cb314-78" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb314-79"><a href="#cb314-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-80"><a href="#cb314-80" aria-hidden="true" tabindex="-1"></a>consumption_ts <span class="ot">=</span> <span class="fu">ts</span>(consumption<span class="sc">$</span>Consumption, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb314-81"><a href="#cb314-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-82"><a href="#cb314-82" aria-hidden="true" tabindex="-1"></a>consumptionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(consumption_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Consumption "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-83"><a href="#cb314-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-84"><a href="#cb314-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-85"><a href="#cb314-85" aria-hidden="true" tabindex="-1"></a>consumptionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(consumption_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Consumption "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-86"><a href="#cb314-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-87"><a href="#cb314-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-88"><a href="#cb314-88" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(consumptionacf, consumptionpacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-89"><a href="#cb314-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-90"><a href="#cb314-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-91"><a href="#cb314-91" aria-hidden="true" tabindex="-1"></a>ACF Plot has significant lags at 1, 2. PACF Plot has significant lags at 1 and 2. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</span>
<span id="cb314-92"><a href="#cb314-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-93"><a href="#cb314-93" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-94"><a href="#cb314-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-97"><a href="#cb314-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-98"><a href="#cb314-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-99"><a href="#cb314-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-100"><a href="#cb314-100" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb314-101"><a href="#cb314-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-102"><a href="#cb314-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb314-103"><a href="#cb314-103" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb314-104"><a href="#cb314-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-105"><a href="#cb314-105" aria-hidden="true" tabindex="-1"></a>production_ts <span class="ot">=</span> <span class="fu">ts</span>(production<span class="sc">$</span>Production, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb314-106"><a href="#cb314-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-107"><a href="#cb314-107" aria-hidden="true" tabindex="-1"></a>productionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(production_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Production "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-108"><a href="#cb314-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-109"><a href="#cb314-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-110"><a href="#cb314-110" aria-hidden="true" tabindex="-1"></a>productionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(production_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Production "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-111"><a href="#cb314-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-112"><a href="#cb314-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-113"><a href="#cb314-113" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(productionacf, productionpacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-114"><a href="#cb314-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-115"><a href="#cb314-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-116"><a href="#cb314-116" aria-hidden="true" tabindex="-1"></a>ACF Plot has significant lags from 1 to 55. PACF Plot has significant lags at 1 and 2. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</span>
<span id="cb314-117"><a href="#cb314-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-118"><a href="#cb314-118" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-119"><a href="#cb314-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-122"><a href="#cb314-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-123"><a href="#cb314-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-124"><a href="#cb314-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-125"><a href="#cb314-125" aria-hidden="true" tabindex="-1"></a>imports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Imports.csv"</span>)</span>
<span id="cb314-126"><a href="#cb314-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-127"><a href="#cb314-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb314-128"><a href="#cb314-128" aria-hidden="true" tabindex="-1"></a>imports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(imports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb314-129"><a href="#cb314-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-130"><a href="#cb314-130" aria-hidden="true" tabindex="-1"></a>imports_ts <span class="ot">=</span> <span class="fu">ts</span>(imports<span class="sc">$</span>Imports, <span class="at">start =</span> <span class="dv">1997</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb314-131"><a href="#cb314-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-132"><a href="#cb314-132" aria-hidden="true" tabindex="-1"></a>importsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(imports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Imports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-133"><a href="#cb314-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-134"><a href="#cb314-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-135"><a href="#cb314-135" aria-hidden="true" tabindex="-1"></a>importspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(imports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Imports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-136"><a href="#cb314-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-137"><a href="#cb314-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-138"><a href="#cb314-138" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(importsacf, importspacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-139"><a href="#cb314-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-140"><a href="#cb314-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-141"><a href="#cb314-141" aria-hidden="true" tabindex="-1"></a>From the visualization above, it looks like there are significant lags at 1-60, with the first lag being the most pronounced. The PACF plot, on the other hand, shows strong correlation at lag 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</span>
<span id="cb314-142"><a href="#cb314-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-143"><a href="#cb314-143" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-144"><a href="#cb314-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-147"><a href="#cb314-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-148"><a href="#cb314-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-149"><a href="#cb314-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-150"><a href="#cb314-150" aria-hidden="true" tabindex="-1"></a>exports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Exports.csv"</span>)</span>
<span id="cb314-151"><a href="#cb314-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-152"><a href="#cb314-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb314-153"><a href="#cb314-153" aria-hidden="true" tabindex="-1"></a>exports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(exports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb314-154"><a href="#cb314-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-155"><a href="#cb314-155" aria-hidden="true" tabindex="-1"></a>exports_ts <span class="ot">=</span> <span class="fu">ts</span>(exports<span class="sc">$</span>Exports, <span class="at">start =</span> <span class="dv">1997</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb314-156"><a href="#cb314-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-157"><a href="#cb314-157" aria-hidden="true" tabindex="-1"></a>exportsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(exports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas Exports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-158"><a href="#cb314-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-159"><a href="#cb314-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-160"><a href="#cb314-160" aria-hidden="true" tabindex="-1"></a>exportspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(exports_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas Exports "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-161"><a href="#cb314-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-162"><a href="#cb314-162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-163"><a href="#cb314-163" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(exportsacf, exportspacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-164"><a href="#cb314-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-165"><a href="#cb314-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-166"><a href="#cb314-166" aria-hidden="true" tabindex="-1"></a>From the visualization above, it looks like there are significant lags at 1-60, with the first lag being the most pronounced. The PACF plot, on the other hand, shows strong correlation at lag 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</span>
<span id="cb314-167"><a href="#cb314-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-168"><a href="#cb314-168" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-169"><a href="#cb314-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-172"><a href="#cb314-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-173"><a href="#cb314-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-174"><a href="#cb314-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-175"><a href="#cb314-175" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.warning4.0"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb314-176"><a href="#cb314-176" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.yahoo.warning"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb314-177"><a href="#cb314-177" aria-hidden="true" tabindex="-1"></a>tickers <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CVX"</span>)</span>
<span id="cb314-178"><a href="#cb314-178" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tickers){</span>
<span id="cb314-179"><a href="#cb314-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getSymbols</span>(i,</span>
<span id="cb314-180"><a href="#cb314-180" aria-hidden="true" tabindex="-1"></a>             <span class="at">from =</span> <span class="st">"2000-01-02"</span>,</span>
<span id="cb314-181"><a href="#cb314-181" aria-hidden="true" tabindex="-1"></a>             <span class="at">to =</span> <span class="st">"2022-12-29"</span>)}</span>
<span id="cb314-182"><a href="#cb314-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-183"><a href="#cb314-183" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb314-184"><a href="#cb314-184" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"date"</span></span>
<span id="cb314-185"><a href="#cb314-185" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb314-186"><a href="#cb314-186" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb314-187"><a href="#cb314-187" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"value"</span></span>
<span id="cb314-188"><a href="#cb314-188" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb314-189"><a href="#cb314-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-190"><a href="#cb314-190" aria-hidden="true" tabindex="-1"></a>cvx_stk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(CVX<span class="sc">$</span>CVX.Adjusted)</span>
<span id="cb314-191"><a href="#cb314-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-192"><a href="#cb314-192" aria-hidden="true" tabindex="-1"></a>cvx_stk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cvx_stk,<span class="fu">rownames</span>(cvx_stk))</span>
<span id="cb314-193"><a href="#cb314-193" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cvx_stk) <span class="ot">&lt;-</span> <span class="fu">append</span>(tickers,<span class="st">'Dates'</span>)</span>
<span id="cb314-194"><a href="#cb314-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-195"><a href="#cb314-195" aria-hidden="true" tabindex="-1"></a>cvx_stk<span class="sc">$</span>Dates<span class="ot">&lt;-</span><span class="fu">as.Date</span>(cvx_stk<span class="sc">$</span>Dates,<span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb314-196"><a href="#cb314-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-197"><a href="#cb314-197" aria-hidden="true" tabindex="-1"></a>cvx_stk_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(cvx_stk<span class="sc">$</span>CVX, <span class="at">start =</span> <span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2000-01-02"</span>)), <span class="at">frequency =</span> <span class="fl">365.25</span>)</span>
<span id="cb314-198"><a href="#cb314-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-199"><a href="#cb314-199" aria-hidden="true" tabindex="-1"></a>stocksacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(cvx_stk_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Chevron Corp Stock "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-200"><a href="#cb314-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-201"><a href="#cb314-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-202"><a href="#cb314-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-203"><a href="#cb314-203" aria-hidden="true" tabindex="-1"></a>stockspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(cvx_stk_ts,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Chevron Corp Stock "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-204"><a href="#cb314-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-205"><a href="#cb314-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-206"><a href="#cb314-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-207"><a href="#cb314-207" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(stocksacf, stockspacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-208"><a href="#cb314-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-209"><a href="#cb314-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-210"><a href="#cb314-210" aria-hidden="true" tabindex="-1"></a>From the visualization above, it looks like there are significant lags at 1-100. The PACF plot, on the other hand, shows strong correlation at lag 1. Since we see autocorrelation in the plots, we can conclude this data is not stationary and will require differencing to make it stationary.</span>
<span id="cb314-211"><a href="#cb314-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-212"><a href="#cb314-212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-213"><a href="#cb314-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-216"><a href="#cb314-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-217"><a href="#cb314-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-218"><a href="#cb314-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-219"><a href="#cb314-219" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/co2_emissions.csv"</span>)</span>
<span id="cb314-220"><a href="#cb314-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-221"><a href="#cb314-221" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert "Month" column to Date type</span></span>
<span id="cb314-222"><a href="#cb314-222" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(co2_emissions<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb314-223"><a href="#cb314-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-224"><a href="#cb314-224" aria-hidden="true" tabindex="-1"></a>co2_ts <span class="ot">=</span> <span class="fu">ts</span>(co2_emissions<span class="sc">$</span>co2_value, <span class="at">start =</span> <span class="dv">2000</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2023</span>,<span class="dv">11</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb314-225"><a href="#cb314-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-226"><a href="#cb314-226" aria-hidden="true" tabindex="-1"></a>carbonacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(co2_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"ACF Plot for Natural Gas CO2 emission"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-227"><a href="#cb314-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-228"><a href="#cb314-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-229"><a href="#cb314-229" aria-hidden="true" tabindex="-1"></a>carbonpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(co2_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PACF Plot for Natural Gas CO2 emission"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-230"><a href="#cb314-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-231"><a href="#cb314-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) </span>
<span id="cb314-232"><a href="#cb314-232" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(carbonacf, carbonpacf, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb314-233"><a href="#cb314-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-234"><a href="#cb314-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-235"><a href="#cb314-235" aria-hidden="true" tabindex="-1"></a>From the visualization above, a little autocorrelation at lags 13 in the Autocorrelation Function (ACF) plot is seen. In the Partial Autocorrelation Function (PACF) plot, this close relationship shows up at lag 9, 10, 11, 12 and 13. Seeing this kind of pattern, points to the data being stationary and won't require further differencing.</span>
<span id="cb314-236"><a href="#cb314-236" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-237"><a href="#cb314-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-238"><a href="#cb314-238" aria-hidden="true" tabindex="-1"></a><span class="fu">### Differencing</span></span>
<span id="cb314-239"><a href="#cb314-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-240"><a href="#cb314-240" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-241"><a href="#cb314-241" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-242"><a href="#cb314-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-245"><a href="#cb314-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-246"><a href="#cb314-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-247"><a href="#cb314-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-248"><a href="#cb314-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-249"><a href="#cb314-249" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(prices_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Residential Prices"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-250"><a href="#cb314-250" aria-hidden="true" tabindex="-1"></a>pricesacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(prices_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-251"><a href="#cb314-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-252"><a href="#cb314-252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-253"><a href="#cb314-253" aria-hidden="true" tabindex="-1"></a>pricespacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(prices_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-254"><a href="#cb314-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-255"><a href="#cb314-255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-256"><a href="#cb314-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-257"><a href="#cb314-257" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (pricesacf <span class="sc">|</span> pricespacf)</span>
<span id="cb314-258"><a href="#cb314-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-259"><a href="#cb314-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-260"><a href="#cb314-260" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-261"><a href="#cb314-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-262"><a href="#cb314-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-263"><a href="#cb314-263" aria-hidden="true" tabindex="-1"></a>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary. However, we can see over differencing here.</span>
<span id="cb314-264"><a href="#cb314-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-265"><a href="#cb314-265" aria-hidden="true" tabindex="-1"></a>Here the parameters are d = 0,1 p = 1-4 (PACF Plot) q = 1-4 (ACF Plot)</span>
<span id="cb314-266"><a href="#cb314-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-267"><a href="#cb314-267" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-268"><a href="#cb314-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-271"><a href="#cb314-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-272"><a href="#cb314-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-273"><a href="#cb314-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-274"><a href="#cb314-274" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(consumption_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Consumption"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-275"><a href="#cb314-275" aria-hidden="true" tabindex="-1"></a>consumptionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(consumption_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-276"><a href="#cb314-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-277"><a href="#cb314-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-278"><a href="#cb314-278" aria-hidden="true" tabindex="-1"></a>consumptionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(consumption_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-279"><a href="#cb314-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-280"><a href="#cb314-280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-281"><a href="#cb314-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-282"><a href="#cb314-282" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (consumptionacf <span class="sc">|</span> consumptionpacf)</span>
<span id="cb314-283"><a href="#cb314-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-284"><a href="#cb314-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-285"><a href="#cb314-285" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-286"><a href="#cb314-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-287"><a href="#cb314-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-288"><a href="#cb314-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-289"><a href="#cb314-289" aria-hidden="true" tabindex="-1"></a>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</span>
<span id="cb314-290"><a href="#cb314-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-291"><a href="#cb314-291" aria-hidden="true" tabindex="-1"></a>Here the parameters are d = 0,1 p = 1,2,3 (PACF Plot) q = 1 (ACF Plot)</span>
<span id="cb314-292"><a href="#cb314-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-293"><a href="#cb314-293" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-294"><a href="#cb314-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-297"><a href="#cb314-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-298"><a href="#cb314-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-299"><a href="#cb314-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-300"><a href="#cb314-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-301"><a href="#cb314-301" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(production_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Production"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-302"><a href="#cb314-302" aria-hidden="true" tabindex="-1"></a>productionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(production_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-303"><a href="#cb314-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-304"><a href="#cb314-304" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-305"><a href="#cb314-305" aria-hidden="true" tabindex="-1"></a>productionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(production_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-306"><a href="#cb314-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-307"><a href="#cb314-307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-308"><a href="#cb314-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-309"><a href="#cb314-309" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (productionacf <span class="sc">|</span> productionpacf)</span>
<span id="cb314-310"><a href="#cb314-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-311"><a href="#cb314-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-312"><a href="#cb314-312" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-313"><a href="#cb314-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-314"><a href="#cb314-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-315"><a href="#cb314-315" aria-hidden="true" tabindex="-1"></a>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</span>
<span id="cb314-316"><a href="#cb314-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-317"><a href="#cb314-317" aria-hidden="true" tabindex="-1"></a>Here the parameters are d = 0,1 p = 1,2,3,4 (PACF Plot) q = 1 (ACF Plot)</span>
<span id="cb314-318"><a href="#cb314-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-319"><a href="#cb314-319" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-320"><a href="#cb314-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-323"><a href="#cb314-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-324"><a href="#cb314-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-325"><a href="#cb314-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-326"><a href="#cb314-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-327"><a href="#cb314-327" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(imports_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Imports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-328"><a href="#cb314-328" aria-hidden="true" tabindex="-1"></a>importsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(imports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-329"><a href="#cb314-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-330"><a href="#cb314-330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-331"><a href="#cb314-331" aria-hidden="true" tabindex="-1"></a>importspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(imports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-332"><a href="#cb314-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-333"><a href="#cb314-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-334"><a href="#cb314-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-335"><a href="#cb314-335" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (importsacf <span class="sc">|</span> importspacf)</span>
<span id="cb314-336"><a href="#cb314-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-337"><a href="#cb314-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-338"><a href="#cb314-338" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-339"><a href="#cb314-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-340"><a href="#cb314-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-341"><a href="#cb314-341" aria-hidden="true" tabindex="-1"></a>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</span>
<span id="cb314-342"><a href="#cb314-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-343"><a href="#cb314-343" aria-hidden="true" tabindex="-1"></a>Here the parameters are d = 0,1 p = 1,2 (PACF Plot) q = 1 (ACF Plot)</span>
<span id="cb314-344"><a href="#cb314-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-345"><a href="#cb314-345" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-346"><a href="#cb314-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-349"><a href="#cb314-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-350"><a href="#cb314-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-351"><a href="#cb314-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-352"><a href="#cb314-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-353"><a href="#cb314-353" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(exports_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Natural Gas Exports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-354"><a href="#cb314-354" aria-hidden="true" tabindex="-1"></a>exportsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(exports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-355"><a href="#cb314-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-356"><a href="#cb314-356" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-357"><a href="#cb314-357" aria-hidden="true" tabindex="-1"></a>exportspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(exports_ts))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-358"><a href="#cb314-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-359"><a href="#cb314-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-360"><a href="#cb314-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-361"><a href="#cb314-361" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (exportsacf <span class="sc">|</span> exportspacf)</span>
<span id="cb314-362"><a href="#cb314-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-363"><a href="#cb314-363" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-364"><a href="#cb314-364" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-365"><a href="#cb314-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-366"><a href="#cb314-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-367"><a href="#cb314-367" aria-hidden="true" tabindex="-1"></a>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</span>
<span id="cb314-368"><a href="#cb314-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-369"><a href="#cb314-369" aria-hidden="true" tabindex="-1"></a>Here the parameters are d = 0,1 p = 1 (PACF Plot) q = 1,2 (ACF Plot)</span>
<span id="cb314-370"><a href="#cb314-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-371"><a href="#cb314-371" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-372"><a href="#cb314-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-375"><a href="#cb314-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-376"><a href="#cb314-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-377"><a href="#cb314-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-378"><a href="#cb314-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-379"><a href="#cb314-379" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(<span class="fu">diff</span>(cvx_stk_ts), <span class="at">main=</span><span class="st">"First Difference Plot for Chevron Corp Stocks"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-380"><a href="#cb314-380" aria-hidden="true" tabindex="-1"></a>stocksacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(cvx_stk_ts),<span class="dv">24</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-381"><a href="#cb314-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-382"><a href="#cb314-382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-383"><a href="#cb314-383" aria-hidden="true" tabindex="-1"></a>stockspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(cvx_stk_ts),<span class="dv">24</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-384"><a href="#cb314-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-385"><a href="#cb314-385" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-386"><a href="#cb314-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-387"><a href="#cb314-387" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (stocksacf <span class="sc">|</span> stockspacf)</span>
<span id="cb314-388"><a href="#cb314-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-389"><a href="#cb314-389" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-390"><a href="#cb314-390" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-391"><a href="#cb314-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-392"><a href="#cb314-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-393"><a href="#cb314-393" aria-hidden="true" tabindex="-1"></a>After performing First Order Differencing, we can see no significant correlation in the ACF and PACF plots, which makes the data stationary.</span>
<span id="cb314-394"><a href="#cb314-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-395"><a href="#cb314-395" aria-hidden="true" tabindex="-1"></a>Here the parameters are d = 0,1 p = 1,2 (PACF Plot) q = 1,2 (ACF Plot)</span>
<span id="cb314-396"><a href="#cb314-396" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-397"><a href="#cb314-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-398"><a href="#cb314-398" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjusted Dickey-Fuller Test</span></span>
<span id="cb314-399"><a href="#cb314-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-400"><a href="#cb314-400" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-401"><a href="#cb314-401" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-402"><a href="#cb314-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-405"><a href="#cb314-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-406"><a href="#cb314-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-407"><a href="#cb314-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-408"><a href="#cb314-408" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(prices_ts))</span>
<span id="cb314-409"><a href="#cb314-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-410"><a href="#cb314-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-411"><a href="#cb314-411" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-412"><a href="#cb314-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-415"><a href="#cb314-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-416"><a href="#cb314-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-417"><a href="#cb314-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-418"><a href="#cb314-418" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(consumption_ts))</span>
<span id="cb314-419"><a href="#cb314-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-420"><a href="#cb314-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-421"><a href="#cb314-421" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-422"><a href="#cb314-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-425"><a href="#cb314-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-426"><a href="#cb314-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-427"><a href="#cb314-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-428"><a href="#cb314-428" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(production_ts))</span>
<span id="cb314-429"><a href="#cb314-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-430"><a href="#cb314-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-431"><a href="#cb314-431" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-432"><a href="#cb314-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-435"><a href="#cb314-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-436"><a href="#cb314-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-437"><a href="#cb314-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-438"><a href="#cb314-438" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(imports_ts))</span>
<span id="cb314-439"><a href="#cb314-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-440"><a href="#cb314-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-441"><a href="#cb314-441" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-442"><a href="#cb314-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-445"><a href="#cb314-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-446"><a href="#cb314-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-447"><a href="#cb314-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-448"><a href="#cb314-448" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(exports_ts))</span>
<span id="cb314-449"><a href="#cb314-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-450"><a href="#cb314-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-451"><a href="#cb314-451" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-452"><a href="#cb314-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-455"><a href="#cb314-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-456"><a href="#cb314-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-457"><a href="#cb314-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-458"><a href="#cb314-458" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(cvx_stk_ts))</span>
<span id="cb314-459"><a href="#cb314-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-460"><a href="#cb314-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-461"><a href="#cb314-461" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-462"><a href="#cb314-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-465"><a href="#cb314-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-466"><a href="#cb314-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-467"><a href="#cb314-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-468"><a href="#cb314-468" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(co2_ts)</span>
<span id="cb314-469"><a href="#cb314-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-470"><a href="#cb314-470" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-471"><a href="#cb314-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-472"><a href="#cb314-472" aria-hidden="true" tabindex="-1"></a>The ADF test shows that the p-value less than 0.05, therefore we can conclude that all the data used for this analysis is stationary. And it also validates all the observations above.</span>
<span id="cb314-473"><a href="#cb314-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-474"><a href="#cb314-474" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Parameter Selection</span></span>
<span id="cb314-475"><a href="#cb314-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-476"><a href="#cb314-476" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-477"><a href="#cb314-477" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-478"><a href="#cb314-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-479"><a href="#cb314-479" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-480"><a href="#cb314-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-481"><a href="#cb314-481" aria-hidden="true" tabindex="-1"></a>q = 1, 2,3,4</span>
<span id="cb314-482"><a href="#cb314-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-483"><a href="#cb314-483" aria-hidden="true" tabindex="-1"></a>d = 0, 1</span>
<span id="cb314-484"><a href="#cb314-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-485"><a href="#cb314-485" aria-hidden="true" tabindex="-1"></a>p = 1,2,3,4</span>
<span id="cb314-486"><a href="#cb314-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-489"><a href="#cb314-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-490"><a href="#cb314-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-491"><a href="#cb314-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-492"><a href="#cb314-492" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-493"><a href="#cb314-493" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-494"><a href="#cb314-494" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-495"><a href="#cb314-495" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">32</span>),<span class="at">nrow=</span><span class="dv">32</span>) </span>
<span id="cb314-496"><a href="#cb314-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-497"><a href="#cb314-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-498"><a href="#cb314-498" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb314-499"><a href="#cb314-499" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-500"><a href="#cb314-500" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb314-501"><a href="#cb314-501" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-502"><a href="#cb314-502" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb314-503"><a href="#cb314-503" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-504"><a href="#cb314-504" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-505"><a href="#cb314-505" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-506"><a href="#cb314-506" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-507"><a href="#cb314-507" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-508"><a href="#cb314-508" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-509"><a href="#cb314-509" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-510"><a href="#cb314-510" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-511"><a href="#cb314-511" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-512"><a href="#cb314-512" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-513"><a href="#cb314-513" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-514"><a href="#cb314-514" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-515"><a href="#cb314-515" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-516"><a href="#cb314-516" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-517"><a href="#cb314-517" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-518"><a href="#cb314-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-519"><a href="#cb314-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-520"><a href="#cb314-520" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-521"><a href="#cb314-521" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-522"><a href="#cb314-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-523"><a href="#cb314-523" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-524"><a href="#cb314-524" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-525"><a href="#cb314-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-526"><a href="#cb314-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-527"><a href="#cb314-527" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-528"><a href="#cb314-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-531"><a href="#cb314-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-532"><a href="#cb314-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-533"><a href="#cb314-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-534"><a href="#cb314-534" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-535"><a href="#cb314-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-536"><a href="#cb314-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-539"><a href="#cb314-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-540"><a href="#cb314-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-541"><a href="#cb314-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-542"><a href="#cb314-542" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-543"><a href="#cb314-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-544"><a href="#cb314-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-547"><a href="#cb314-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-548"><a href="#cb314-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-549"><a href="#cb314-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-550"><a href="#cb314-550" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-551"><a href="#cb314-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-552"><a href="#cb314-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-553"><a href="#cb314-553" aria-hidden="true" tabindex="-1"></a>According to the above results the **Best Models are :** ARIMA(4,0,4) and ARIMA(2,1,2) .</span>
<span id="cb314-554"><a href="#cb314-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-555"><a href="#cb314-555" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-556"><a href="#cb314-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-557"><a href="#cb314-557" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-558"><a href="#cb314-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-559"><a href="#cb314-559" aria-hidden="true" tabindex="-1"></a>q = 1</span>
<span id="cb314-560"><a href="#cb314-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-561"><a href="#cb314-561" aria-hidden="true" tabindex="-1"></a>d = 0, 1</span>
<span id="cb314-562"><a href="#cb314-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-563"><a href="#cb314-563" aria-hidden="true" tabindex="-1"></a>p = 1,2,3</span>
<span id="cb314-564"><a href="#cb314-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-567"><a href="#cb314-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-568"><a href="#cb314-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-569"><a href="#cb314-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-570"><a href="#cb314-570" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-571"><a href="#cb314-571" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-572"><a href="#cb314-572" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-573"><a href="#cb314-573" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">6</span>),<span class="at">nrow=</span><span class="dv">6</span>) </span>
<span id="cb314-574"><a href="#cb314-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-575"><a href="#cb314-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-576"><a href="#cb314-576" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb314-577"><a href="#cb314-577" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-578"><a href="#cb314-578" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb314-579"><a href="#cb314-579" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-580"><a href="#cb314-580" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb314-581"><a href="#cb314-581" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-582"><a href="#cb314-582" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-583"><a href="#cb314-583" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-584"><a href="#cb314-584" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-585"><a href="#cb314-585" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-586"><a href="#cb314-586" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-587"><a href="#cb314-587" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-588"><a href="#cb314-588" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-589"><a href="#cb314-589" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-590"><a href="#cb314-590" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-591"><a href="#cb314-591" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-592"><a href="#cb314-592" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-593"><a href="#cb314-593" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-594"><a href="#cb314-594" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-595"><a href="#cb314-595" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-596"><a href="#cb314-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-597"><a href="#cb314-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-598"><a href="#cb314-598" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-599"><a href="#cb314-599" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-600"><a href="#cb314-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-601"><a href="#cb314-601" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-602"><a href="#cb314-602" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-603"><a href="#cb314-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-604"><a href="#cb314-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-605"><a href="#cb314-605" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-606"><a href="#cb314-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-609"><a href="#cb314-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-610"><a href="#cb314-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-611"><a href="#cb314-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-612"><a href="#cb314-612" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-613"><a href="#cb314-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-614"><a href="#cb314-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-617"><a href="#cb314-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-618"><a href="#cb314-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-619"><a href="#cb314-619" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-620"><a href="#cb314-620" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-621"><a href="#cb314-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-622"><a href="#cb314-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-625"><a href="#cb314-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-626"><a href="#cb314-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-627"><a href="#cb314-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-628"><a href="#cb314-628" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-629"><a href="#cb314-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-630"><a href="#cb314-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-631"><a href="#cb314-631" aria-hidden="true" tabindex="-1"></a>According to the above results the **Best Model is :** ARIMA(3,1,1).</span>
<span id="cb314-632"><a href="#cb314-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-633"><a href="#cb314-633" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-634"><a href="#cb314-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-635"><a href="#cb314-635" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-636"><a href="#cb314-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-637"><a href="#cb314-637" aria-hidden="true" tabindex="-1"></a>q = 1</span>
<span id="cb314-638"><a href="#cb314-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-639"><a href="#cb314-639" aria-hidden="true" tabindex="-1"></a>d = 0, 1</span>
<span id="cb314-640"><a href="#cb314-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-641"><a href="#cb314-641" aria-hidden="true" tabindex="-1"></a>p = 1,2,3,4</span>
<span id="cb314-642"><a href="#cb314-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-645"><a href="#cb314-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-646"><a href="#cb314-646" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-647"><a href="#cb314-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-648"><a href="#cb314-648" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-649"><a href="#cb314-649" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-650"><a href="#cb314-650" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-651"><a href="#cb314-651" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">8</span>),<span class="at">nrow=</span><span class="dv">8</span>) </span>
<span id="cb314-652"><a href="#cb314-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-653"><a href="#cb314-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-654"><a href="#cb314-654" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb314-655"><a href="#cb314-655" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-656"><a href="#cb314-656" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb314-657"><a href="#cb314-657" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-658"><a href="#cb314-658" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb314-659"><a href="#cb314-659" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-660"><a href="#cb314-660" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-661"><a href="#cb314-661" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-662"><a href="#cb314-662" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-663"><a href="#cb314-663" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-664"><a href="#cb314-664" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-665"><a href="#cb314-665" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-666"><a href="#cb314-666" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-667"><a href="#cb314-667" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-668"><a href="#cb314-668" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-669"><a href="#cb314-669" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-670"><a href="#cb314-670" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-671"><a href="#cb314-671" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-672"><a href="#cb314-672" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-673"><a href="#cb314-673" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-674"><a href="#cb314-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-675"><a href="#cb314-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-676"><a href="#cb314-676" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-677"><a href="#cb314-677" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-678"><a href="#cb314-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-679"><a href="#cb314-679" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-680"><a href="#cb314-680" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-681"><a href="#cb314-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-682"><a href="#cb314-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-683"><a href="#cb314-683" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-684"><a href="#cb314-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-687"><a href="#cb314-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-688"><a href="#cb314-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-689"><a href="#cb314-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-690"><a href="#cb314-690" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-691"><a href="#cb314-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-692"><a href="#cb314-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-695"><a href="#cb314-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-696"><a href="#cb314-696" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-697"><a href="#cb314-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-698"><a href="#cb314-698" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-699"><a href="#cb314-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-700"><a href="#cb314-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-703"><a href="#cb314-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-704"><a href="#cb314-704" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-705"><a href="#cb314-705" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-706"><a href="#cb314-706" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-707"><a href="#cb314-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-708"><a href="#cb314-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-709"><a href="#cb314-709" aria-hidden="true" tabindex="-1"></a>According to the above results the **Best Model is :** ARIMA(4,1,1).</span>
<span id="cb314-710"><a href="#cb314-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-711"><a href="#cb314-711" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-712"><a href="#cb314-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-713"><a href="#cb314-713" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-714"><a href="#cb314-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-715"><a href="#cb314-715" aria-hidden="true" tabindex="-1"></a>q = 1</span>
<span id="cb314-716"><a href="#cb314-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-717"><a href="#cb314-717" aria-hidden="true" tabindex="-1"></a>d = 0, 1</span>
<span id="cb314-718"><a href="#cb314-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-719"><a href="#cb314-719" aria-hidden="true" tabindex="-1"></a>p = 1,2</span>
<span id="cb314-720"><a href="#cb314-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-723"><a href="#cb314-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-724"><a href="#cb314-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-725"><a href="#cb314-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-726"><a href="#cb314-726" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-727"><a href="#cb314-727" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-728"><a href="#cb314-728" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-729"><a href="#cb314-729" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">4</span>) </span>
<span id="cb314-730"><a href="#cb314-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-731"><a href="#cb314-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-732"><a href="#cb314-732" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb314-733"><a href="#cb314-733" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-734"><a href="#cb314-734" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb314-735"><a href="#cb314-735" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-736"><a href="#cb314-736" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb314-737"><a href="#cb314-737" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-738"><a href="#cb314-738" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-739"><a href="#cb314-739" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-740"><a href="#cb314-740" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-741"><a href="#cb314-741" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-742"><a href="#cb314-742" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-743"><a href="#cb314-743" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-744"><a href="#cb314-744" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-745"><a href="#cb314-745" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-746"><a href="#cb314-746" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-747"><a href="#cb314-747" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-748"><a href="#cb314-748" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-749"><a href="#cb314-749" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-750"><a href="#cb314-750" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-751"><a href="#cb314-751" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-752"><a href="#cb314-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-753"><a href="#cb314-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-754"><a href="#cb314-754" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-755"><a href="#cb314-755" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-756"><a href="#cb314-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-757"><a href="#cb314-757" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-758"><a href="#cb314-758" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-759"><a href="#cb314-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-760"><a href="#cb314-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-761"><a href="#cb314-761" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-762"><a href="#cb314-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-765"><a href="#cb314-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-766"><a href="#cb314-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-767"><a href="#cb314-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-768"><a href="#cb314-768" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-769"><a href="#cb314-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-770"><a href="#cb314-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-773"><a href="#cb314-773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-774"><a href="#cb314-774" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-775"><a href="#cb314-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-776"><a href="#cb314-776" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-777"><a href="#cb314-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-778"><a href="#cb314-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-781"><a href="#cb314-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-782"><a href="#cb314-782" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-783"><a href="#cb314-783" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-784"><a href="#cb314-784" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-785"><a href="#cb314-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-786"><a href="#cb314-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-787"><a href="#cb314-787" aria-hidden="true" tabindex="-1"></a>According to the above results the **Best Model is :** ARIMA(1,1,1).</span>
<span id="cb314-788"><a href="#cb314-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-789"><a href="#cb314-789" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-790"><a href="#cb314-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-791"><a href="#cb314-791" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-792"><a href="#cb314-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-793"><a href="#cb314-793" aria-hidden="true" tabindex="-1"></a>q = 1,2</span>
<span id="cb314-794"><a href="#cb314-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-795"><a href="#cb314-795" aria-hidden="true" tabindex="-1"></a>d = 0, 1</span>
<span id="cb314-796"><a href="#cb314-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-797"><a href="#cb314-797" aria-hidden="true" tabindex="-1"></a>p = 1</span>
<span id="cb314-798"><a href="#cb314-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-801"><a href="#cb314-801" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-802"><a href="#cb314-802" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-803"><a href="#cb314-803" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-804"><a href="#cb314-804" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-805"><a href="#cb314-805" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-806"><a href="#cb314-806" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-807"><a href="#cb314-807" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">4</span>) </span>
<span id="cb314-808"><a href="#cb314-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-809"><a href="#cb314-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-810"><a href="#cb314-810" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span>)</span>
<span id="cb314-811"><a href="#cb314-811" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-812"><a href="#cb314-812" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb314-813"><a href="#cb314-813" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-814"><a href="#cb314-814" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb314-815"><a href="#cb314-815" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-816"><a href="#cb314-816" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-817"><a href="#cb314-817" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-818"><a href="#cb314-818" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-819"><a href="#cb314-819" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-820"><a href="#cb314-820" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">diff</span>(exports_ts),<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-821"><a href="#cb314-821" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-822"><a href="#cb314-822" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-823"><a href="#cb314-823" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-824"><a href="#cb314-824" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-825"><a href="#cb314-825" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-826"><a href="#cb314-826" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-827"><a href="#cb314-827" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-828"><a href="#cb314-828" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-829"><a href="#cb314-829" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-830"><a href="#cb314-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-831"><a href="#cb314-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-832"><a href="#cb314-832" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-833"><a href="#cb314-833" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-834"><a href="#cb314-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-835"><a href="#cb314-835" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-836"><a href="#cb314-836" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-837"><a href="#cb314-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-838"><a href="#cb314-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-839"><a href="#cb314-839" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-840"><a href="#cb314-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-843"><a href="#cb314-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-844"><a href="#cb314-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-845"><a href="#cb314-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-846"><a href="#cb314-846" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-847"><a href="#cb314-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-848"><a href="#cb314-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-851"><a href="#cb314-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-852"><a href="#cb314-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-853"><a href="#cb314-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-854"><a href="#cb314-854" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-855"><a href="#cb314-855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-856"><a href="#cb314-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-859"><a href="#cb314-859" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-860"><a href="#cb314-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-861"><a href="#cb314-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-862"><a href="#cb314-862" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-863"><a href="#cb314-863" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-864"><a href="#cb314-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-865"><a href="#cb314-865" aria-hidden="true" tabindex="-1"></a>According to the above results the **Best Model is :** ARIMA(1,1,1).</span>
<span id="cb314-866"><a href="#cb314-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-867"><a href="#cb314-867" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-868"><a href="#cb314-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-869"><a href="#cb314-869" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-870"><a href="#cb314-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-871"><a href="#cb314-871" aria-hidden="true" tabindex="-1"></a>q = 1,2</span>
<span id="cb314-872"><a href="#cb314-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-873"><a href="#cb314-873" aria-hidden="true" tabindex="-1"></a>d = 0, 1</span>
<span id="cb314-874"><a href="#cb314-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-875"><a href="#cb314-875" aria-hidden="true" tabindex="-1"></a>p = 1,2</span>
<span id="cb314-876"><a href="#cb314-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-879"><a href="#cb314-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-880"><a href="#cb314-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-881"><a href="#cb314-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-882"><a href="#cb314-882" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-883"><a href="#cb314-883" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-884"><a href="#cb314-884" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-885"><a href="#cb314-885" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">8</span>),<span class="at">nrow=</span><span class="dv">8</span>) </span>
<span id="cb314-886"><a href="#cb314-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-887"><a href="#cb314-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-888"><a href="#cb314-888" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb314-889"><a href="#cb314-889" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-890"><a href="#cb314-890" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb314-891"><a href="#cb314-891" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-892"><a href="#cb314-892" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb314-893"><a href="#cb314-893" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-894"><a href="#cb314-894" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-895"><a href="#cb314-895" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-896"><a href="#cb314-896" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-897"><a href="#cb314-897" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-898"><a href="#cb314-898" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-899"><a href="#cb314-899" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-900"><a href="#cb314-900" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-901"><a href="#cb314-901" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-902"><a href="#cb314-902" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-903"><a href="#cb314-903" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-904"><a href="#cb314-904" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-905"><a href="#cb314-905" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-906"><a href="#cb314-906" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-907"><a href="#cb314-907" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-908"><a href="#cb314-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-909"><a href="#cb314-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-910"><a href="#cb314-910" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-911"><a href="#cb314-911" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-912"><a href="#cb314-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-913"><a href="#cb314-913" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-914"><a href="#cb314-914" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-915"><a href="#cb314-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-916"><a href="#cb314-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-917"><a href="#cb314-917" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-918"><a href="#cb314-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-921"><a href="#cb314-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-922"><a href="#cb314-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-923"><a href="#cb314-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-924"><a href="#cb314-924" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-925"><a href="#cb314-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-926"><a href="#cb314-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-929"><a href="#cb314-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-930"><a href="#cb314-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-931"><a href="#cb314-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-932"><a href="#cb314-932" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-933"><a href="#cb314-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-934"><a href="#cb314-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-937"><a href="#cb314-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-938"><a href="#cb314-938" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-939"><a href="#cb314-939" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-940"><a href="#cb314-940" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-941"><a href="#cb314-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-942"><a href="#cb314-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-943"><a href="#cb314-943" aria-hidden="true" tabindex="-1"></a>According to the above results the **Best Model is :** ARIMA(1,1,1).</span>
<span id="cb314-944"><a href="#cb314-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-945"><a href="#cb314-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-946"><a href="#cb314-946" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-947"><a href="#cb314-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-948"><a href="#cb314-948" aria-hidden="true" tabindex="-1"></a>Best Parameters Selected from the ACF/PACF plot.</span>
<span id="cb314-949"><a href="#cb314-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-950"><a href="#cb314-950" aria-hidden="true" tabindex="-1"></a>q = 13</span>
<span id="cb314-951"><a href="#cb314-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-952"><a href="#cb314-952" aria-hidden="true" tabindex="-1"></a>d = 0</span>
<span id="cb314-953"><a href="#cb314-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-954"><a href="#cb314-954" aria-hidden="true" tabindex="-1"></a>p = 9, 10, 11, 12, 13</span>
<span id="cb314-955"><a href="#cb314-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-958"><a href="#cb314-958" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-959"><a href="#cb314-959" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-960"><a href="#cb314-960" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-961"><a href="#cb314-961" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-962"><a href="#cb314-962" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-963"><a href="#cb314-963" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-964"><a href="#cb314-964" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">45</span>),<span class="at">nrow=</span><span class="dv">45</span>) </span>
<span id="cb314-965"><a href="#cb314-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-966"><a href="#cb314-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-967"><a href="#cb314-967" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)</span>
<span id="cb314-968"><a href="#cb314-968" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-969"><a href="#cb314-969" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)</span>
<span id="cb314-970"><a href="#cb314-970" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-971"><a href="#cb314-971" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span>)</span>
<span id="cb314-972"><a href="#cb314-972" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-973"><a href="#cb314-973" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-974"><a href="#cb314-974" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb314-975"><a href="#cb314-975" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-976"><a href="#cb314-976" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-977"><a href="#cb314-977" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts,<span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-978"><a href="#cb314-978" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-979"><a href="#cb314-979" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-980"><a href="#cb314-980" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb314-981"><a href="#cb314-981" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb314-982"><a href="#cb314-982" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-983"><a href="#cb314-983" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-984"><a href="#cb314-984" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-985"><a href="#cb314-985" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-986"><a href="#cb314-986" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-987"><a href="#cb314-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-988"><a href="#cb314-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-989"><a href="#cb314-989" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-990"><a href="#cb314-990" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-991"><a href="#cb314-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-992"><a href="#cb314-992" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb314-993"><a href="#cb314-993" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb314-994"><a href="#cb314-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-995"><a href="#cb314-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-996"><a href="#cb314-996" aria-hidden="true" tabindex="-1"></a>Now, let's get the lowest AIC, BIC, AICc</span>
<span id="cb314-997"><a href="#cb314-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1000"><a href="#cb314-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1001"><a href="#cb314-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1002"><a href="#cb314-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1003"><a href="#cb314-1003" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span>
<span id="cb314-1004"><a href="#cb314-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1005"><a href="#cb314-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1008"><a href="#cb314-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1009"><a href="#cb314-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1010"><a href="#cb314-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1011"><a href="#cb314-1011" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb314-1012"><a href="#cb314-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1013"><a href="#cb314-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1016"><a href="#cb314-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1017"><a href="#cb314-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1018"><a href="#cb314-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1019"><a href="#cb314-1019" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb314-1020"><a href="#cb314-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1021"><a href="#cb314-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1022"><a href="#cb314-1022" aria-hidden="true" tabindex="-1"></a>According to the above results the **First Best Model is :** ARIMA(3,0,7) and **Next Best Model is :** ARIMA(2,0,5).</span>
<span id="cb314-1023"><a href="#cb314-1023" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1024"><a href="#cb314-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1025"><a href="#cb314-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">### Auto ARIMA</span></span>
<span id="cb314-1026"><a href="#cb314-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1027"><a href="#cb314-1027" aria-hidden="true" tabindex="-1"></a>Now, let's find the best model using Auto ARIMA and compare the results to the models found above.</span>
<span id="cb314-1028"><a href="#cb314-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1029"><a href="#cb314-1029" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1030"><a href="#cb314-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-1031"><a href="#cb314-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1034"><a href="#cb314-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1035"><a href="#cb314-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1036"><a href="#cb314-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1037"><a href="#cb314-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(prices_ts)</span>
<span id="cb314-1038"><a href="#cb314-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1039"><a href="#cb314-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1040"><a href="#cb314-1040" aria-hidden="true" tabindex="-1"></a>The superior performance of the ARIMA(1,1,1)(2,0,0)<span class="sc">\[</span>12<span class="sc">\]</span> model with drift as compared to the ARIMA(4,0,4) and ARIMA(2,1,2) model could be due to the former's ability to more effectively capture the seasonality within the dataset. While the ARIMA(4,0,4) and ARIMA(2,1,2) model were decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</span>
<span id="cb314-1041"><a href="#cb314-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1042"><a href="#cb314-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-1043"><a href="#cb314-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1046"><a href="#cb314-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1047"><a href="#cb314-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1048"><a href="#cb314-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1049"><a href="#cb314-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(consumption_ts)</span>
<span id="cb314-1050"><a href="#cb314-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1051"><a href="#cb314-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1052"><a href="#cb314-1052" aria-hidden="true" tabindex="-1"></a>The superior performance of the ARIMA(2,0,3)(2,1,2)<span class="sc">\[</span>12<span class="sc">\]</span> model with drift as compared to the ARIMA(3,1,1) model could be due to the former's ability to more effectively capture the seasonality within the dataset. While the ARIMA(3,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</span>
<span id="cb314-1053"><a href="#cb314-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1054"><a href="#cb314-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-1055"><a href="#cb314-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1058"><a href="#cb314-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1059"><a href="#cb314-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1060"><a href="#cb314-1060" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1061"><a href="#cb314-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(production_ts)</span>
<span id="cb314-1062"><a href="#cb314-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1063"><a href="#cb314-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1064"><a href="#cb314-1064" aria-hidden="true" tabindex="-1"></a>The superior performance of the ARIMA(0,1,1)(1,1,1)<span class="sc">\[</span>12<span class="sc">\]</span> model with drift as compared to the ARIMA(4,1,1) model could be due to the former's ability to more effectively capture the seasonality within the dataset. While the ARIMA(4,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</span>
<span id="cb314-1065"><a href="#cb314-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1066"><a href="#cb314-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-1067"><a href="#cb314-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1070"><a href="#cb314-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1071"><a href="#cb314-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1072"><a href="#cb314-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1073"><a href="#cb314-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(imports_ts)</span>
<span id="cb314-1074"><a href="#cb314-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1075"><a href="#cb314-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1076"><a href="#cb314-1076" aria-hidden="true" tabindex="-1"></a>The superior performance of the ARIMA(0,1,3)(1,1,1)<span class="sc">\[</span>12<span class="sc">\]</span> model with drift as compared to the ARIMA(1,1,1) model could be due to the former's ability to more effectively capture the seasonality within the dataset. While the ARIMA(1,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</span>
<span id="cb314-1077"><a href="#cb314-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1078"><a href="#cb314-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-1079"><a href="#cb314-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1082"><a href="#cb314-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1083"><a href="#cb314-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1084"><a href="#cb314-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1085"><a href="#cb314-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(exports_ts)</span>
<span id="cb314-1086"><a href="#cb314-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1087"><a href="#cb314-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1088"><a href="#cb314-1088" aria-hidden="true" tabindex="-1"></a>The superior performance of the ARIMA(0,1,1)(1,0,0)<span class="sc">\[</span>12<span class="sc">\]</span> model with drift as compared to the ARIMA(1,1,1) model could be due to the former's ability to more effectively capture the seasonality within the dataset. While the ARIMA(1,1,1) model was decent, it may have not fully addressed the non-stationarity. The dataset likely exhibits strong seasonal patterns that a simple ARIMA model cannot adequately model, hence the need for a SARIMA (Seasonal ARIMA) approach. The SARIMA model includes seasonal differencing, which helps in managing seasonal structures that ARIMA models do not account for.</span>
<span id="cb314-1089"><a href="#cb314-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1090"><a href="#cb314-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-1091"><a href="#cb314-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1094"><a href="#cb314-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1095"><a href="#cb314-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1096"><a href="#cb314-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1097"><a href="#cb314-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(cvx_stk_ts)</span>
<span id="cb314-1098"><a href="#cb314-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1099"><a href="#cb314-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1100"><a href="#cb314-1100" aria-hidden="true" tabindex="-1"></a>The best model from the step above was ARIMA(1,1,1), while the best model Auto ARIMA gave me is ARIMA(0,1,2). We see that model from the step above has lower AIC, BIC and AICc than auto ARIMA model. Therefore, we'll do further analysis to choose the best model.</span>
<span id="cb314-1101"><a href="#cb314-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1102"><a href="#cb314-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-1103"><a href="#cb314-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1106"><a href="#cb314-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1107"><a href="#cb314-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1108"><a href="#cb314-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1109"><a href="#cb314-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(co2_ts)</span>
<span id="cb314-1110"><a href="#cb314-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1111"><a href="#cb314-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1112"><a href="#cb314-1112" aria-hidden="true" tabindex="-1"></a>The best model from the step above was ARIMA(3,0,7), while the best model Auto ARIMA gave me is ARIMA(5,0,1). We see that model from the step above has lower AIC, BIC and AICc than auto ARIMA model. Therefore, we'll do further analysis to choose the best model.</span>
<span id="cb314-1113"><a href="#cb314-1113" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1114"><a href="#cb314-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1115"><a href="#cb314-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Selection &amp; Fitting</span></span>
<span id="cb314-1116"><a href="#cb314-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1117"><a href="#cb314-1117" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1118"><a href="#cb314-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1119"><a href="#cb314-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-1120"><a href="#cb314-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1121"><a href="#cb314-1121" aria-hidden="true" tabindex="-1"></a>The best models selected from the steps above was ARIMA(4,0,4) and ARIMA(2,1,2)</span>
<span id="cb314-1122"><a href="#cb314-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1123"><a href="#cb314-1123" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1124"><a href="#cb314-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1125"><a href="#cb314-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model1: ARIMA(4,0,4)</span></span>
<span id="cb314-1126"><a href="#cb314-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1129"><a href="#cb314-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1130"><a href="#cb314-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1131"><a href="#cb314-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1132"><a href="#cb314-1132" aria-hidden="true" tabindex="-1"></a>fit1_prices_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-1133"><a href="#cb314-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_prices_ts)</span>
<span id="cb314-1134"><a href="#cb314-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1135"><a href="#cb314-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1136"><a href="#cb314-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model2: ARIMA(2,1,2)</span></span>
<span id="cb314-1137"><a href="#cb314-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1140"><a href="#cb314-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1141"><a href="#cb314-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1142"><a href="#cb314-1142" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1143"><a href="#cb314-1143" aria-hidden="true" tabindex="-1"></a>fit2_prices_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-1144"><a href="#cb314-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_prices_ts)</span>
<span id="cb314-1145"><a href="#cb314-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1146"><a href="#cb314-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1147"><a href="#cb314-1147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1148"><a href="#cb314-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1149"><a href="#cb314-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-1150"><a href="#cb314-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1151"><a href="#cb314-1151" aria-hidden="true" tabindex="-1"></a>The best model from the steps above was ARIMA(3,1,1)</span>
<span id="cb314-1152"><a href="#cb314-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1155"><a href="#cb314-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1156"><a href="#cb314-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1157"><a href="#cb314-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1158"><a href="#cb314-1158" aria-hidden="true" tabindex="-1"></a>fit_consumption_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb314-1159"><a href="#cb314-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_consumption_ts)</span>
<span id="cb314-1160"><a href="#cb314-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1161"><a href="#cb314-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1162"><a href="#cb314-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-1163"><a href="#cb314-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1164"><a href="#cb314-1164" aria-hidden="true" tabindex="-1"></a>The best model from the steps above was ARIMA(4,1,1)</span>
<span id="cb314-1165"><a href="#cb314-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1168"><a href="#cb314-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1169"><a href="#cb314-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1170"><a href="#cb314-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1171"><a href="#cb314-1171" aria-hidden="true" tabindex="-1"></a>fit_production_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb314-1172"><a href="#cb314-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_production_ts)</span>
<span id="cb314-1173"><a href="#cb314-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1174"><a href="#cb314-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1175"><a href="#cb314-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-1176"><a href="#cb314-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1177"><a href="#cb314-1177" aria-hidden="true" tabindex="-1"></a>The best model from the steps above was ARIMA(1,1,1)</span>
<span id="cb314-1178"><a href="#cb314-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1181"><a href="#cb314-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1182"><a href="#cb314-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1183"><a href="#cb314-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1184"><a href="#cb314-1184" aria-hidden="true" tabindex="-1"></a>fit_imports_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb314-1185"><a href="#cb314-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_imports_ts)</span>
<span id="cb314-1186"><a href="#cb314-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1187"><a href="#cb314-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1188"><a href="#cb314-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-1189"><a href="#cb314-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1190"><a href="#cb314-1190" aria-hidden="true" tabindex="-1"></a>The best model from the steps above was ARIMA(1,1,1)</span>
<span id="cb314-1191"><a href="#cb314-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1194"><a href="#cb314-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1195"><a href="#cb314-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1196"><a href="#cb314-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1197"><a href="#cb314-1197" aria-hidden="true" tabindex="-1"></a>fit_exports_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(exports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb314-1198"><a href="#cb314-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_exports_ts)</span>
<span id="cb314-1199"><a href="#cb314-1199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1200"><a href="#cb314-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1201"><a href="#cb314-1201" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-1202"><a href="#cb314-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1203"><a href="#cb314-1203" aria-hidden="true" tabindex="-1"></a>The best model from the steps above were ARIMA(1,1,1) and ARIMA(0,1,2)</span>
<span id="cb314-1204"><a href="#cb314-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1205"><a href="#cb314-1205" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1206"><a href="#cb314-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1207"><a href="#cb314-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model1: ARIMA(1,1,1)</span></span>
<span id="cb314-1210"><a href="#cb314-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1211"><a href="#cb314-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1212"><a href="#cb314-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1213"><a href="#cb314-1213" aria-hidden="true" tabindex="-1"></a>fit1_cvx_stk_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb314-1214"><a href="#cb314-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_cvx_stk_ts)</span>
<span id="cb314-1215"><a href="#cb314-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1216"><a href="#cb314-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1217"><a href="#cb314-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model2: ARIMA(0,1,2)</span></span>
<span id="cb314-1220"><a href="#cb314-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1221"><a href="#cb314-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1222"><a href="#cb314-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1223"><a href="#cb314-1223" aria-hidden="true" tabindex="-1"></a>fit2_cvx_stk_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>) </span>
<span id="cb314-1224"><a href="#cb314-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_cvx_stk_ts)</span>
<span id="cb314-1225"><a href="#cb314-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1226"><a href="#cb314-1226" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1227"><a href="#cb314-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1228"><a href="#cb314-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-1229"><a href="#cb314-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1230"><a href="#cb314-1230" aria-hidden="true" tabindex="-1"></a>The best model from the steps above were ARIMA(3,0,7) and ARIMA(5,0,1)</span>
<span id="cb314-1231"><a href="#cb314-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1232"><a href="#cb314-1232" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1233"><a href="#cb314-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1234"><a href="#cb314-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model1: ARIMA(3,0,7)</span></span>
<span id="cb314-1237"><a href="#cb314-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1238"><a href="#cb314-1238" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1239"><a href="#cb314-1239" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1240"><a href="#cb314-1240" aria-hidden="true" tabindex="-1"></a>fit1_co2_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">7</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-1241"><a href="#cb314-1241" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_co2_ts)</span>
<span id="cb314-1242"><a href="#cb314-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1243"><a href="#cb314-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1244"><a href="#cb314-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model2: ARIMA(5,0,1)</span></span>
<span id="cb314-1247"><a href="#cb314-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1248"><a href="#cb314-1248" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1249"><a href="#cb314-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1250"><a href="#cb314-1250" aria-hidden="true" tabindex="-1"></a>fit2_co2_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>) </span>
<span id="cb314-1251"><a href="#cb314-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_co2_ts)</span>
<span id="cb314-1252"><a href="#cb314-1252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1253"><a href="#cb314-1253" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1254"><a href="#cb314-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1255"><a href="#cb314-1255" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1256"><a href="#cb314-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1257"><a href="#cb314-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Diagnostics</span></span>
<span id="cb314-1258"><a href="#cb314-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1259"><a href="#cb314-1259" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1260"><a href="#cb314-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-1261"><a href="#cb314-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1262"><a href="#cb314-1262" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1263"><a href="#cb314-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1264"><a href="#cb314-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model1: ARIMA(4,0,4)</span></span>
<span id="cb314-1267"><a href="#cb314-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1268"><a href="#cb314-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1269"><a href="#cb314-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1270"><a href="#cb314-1270" aria-hidden="true" tabindex="-1"></a>model_output_p1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(<span class="fu">diff</span>(prices_ts),<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb314-1271"><a href="#cb314-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1272"><a href="#cb314-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1275"><a href="#cb314-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1276"><a href="#cb314-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1277"><a href="#cb314-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1278"><a href="#cb314-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_p1[<span class="dv">213</span><span class="sc">:</span><span class="dv">228</span>], model_output_p1[<span class="fu">length</span>(model_output_p1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1279"><a href="#cb314-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1280"><a href="#cb314-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1281"><a href="#cb314-1281" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model2: ARIMA(2,1,2)</span></span>
<span id="cb314-1284"><a href="#cb314-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1285"><a href="#cb314-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1286"><a href="#cb314-1286" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1287"><a href="#cb314-1287" aria-hidden="true" tabindex="-1"></a>model_output_p2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(<span class="fu">diff</span>(prices_ts),<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb314-1288"><a href="#cb314-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1289"><a href="#cb314-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1292"><a href="#cb314-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1293"><a href="#cb314-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1294"><a href="#cb314-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1295"><a href="#cb314-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_p2[<span class="dv">79</span><span class="sc">:</span><span class="dv">90</span>], model_output_p2[<span class="fu">length</span>(model_output_p2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1296"><a href="#cb314-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1297"><a href="#cb314-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1298"><a href="#cb314-1298" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1299"><a href="#cb314-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1300"><a href="#cb314-1300" aria-hidden="true" tabindex="-1"></a>The standard residual plot for both the models looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot for model 1 reveals no correlation, suggesting that the model 1 has captured all the dependencies in the data, leaving no degree of correlation unexplained. The Q-Q plot for both the models suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces most of the values under the 0.05 significance level for both the models, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data. However, the AIC and AICc values for model 1 i.e. ARIMA(4,0,4) is better than model 2 i.e. ARIMA(2,1,2). Hence, ARIMA(4,0,4) is the best model.</span>
<span id="cb314-1301"><a href="#cb314-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1302"><a href="#cb314-1302" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-1303"><a href="#cb314-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1306"><a href="#cb314-1306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1307"><a href="#cb314-1307" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1308"><a href="#cb314-1308" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1309"><a href="#cb314-1309" aria-hidden="true" tabindex="-1"></a>model_output_c1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb314-1310"><a href="#cb314-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1311"><a href="#cb314-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1314"><a href="#cb314-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1315"><a href="#cb314-1315" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1316"><a href="#cb314-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1317"><a href="#cb314-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_c1[<span class="dv">50</span><span class="sc">:</span><span class="dv">64</span>], model_output_c1[<span class="fu">length</span>(model_output_c1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1318"><a href="#cb314-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1319"><a href="#cb314-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1320"><a href="#cb314-1320" aria-hidden="true" tabindex="-1"></a>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</span>
<span id="cb314-1321"><a href="#cb314-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1322"><a href="#cb314-1322" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-1323"><a href="#cb314-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1326"><a href="#cb314-1326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1327"><a href="#cb314-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1328"><a href="#cb314-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1329"><a href="#cb314-1329" aria-hidden="true" tabindex="-1"></a>model_output_prod1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb314-1330"><a href="#cb314-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1331"><a href="#cb314-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1334"><a href="#cb314-1334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1335"><a href="#cb314-1335" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1336"><a href="#cb314-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1337"><a href="#cb314-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_prod1[<span class="dv">39</span><span class="sc">:</span><span class="dv">54</span>], model_output_prod1[<span class="fu">length</span>(model_output_prod1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1338"><a href="#cb314-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1339"><a href="#cb314-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1340"><a href="#cb314-1340" aria-hidden="true" tabindex="-1"></a>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces most of the values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</span>
<span id="cb314-1341"><a href="#cb314-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1342"><a href="#cb314-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-1343"><a href="#cb314-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1346"><a href="#cb314-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1347"><a href="#cb314-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1348"><a href="#cb314-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1349"><a href="#cb314-1349" aria-hidden="true" tabindex="-1"></a>model_output_i1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(imports_ts,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb314-1350"><a href="#cb314-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1351"><a href="#cb314-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1354"><a href="#cb314-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1355"><a href="#cb314-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1356"><a href="#cb314-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1357"><a href="#cb314-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_i1[<span class="dv">28</span><span class="sc">:</span><span class="dv">39</span>], model_output_i1[<span class="fu">length</span>(model_output_i1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1358"><a href="#cb314-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1359"><a href="#cb314-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1360"><a href="#cb314-1360" aria-hidden="true" tabindex="-1"></a>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</span>
<span id="cb314-1361"><a href="#cb314-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1362"><a href="#cb314-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-1363"><a href="#cb314-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1366"><a href="#cb314-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1367"><a href="#cb314-1367" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1368"><a href="#cb314-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1369"><a href="#cb314-1369" aria-hidden="true" tabindex="-1"></a>model_output_e1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(exports_ts,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb314-1370"><a href="#cb314-1370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1371"><a href="#cb314-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1374"><a href="#cb314-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1375"><a href="#cb314-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1376"><a href="#cb314-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1377"><a href="#cb314-1377" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_e1[<span class="dv">22</span><span class="sc">:</span><span class="dv">33</span>], model_output_e1[<span class="fu">length</span>(model_output_e1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1378"><a href="#cb314-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1379"><a href="#cb314-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1380"><a href="#cb314-1380" aria-hidden="true" tabindex="-1"></a>The standard residual plot looks promising, indicating a relatively stable mean and variance, although there are noticeable spikes. The ACF plot reveals minimal correlation, suggesting that the current model has not captured all the dependencies in the data, leaving some degree of correlation unexplained. The Q-Q plot suggests that the residuals are approximately normally distributed. However, the Ljung-Box test produces most of the values under the 0.05 significance level, implying the presence of significant correlations within the residuals. This indicates that a SARIMA model, which can better account for seasonality, may provide a more accurate fit for the data.</span>
<span id="cb314-1381"><a href="#cb314-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1382"><a href="#cb314-1382" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-1383"><a href="#cb314-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1384"><a href="#cb314-1384" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1385"><a href="#cb314-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1386"><a href="#cb314-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model1: ARIMA(1,1,1)</span></span>
<span id="cb314-1389"><a href="#cb314-1389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1390"><a href="#cb314-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1391"><a href="#cb314-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1392"><a href="#cb314-1392" aria-hidden="true" tabindex="-1"></a>model_output_s1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(cvx_stk_ts,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb314-1393"><a href="#cb314-1393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1394"><a href="#cb314-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1397"><a href="#cb314-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1398"><a href="#cb314-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1399"><a href="#cb314-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1400"><a href="#cb314-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_s1[<span class="dv">21</span><span class="sc">:</span><span class="dv">33</span>], model_output_s1[<span class="fu">length</span>(model_output_s1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1401"><a href="#cb314-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1402"><a href="#cb314-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1403"><a href="#cb314-1403" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model2: ARIMA(0,1,2)</span></span>
<span id="cb314-1406"><a href="#cb314-1406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1407"><a href="#cb314-1407" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1408"><a href="#cb314-1408" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1409"><a href="#cb314-1409" aria-hidden="true" tabindex="-1"></a>model_output_s2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(cvx_stk_ts,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb314-1410"><a href="#cb314-1410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1411"><a href="#cb314-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1414"><a href="#cb314-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1415"><a href="#cb314-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1416"><a href="#cb314-1416" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1417"><a href="#cb314-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_s2[<span class="dv">15</span><span class="sc">:</span><span class="dv">24</span>], model_output_s2[<span class="fu">length</span>(model_output_s2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1418"><a href="#cb314-1418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1419"><a href="#cb314-1419" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1420"><a href="#cb314-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1421"><a href="#cb314-1421" aria-hidden="true" tabindex="-1"></a>For both the models, the Standard Residual Plot looks promising, indicating stationarity with consistent mean and variance across the series. The Autocorrelation Function (ACF) plot presents minimal correlation, suggesting the model has captured the majority of the information in the data, leaving behind what appears to be merely white noise. This is a sign of an appropriate model fit. The Quantile-Quantile (Q-Q) Plot approximates normal distribution, reinforcing the model's adequacy. Lastly, the Ljung-Box test yields some values exceeding the 0.05 significance level, implying that any remaining correlations in the residuals are not statistically significant, which further supports the model's suitability. However, the AIC, BIC and AICc values for model 1 i.e. ARIMA(1,1,1) is better than model 2 i.e. ARIMA(0,1,2). Hence, ARIMA(1,1,1) is the best model.</span>
<span id="cb314-1422"><a href="#cb314-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1423"><a href="#cb314-1423" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-1424"><a href="#cb314-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1425"><a href="#cb314-1425" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1426"><a href="#cb314-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1427"><a href="#cb314-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model1: ARIMA(3,0,7)</span></span>
<span id="cb314-1430"><a href="#cb314-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1431"><a href="#cb314-1431" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1432"><a href="#cb314-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1433"><a href="#cb314-1433" aria-hidden="true" tabindex="-1"></a>model_output_ce1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(co2_ts,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">7</span>))</span>
<span id="cb314-1434"><a href="#cb314-1434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1435"><a href="#cb314-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1438"><a href="#cb314-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1439"><a href="#cb314-1439" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1440"><a href="#cb314-1440" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1441"><a href="#cb314-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_ce1[<span class="dv">57</span><span class="sc">:</span><span class="dv">77</span>], model_output_ce1[<span class="fu">length</span>(model_output_ce1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1442"><a href="#cb314-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1443"><a href="#cb314-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1444"><a href="#cb314-1444" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model2: ARIMA(5,0,1)</span></span>
<span id="cb314-1447"><a href="#cb314-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1448"><a href="#cb314-1448" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1449"><a href="#cb314-1449" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1450"><a href="#cb314-1450" aria-hidden="true" tabindex="-1"></a>model_output_ce2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(co2_ts,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb314-1451"><a href="#cb314-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1452"><a href="#cb314-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1455"><a href="#cb314-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1456"><a href="#cb314-1456" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1457"><a href="#cb314-1457" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1458"><a href="#cb314-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_ce2[<span class="dv">36</span><span class="sc">:</span><span class="dv">49</span>], model_output_ce2[<span class="fu">length</span>(model_output_ce2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-1459"><a href="#cb314-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1460"><a href="#cb314-1460" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1461"><a href="#cb314-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1462"><a href="#cb314-1462" aria-hidden="true" tabindex="-1"></a>For both the models, the Standard Residual Plot looks promising, indicating stationarity with consistent mean and variance across the series. The Autocorrelation Function (ACF) plot presents minimal correlation, suggesting the model has captured the majority of the information in the data, leaving behind what appears to be merely white noise. This is a sign of an appropriate model fit. The Quantile-Quantile (Q-Q) Plot approximates near-normal distribution, reinforcing the model's adequacy. Lastly, the Ljung-Box test yields some values exceeding the 0.05 significance level for model2, implying that any remaining correlations in the residuals are not statistically significant, which further supports the model's suitability. However, the AIC, BIC and AICc values for model 1 i.e. ARIMA(3,0,7) is better than model 2 i.e. ARIMA(5,0,1). Hence, ARIMA(3,0,7) is the best model.</span>
<span id="cb314-1463"><a href="#cb314-1463" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1464"><a href="#cb314-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1465"><a href="#cb314-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final Model Fitting</span></span>
<span id="cb314-1466"><a href="#cb314-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1467"><a href="#cb314-1467" aria-hidden="true" tabindex="-1"></a>Here I'll fit the best model obtained from the above analysis</span>
<span id="cb314-1468"><a href="#cb314-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1469"><a href="#cb314-1469" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1470"><a href="#cb314-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1471"><a href="#cb314-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-1472"><a href="#cb314-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1475"><a href="#cb314-1475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1476"><a href="#cb314-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1477"><a href="#cb314-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1478"><a href="#cb314-1478" aria-hidden="true" tabindex="-1"></a>fit_prices <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb314-1479"><a href="#cb314-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_prices)</span>
<span id="cb314-1480"><a href="#cb314-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1481"><a href="#cb314-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1482"><a href="#cb314-1482" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= -0.0636x_{t-1}-0.0499x_{t-2}+0.1538x_{t-3}+0.6928x_{t-4}+ w_t+ 0.9653w_{t-1}+1.0853w_{t-2} +0.9244w_{t-3}  +0.1833w_{t-4}$</span>
<span id="cb314-1483"><a href="#cb314-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1484"><a href="#cb314-1484" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-1485"><a href="#cb314-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1488"><a href="#cb314-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1489"><a href="#cb314-1489" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1490"><a href="#cb314-1490" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1491"><a href="#cb314-1491" aria-hidden="true" tabindex="-1"></a>fit_consumption <span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb314-1492"><a href="#cb314-1492" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_consumption)</span>
<span id="cb314-1493"><a href="#cb314-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1494"><a href="#cb314-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1495"><a href="#cb314-1495" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= 1.0319x_{t-1}-0.3683x_{t-2}-0.1805x_{t-3}+ w_t -0.9426 w_{t-1}$</span>
<span id="cb314-1496"><a href="#cb314-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1497"><a href="#cb314-1497" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-1498"><a href="#cb314-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1501"><a href="#cb314-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1502"><a href="#cb314-1502" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1503"><a href="#cb314-1503" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1504"><a href="#cb314-1504" aria-hidden="true" tabindex="-1"></a>fit_production <span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb314-1505"><a href="#cb314-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_production)</span>
<span id="cb314-1506"><a href="#cb314-1506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1507"><a href="#cb314-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1508"><a href="#cb314-1508" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= -1.3277x_{t-1}-0.9170x_{t-2}-0.5585x_{t-3}-0.3339x_{t-4}+ w_t +  0.5135 w_{t-1}$</span>
<span id="cb314-1509"><a href="#cb314-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1510"><a href="#cb314-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-1511"><a href="#cb314-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1514"><a href="#cb314-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1515"><a href="#cb314-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1516"><a href="#cb314-1516" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1517"><a href="#cb314-1517" aria-hidden="true" tabindex="-1"></a>fit_imports <span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb314-1518"><a href="#cb314-1518" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_imports)</span>
<span id="cb314-1519"><a href="#cb314-1519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1520"><a href="#cb314-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1521"><a href="#cb314-1521" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= 0.4841x_{t-1} + w_t -0.8693 w_{t-1}$</span>
<span id="cb314-1522"><a href="#cb314-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1523"><a href="#cb314-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-1524"><a href="#cb314-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1527"><a href="#cb314-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1528"><a href="#cb314-1528" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1529"><a href="#cb314-1529" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1530"><a href="#cb314-1530" aria-hidden="true" tabindex="-1"></a>fit_exports <span class="ot">&lt;-</span> <span class="fu">Arima</span>(exports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb314-1531"><a href="#cb314-1531" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_exports)</span>
<span id="cb314-1532"><a href="#cb314-1532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1533"><a href="#cb314-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1534"><a href="#cb314-1534" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= -0.5604x_{t-1} + w_t +0.2505w_{t-1}$</span>
<span id="cb314-1535"><a href="#cb314-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1536"><a href="#cb314-1536" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-1537"><a href="#cb314-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1540"><a href="#cb314-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1541"><a href="#cb314-1541" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1542"><a href="#cb314-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1543"><a href="#cb314-1543" aria-hidden="true" tabindex="-1"></a>fit_stocks <span class="ot">&lt;-</span> <span class="fu">Arima</span>(cvx_stk_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb314-1544"><a href="#cb314-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_stocks)</span>
<span id="cb314-1545"><a href="#cb314-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1546"><a href="#cb314-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1547"><a href="#cb314-1547" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= -0.5014x_{t-1} + w_t +0.4575w_{t-1}$</span>
<span id="cb314-1548"><a href="#cb314-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1549"><a href="#cb314-1549" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-1550"><a href="#cb314-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1553"><a href="#cb314-1553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1554"><a href="#cb314-1554" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1555"><a href="#cb314-1555" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1556"><a href="#cb314-1556" aria-hidden="true" tabindex="-1"></a>fit_co2emissions <span class="ot">&lt;-</span> <span class="fu">Arima</span>(co2_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">7</span>))</span>
<span id="cb314-1557"><a href="#cb314-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_co2emissions)</span>
<span id="cb314-1558"><a href="#cb314-1558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1559"><a href="#cb314-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1560"><a href="#cb314-1560" aria-hidden="true" tabindex="-1"></a>**Equation** $x_t= 0.3492x_{t-1}-0.0203x_{t-2}-0.1420x_{t-3} + w_t -0.3656w_{t-1} -0.0197w_{t-2} +0.0865w_{t-3}+ 0.0054w_{t-4}+ 0.1142w_{t-5}+ 0.5095w_{t-6}-0.9066w_{t-7}$</span>
<span id="cb314-1561"><a href="#cb314-1561" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1562"><a href="#cb314-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1563"><a href="#cb314-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting</span></span>
<span id="cb314-1564"><a href="#cb314-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1565"><a href="#cb314-1565" aria-hidden="true" tabindex="-1"></a>Next, we forecast the values and plot the forecasts using the best model selected above.</span>
<span id="cb314-1566"><a href="#cb314-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1567"><a href="#cb314-1567" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1568"><a href="#cb314-1568" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-1569"><a href="#cb314-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1572"><a href="#cb314-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1573"><a href="#cb314-1573" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1574"><a href="#cb314-1574" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1575"><a href="#cb314-1575" aria-hidden="true" tabindex="-1"></a>pred_prices_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_prices,<span class="dv">15</span>)</span>
<span id="cb314-1576"><a href="#cb314-1576" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_prices_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1577"><a href="#cb314-1577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1578"><a href="#cb314-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1579"><a href="#cb314-1579" aria-hidden="true" tabindex="-1"></a>The forecasted trend decline downwards. The prediction interval widens as time progresses, which is typical in time series forecasts as uncertainty increases with longer forecast horizons. The model seems to expect the continuation of the cyclical behavior, but with an downward trend in the mean of the series. However, the forecast does not show any sharp increases or decreases, indicating that the model does not anticipate any abrupt changes in the pattern of prices.</span>
<span id="cb314-1580"><a href="#cb314-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1581"><a href="#cb314-1581" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-1582"><a href="#cb314-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1585"><a href="#cb314-1585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1586"><a href="#cb314-1586" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1587"><a href="#cb314-1587" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1588"><a href="#cb314-1588" aria-hidden="true" tabindex="-1"></a>pred_consumption_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_consumption,<span class="dv">15</span>)</span>
<span id="cb314-1589"><a href="#cb314-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_consumption_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1590"><a href="#cb314-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1591"><a href="#cb314-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1592"><a href="#cb314-1592" aria-hidden="true" tabindex="-1"></a>The forecast plot illustrates an initial rise in natural gas consumption, which swiftly dips and then climbs once more. While the model captures the cyclical nature of the demand, it seems to underestimate the magnitude of these seasonal swings. The anticipated peaks in consumption are comparable to or exceed previous levels, indicating the model's limited ability to fully account for the strength of these seasonal variations.</span>
<span id="cb314-1593"><a href="#cb314-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1594"><a href="#cb314-1594" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-1595"><a href="#cb314-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1598"><a href="#cb314-1598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1599"><a href="#cb314-1599" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1600"><a href="#cb314-1600" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1601"><a href="#cb314-1601" aria-hidden="true" tabindex="-1"></a>pred_production_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_production,<span class="dv">15</span>)</span>
<span id="cb314-1602"><a href="#cb314-1602" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_production_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1603"><a href="#cb314-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1604"><a href="#cb314-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1605"><a href="#cb314-1605" aria-hidden="true" tabindex="-1"></a>The forecast suggests a continued upward trend in production, consistent with the observed increase over the historical period. This aligns with the "with drift" aspect of the model, which typically represents a steady average change over time, rather than a static mean level. The anticipated peaks in production are comparable to or exceed previous levels, indicating the model's limited ability to fully account for the strength of these seasonal variations.</span>
<span id="cb314-1606"><a href="#cb314-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1607"><a href="#cb314-1607" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-1608"><a href="#cb314-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1611"><a href="#cb314-1611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1612"><a href="#cb314-1612" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1613"><a href="#cb314-1613" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1614"><a href="#cb314-1614" aria-hidden="true" tabindex="-1"></a>pred_imports_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_imports,<span class="dv">15</span>)</span>
<span id="cb314-1615"><a href="#cb314-1615" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_imports_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1616"><a href="#cb314-1616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1617"><a href="#cb314-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1618"><a href="#cb314-1618" aria-hidden="true" tabindex="-1"></a>The forecast plot predicts a falling trajectory in import data over the forthcoming fifteen-year span. The shaded bands delineate the 95% confidence interval, encapsulating the range within which future data points are expected to fall with a high degree of certainty. However, the forecasted line seems overly smooth, lacking any evident fluctuations. This suggests that the model may not adequately account for potential variability and could be oversimplifying the complex nature of the underlying processes influencing imports.</span>
<span id="cb314-1619"><a href="#cb314-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1620"><a href="#cb314-1620" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-1621"><a href="#cb314-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1624"><a href="#cb314-1624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1625"><a href="#cb314-1625" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1626"><a href="#cb314-1626" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1627"><a href="#cb314-1627" aria-hidden="true" tabindex="-1"></a>pred_exports_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_exports,<span class="dv">15</span>)</span>
<span id="cb314-1628"><a href="#cb314-1628" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_exports_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1629"><a href="#cb314-1629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1630"><a href="#cb314-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1631"><a href="#cb314-1631" aria-hidden="true" tabindex="-1"></a>The forecast plot predicts a rising trajectory in export data over the forthcoming fifteen-year span. The shaded bands delineate the 95% confidence interval, encapsulating the range within which future data points are expected to fall with a high degree of certainty. However, the forecasted line seems overly smooth, lacking any evident fluctuations. This suggests that the model may not adequately account for potential variability and could be oversimplifying the complex nature of the underlying processes influencing imports.</span>
<span id="cb314-1632"><a href="#cb314-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1633"><a href="#cb314-1633" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-1634"><a href="#cb314-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1637"><a href="#cb314-1637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1638"><a href="#cb314-1638" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1639"><a href="#cb314-1639" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1640"><a href="#cb314-1640" aria-hidden="true" tabindex="-1"></a>pred_cvx_stk_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_stocks,<span class="dv">365</span>)</span>
<span id="cb314-1641"><a href="#cb314-1641" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_cvx_stk_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1642"><a href="#cb314-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1643"><a href="#cb314-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1644"><a href="#cb314-1644" aria-hidden="true" tabindex="-1"></a>The forecast plot predicts a rising trajectory in CVX Stocks data over the forthcoming fifteen-year span. The shaded bands delineate the 95% confidence interval, encapsulating the range within which future data points are expected to fall with a high degree of certainty. However, the forecasted line seems overly smooth, lacking any evident fluctuations. This suggests that the model may not adequately account for potential variability and could be oversimplifying the complex nature of the underlying processes influencing imports.</span>
<span id="cb314-1645"><a href="#cb314-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1646"><a href="#cb314-1646" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-1647"><a href="#cb314-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1650"><a href="#cb314-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1651"><a href="#cb314-1651" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1652"><a href="#cb314-1652" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1653"><a href="#cb314-1653" aria-hidden="true" tabindex="-1"></a>pred_co2_ts<span class="ot">=</span><span class="fu">forecast</span>(fit_co2emissions,<span class="dv">15</span>)</span>
<span id="cb314-1654"><a href="#cb314-1654" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pred_co2_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-1655"><a href="#cb314-1655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1656"><a href="#cb314-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1657"><a href="#cb314-1657" aria-hidden="true" tabindex="-1"></a>The forecast plot projects an ongoing pattern consistent with the historical seasonal trend in CO2 emissions data. While the model replicates the seasonal nature of the post-2020 data, the predicted variations seem to be of a lesser magnitude. Hence, the model appears to underrepresent the full intensity of the seasonal fluctuations observed in the emissions data.</span>
<span id="cb314-1658"><a href="#cb314-1658" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1659"><a href="#cb314-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1660"><a href="#cb314-1660" aria-hidden="true" tabindex="-1"></a><span class="fu">### ARIMA vs. benchmark methods.</span></span>
<span id="cb314-1661"><a href="#cb314-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1662"><a href="#cb314-1662" aria-hidden="true" tabindex="-1"></a>This section plots and compares the performance of ARIMA model with the benchmark methods</span>
<span id="cb314-1663"><a href="#cb314-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1664"><a href="#cb314-1664" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-1665"><a href="#cb314-1665" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-1666"><a href="#cb314-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1669"><a href="#cb314-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1670"><a href="#cb314-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1671"><a href="#cb314-1671" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1672"><a href="#cb314-1672" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prices_ts) <span class="sc">+</span></span>
<span id="cb314-1673"><a href="#cb314-1673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1674"><a href="#cb314-1674" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1675"><a href="#cb314-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1676"><a href="#cb314-1676" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1677"><a href="#cb314-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1678"><a href="#cb314-1678" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1679"><a href="#cb314-1679" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_prices_ts, </span>
<span id="cb314-1680"><a href="#cb314-1680" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Henry Hub Prices ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1681"><a href="#cb314-1681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-1682"><a href="#cb314-1682" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1683"><a href="#cb314-1683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1684"><a href="#cb314-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1685"><a href="#cb314-1685" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1686"><a href="#cb314-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1689"><a href="#cb314-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1690"><a href="#cb314-1690" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1691"><a href="#cb314-1691" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1692"><a href="#cb314-1692" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_prices_ts)</span>
<span id="cb314-1693"><a href="#cb314-1693" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1694"><a href="#cb314-1694" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1695"><a href="#cb314-1695" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1696"><a href="#cb314-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1697"><a href="#cb314-1697" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1698"><a href="#cb314-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1699"><a href="#cb314-1699" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1700"><a href="#cb314-1700" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1701"><a href="#cb314-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1702"><a href="#cb314-1702" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1703"><a href="#cb314-1703" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1704"><a href="#cb314-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1705"><a href="#cb314-1705" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1706"><a href="#cb314-1706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1707"><a href="#cb314-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1708"><a href="#cb314-1708" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</span>
<span id="cb314-1709"><a href="#cb314-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1710"><a href="#cb314-1710" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1711"><a href="#cb314-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1712"><a href="#cb314-1712" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-1713"><a href="#cb314-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1716"><a href="#cb314-1716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1717"><a href="#cb314-1717" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1718"><a href="#cb314-1718" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1719"><a href="#cb314-1719" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(consumption_ts) <span class="sc">+</span></span>
<span id="cb314-1720"><a href="#cb314-1720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1721"><a href="#cb314-1721" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1722"><a href="#cb314-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1723"><a href="#cb314-1723" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1724"><a href="#cb314-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1725"><a href="#cb314-1725" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1726"><a href="#cb314-1726" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_consumption_ts, </span>
<span id="cb314-1727"><a href="#cb314-1727" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Consumption ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1728"><a href="#cb314-1728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-1729"><a href="#cb314-1729" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1730"><a href="#cb314-1730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1731"><a href="#cb314-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1732"><a href="#cb314-1732" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1733"><a href="#cb314-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1736"><a href="#cb314-1736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1737"><a href="#cb314-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1738"><a href="#cb314-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1739"><a href="#cb314-1739" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_consumption_ts)</span>
<span id="cb314-1740"><a href="#cb314-1740" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1741"><a href="#cb314-1741" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1742"><a href="#cb314-1742" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1743"><a href="#cb314-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1744"><a href="#cb314-1744" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1745"><a href="#cb314-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1746"><a href="#cb314-1746" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1747"><a href="#cb314-1747" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1748"><a href="#cb314-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1749"><a href="#cb314-1749" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1750"><a href="#cb314-1750" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1751"><a href="#cb314-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1752"><a href="#cb314-1752" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1753"><a href="#cb314-1753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1754"><a href="#cb314-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1755"><a href="#cb314-1755" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</span>
<span id="cb314-1756"><a href="#cb314-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1757"><a href="#cb314-1757" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1758"><a href="#cb314-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1759"><a href="#cb314-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-1760"><a href="#cb314-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1763"><a href="#cb314-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1764"><a href="#cb314-1764" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1765"><a href="#cb314-1765" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1766"><a href="#cb314-1766" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(production_ts) <span class="sc">+</span></span>
<span id="cb314-1767"><a href="#cb314-1767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1768"><a href="#cb314-1768" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1769"><a href="#cb314-1769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1770"><a href="#cb314-1770" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1771"><a href="#cb314-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(production_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1772"><a href="#cb314-1772" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1773"><a href="#cb314-1773" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_production_ts, </span>
<span id="cb314-1774"><a href="#cb314-1774" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Production ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1775"><a href="#cb314-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-1776"><a href="#cb314-1776" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1777"><a href="#cb314-1777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1778"><a href="#cb314-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1779"><a href="#cb314-1779" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1780"><a href="#cb314-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1783"><a href="#cb314-1783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1784"><a href="#cb314-1784" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1785"><a href="#cb314-1785" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1786"><a href="#cb314-1786" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_production_ts)</span>
<span id="cb314-1787"><a href="#cb314-1787" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1788"><a href="#cb314-1788" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1789"><a href="#cb314-1789" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(production_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1790"><a href="#cb314-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1791"><a href="#cb314-1791" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1792"><a href="#cb314-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1793"><a href="#cb314-1793" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1794"><a href="#cb314-1794" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1795"><a href="#cb314-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1796"><a href="#cb314-1796" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1797"><a href="#cb314-1797" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1798"><a href="#cb314-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1799"><a href="#cb314-1799" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1800"><a href="#cb314-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1801"><a href="#cb314-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1802"><a href="#cb314-1802" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</span>
<span id="cb314-1803"><a href="#cb314-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1804"><a href="#cb314-1804" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE, ME and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1805"><a href="#cb314-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1806"><a href="#cb314-1806" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-1807"><a href="#cb314-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1810"><a href="#cb314-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1811"><a href="#cb314-1811" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1812"><a href="#cb314-1812" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1813"><a href="#cb314-1813" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(imports_ts) <span class="sc">+</span></span>
<span id="cb314-1814"><a href="#cb314-1814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1815"><a href="#cb314-1815" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1816"><a href="#cb314-1816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1817"><a href="#cb314-1817" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1818"><a href="#cb314-1818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1819"><a href="#cb314-1819" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1820"><a href="#cb314-1820" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_imports_ts, </span>
<span id="cb314-1821"><a href="#cb314-1821" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Imports ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1822"><a href="#cb314-1822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-1823"><a href="#cb314-1823" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1824"><a href="#cb314-1824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1825"><a href="#cb314-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1826"><a href="#cb314-1826" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1827"><a href="#cb314-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1830"><a href="#cb314-1830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1831"><a href="#cb314-1831" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1832"><a href="#cb314-1832" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1833"><a href="#cb314-1833" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_imports_ts)</span>
<span id="cb314-1834"><a href="#cb314-1834" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1835"><a href="#cb314-1835" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1836"><a href="#cb314-1836" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1837"><a href="#cb314-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1838"><a href="#cb314-1838" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1839"><a href="#cb314-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1840"><a href="#cb314-1840" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1841"><a href="#cb314-1841" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1842"><a href="#cb314-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1843"><a href="#cb314-1843" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1844"><a href="#cb314-1844" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1845"><a href="#cb314-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1846"><a href="#cb314-1846" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1847"><a href="#cb314-1847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1848"><a href="#cb314-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1849"><a href="#cb314-1849" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</span>
<span id="cb314-1850"><a href="#cb314-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1851"><a href="#cb314-1851" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE, ME and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1852"><a href="#cb314-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1853"><a href="#cb314-1853" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-1854"><a href="#cb314-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1857"><a href="#cb314-1857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1858"><a href="#cb314-1858" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1859"><a href="#cb314-1859" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1860"><a href="#cb314-1860" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exports_ts) <span class="sc">+</span></span>
<span id="cb314-1861"><a href="#cb314-1861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1862"><a href="#cb314-1862" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1863"><a href="#cb314-1863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1864"><a href="#cb314-1864" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1865"><a href="#cb314-1865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1866"><a href="#cb314-1866" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1867"><a href="#cb314-1867" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_exports_ts, </span>
<span id="cb314-1868"><a href="#cb314-1868" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Natural Gas Exports ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1869"><a href="#cb314-1869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-1870"><a href="#cb314-1870" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1871"><a href="#cb314-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1872"><a href="#cb314-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1873"><a href="#cb314-1873" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1874"><a href="#cb314-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1877"><a href="#cb314-1877" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1878"><a href="#cb314-1878" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1879"><a href="#cb314-1879" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1880"><a href="#cb314-1880" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_exports_ts)</span>
<span id="cb314-1881"><a href="#cb314-1881" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1882"><a href="#cb314-1882" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1883"><a href="#cb314-1883" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1884"><a href="#cb314-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1885"><a href="#cb314-1885" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1886"><a href="#cb314-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1887"><a href="#cb314-1887" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1888"><a href="#cb314-1888" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1889"><a href="#cb314-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1890"><a href="#cb314-1890" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1891"><a href="#cb314-1891" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1892"><a href="#cb314-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1893"><a href="#cb314-1893" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1894"><a href="#cb314-1894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1895"><a href="#cb314-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1896"><a href="#cb314-1896" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast and Drift benchmark model have similar trajectories for the forecast and follow the trend the best outperforming other benchmark methods.</span>
<span id="cb314-1897"><a href="#cb314-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1898"><a href="#cb314-1898" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE, ME and MAE values followed by Drift method. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1899"><a href="#cb314-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1900"><a href="#cb314-1900" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CVX Stocks</span></span>
<span id="cb314-1901"><a href="#cb314-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1904"><a href="#cb314-1904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1905"><a href="#cb314-1905" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1906"><a href="#cb314-1906" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1907"><a href="#cb314-1907" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(cvx_stk_ts) <span class="sc">+</span></span>
<span id="cb314-1908"><a href="#cb314-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>),</span>
<span id="cb314-1909"><a href="#cb314-1909" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1910"><a href="#cb314-1910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>),</span>
<span id="cb314-1911"><a href="#cb314-1911" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1912"><a href="#cb314-1912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(cvx_stk_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">365</span>),</span>
<span id="cb314-1913"><a href="#cb314-1913" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1914"><a href="#cb314-1914" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_cvx_stk_ts, </span>
<span id="cb314-1915"><a href="#cb314-1915" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Chevron Corp Stocks ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1916"><a href="#cb314-1916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-1917"><a href="#cb314-1917" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1918"><a href="#cb314-1918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1919"><a href="#cb314-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1920"><a href="#cb314-1920" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1921"><a href="#cb314-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1924"><a href="#cb314-1924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1925"><a href="#cb314-1925" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1926"><a href="#cb314-1926" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1927"><a href="#cb314-1927" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_cvx_stk_ts)</span>
<span id="cb314-1928"><a href="#cb314-1928" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>))</span>
<span id="cb314-1929"><a href="#cb314-1929" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(cvx_stk_ts, <span class="at">h=</span><span class="dv">365</span>))</span>
<span id="cb314-1930"><a href="#cb314-1930" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(cvx_stk_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">365</span>))</span>
<span id="cb314-1931"><a href="#cb314-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1932"><a href="#cb314-1932" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1933"><a href="#cb314-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1934"><a href="#cb314-1934" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1935"><a href="#cb314-1935" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1936"><a href="#cb314-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1937"><a href="#cb314-1937" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1938"><a href="#cb314-1938" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1939"><a href="#cb314-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1940"><a href="#cb314-1940" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1941"><a href="#cb314-1941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1942"><a href="#cb314-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1943"><a href="#cb314-1943" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</span>
<span id="cb314-1944"><a href="#cb314-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1945"><a href="#cb314-1945" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1946"><a href="#cb314-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1947"><a href="#cb314-1947" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 emissions</span></span>
<span id="cb314-1948"><a href="#cb314-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1951"><a href="#cb314-1951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1952"><a href="#cb314-1952" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1953"><a href="#cb314-1953" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1954"><a href="#cb314-1954" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(co2_ts) <span class="sc">+</span></span>
<span id="cb314-1955"><a href="#cb314-1955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1956"><a href="#cb314-1956" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-1957"><a href="#cb314-1957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1958"><a href="#cb314-1958" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1959"><a href="#cb314-1959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(co2_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>),</span>
<span id="cb314-1960"><a href="#cb314-1960" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-1961"><a href="#cb314-1961" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(pred_co2_ts, </span>
<span id="cb314-1962"><a href="#cb314-1962" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CO2 Emissions from Natural Gas ARIMA vs. Benchmarks"</span>)<span class="sc">+</span></span>
<span id="cb314-1963"><a href="#cb314-1963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-1964"><a href="#cb314-1964" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb314-1965"><a href="#cb314-1965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1966"><a href="#cb314-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1967"><a href="#cb314-1967" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-1968"><a href="#cb314-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1971"><a href="#cb314-1971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-1972"><a href="#cb314-1972" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-1973"><a href="#cb314-1973" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-1974"><a href="#cb314-1974" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(pred_co2_ts)</span>
<span id="cb314-1975"><a href="#cb314-1975" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1976"><a href="#cb314-1976" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(co2_ts, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1977"><a href="#cb314-1977" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(co2_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">15</span>))</span>
<span id="cb314-1978"><a href="#cb314-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1979"><a href="#cb314-1979" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-1980"><a href="#cb314-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1981"><a href="#cb314-1981" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-1982"><a href="#cb314-1982" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-1983"><a href="#cb314-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1984"><a href="#cb314-1984" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-1985"><a href="#cb314-1985" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARIMA"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-1986"><a href="#cb314-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1987"><a href="#cb314-1987" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-1988"><a href="#cb314-1988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-1989"><a href="#cb314-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1990"><a href="#cb314-1990" aria-hidden="true" tabindex="-1"></a>From the plot it is seen that the ARIMA model forecast outperforms other benchmark methods.</span>
<span id="cb314-1991"><a href="#cb314-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1992"><a href="#cb314-1992" aria-hidden="true" tabindex="-1"></a>From the accuracy metrics, it is seen that the ARIMA model has the least RMSE and MAE values. This indicates that the ARIMA model outperforms the benchmark models and validates the above findings from the plot.</span>
<span id="cb314-1993"><a href="#cb314-1993" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-1994"><a href="#cb314-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1995"><a href="#cb314-1995" aria-hidden="true" tabindex="-1"></a><span class="fu">## SARIMA Modeling</span></span>
<span id="cb314-1996"><a href="#cb314-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1997"><a href="#cb314-1997" aria-hidden="true" tabindex="-1"></a>The analysis reveals clear seasonality in some of my datasets- Prices, Consumption, Production, Imports, Exports,and Industry Employment. Simple first, second, or third order differencing hasn't adequately addressed the seasonal patterns observed in these datasets. Therefore, seasonal differencing is necessary, indicating that a SARIMA model is better suited for these types of data.</span>
<span id="cb314-1998"><a href="#cb314-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-1999"><a href="#cb314-1999" aria-hidden="true" tabindex="-1"></a><span class="fu">### Seasonal Time Series</span></span>
<span id="cb314-2000"><a href="#cb314-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2001"><a href="#cb314-2001" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2002"><a href="#cb314-2002" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-2003"><a href="#cb314-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2006"><a href="#cb314-2006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2007"><a href="#cb314-2007" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2008"><a href="#cb314-2008" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2009"><a href="#cb314-2009" aria-hidden="true" tabindex="-1"></a>prices_diff<span class="ot">&lt;-</span>prices_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb314-2010"><a href="#cb314-2010" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(prices_diff, <span class="at">main=</span><span class="st">"First Difference Seasonal Plot for Natural Gas Residential Prices"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-2011"><a href="#cb314-2011" aria-hidden="true" tabindex="-1"></a>pricesacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(prices_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-2012"><a href="#cb314-2012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2013"><a href="#cb314-2013" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2014"><a href="#cb314-2014" aria-hidden="true" tabindex="-1"></a>pricespacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(prices_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-2015"><a href="#cb314-2015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2016"><a href="#cb314-2016" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2017"><a href="#cb314-2017" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-2018"><a href="#cb314-2018" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (pricesacf <span class="sc">|</span> pricespacf)</span>
<span id="cb314-2019"><a href="#cb314-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2020"><a href="#cb314-2020" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-2021"><a href="#cb314-2021" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-2022"><a href="#cb314-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2023"><a href="#cb314-2023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2024"><a href="#cb314-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2025"><a href="#cb314-2025" aria-hidden="true" tabindex="-1"></a>When we apply seasonal differencing to the original dataset, a correlation still remains, yet it's less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data might result in over-differencing, which we want to avoid. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</span>
<span id="cb314-2026"><a href="#cb314-2026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2027"><a href="#cb314-2027" aria-hidden="true" tabindex="-1"></a>**P:** 1</span>
<span id="cb314-2028"><a href="#cb314-2028" aria-hidden="true" tabindex="-1"></a>**Q:**1,2,3,4</span>
<span id="cb314-2029"><a href="#cb314-2029" aria-hidden="true" tabindex="-1"></a>**D:** 1</span>
<span id="cb314-2030"><a href="#cb314-2030" aria-hidden="true" tabindex="-1"></a>**d:** 0</span>
<span id="cb314-2031"><a href="#cb314-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2032"><a href="#cb314-2032" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-2033"><a href="#cb314-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2036"><a href="#cb314-2036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2037"><a href="#cb314-2037" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2038"><a href="#cb314-2038" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2039"><a href="#cb314-2039" aria-hidden="true" tabindex="-1"></a>consumption_diff<span class="ot">&lt;-</span>consumption_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb314-2040"><a href="#cb314-2040" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(consumption_diff, <span class="at">main=</span><span class="st">"First Difference Seasonal Plot for Natural Gas Consumption"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-2041"><a href="#cb314-2041" aria-hidden="true" tabindex="-1"></a>consumptionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(consumption_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-2042"><a href="#cb314-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2043"><a href="#cb314-2043" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2044"><a href="#cb314-2044" aria-hidden="true" tabindex="-1"></a>consumptionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(consumption_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"First Difference Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-2045"><a href="#cb314-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2046"><a href="#cb314-2046" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2047"><a href="#cb314-2047" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-2048"><a href="#cb314-2048" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (consumptionacf <span class="sc">|</span> consumptionpacf)</span>
<span id="cb314-2049"><a href="#cb314-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2050"><a href="#cb314-2050" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-2051"><a href="#cb314-2051" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-2052"><a href="#cb314-2052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2053"><a href="#cb314-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2054"><a href="#cb314-2054" aria-hidden="true" tabindex="-1"></a>When we apply seasonal differencing to the original dataset, correlation is less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data might result in over-differencing, which we want to avoid. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</span>
<span id="cb314-2055"><a href="#cb314-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2056"><a href="#cb314-2056" aria-hidden="true" tabindex="-1"></a>**P:** 1 </span>
<span id="cb314-2057"><a href="#cb314-2057" aria-hidden="true" tabindex="-1"></a>**Q:** 1,2,3,4 </span>
<span id="cb314-2058"><a href="#cb314-2058" aria-hidden="true" tabindex="-1"></a>**D:**1 </span>
<span id="cb314-2059"><a href="#cb314-2059" aria-hidden="true" tabindex="-1"></a>**d:**0</span>
<span id="cb314-2060"><a href="#cb314-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2061"><a href="#cb314-2061" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-2062"><a href="#cb314-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2065"><a href="#cb314-2065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2066"><a href="#cb314-2066" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2067"><a href="#cb314-2067" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2068"><a href="#cb314-2068" aria-hidden="true" tabindex="-1"></a>production_diff<span class="ot">&lt;-</span>production_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)<span class="sc">%&gt;%</span> diff</span>
<span id="cb314-2069"><a href="#cb314-2069" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(production_diff, <span class="at">main=</span><span class="st">"Seasonal Plot for Natural Gas Production"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-2070"><a href="#cb314-2070" aria-hidden="true" tabindex="-1"></a>productionacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(production_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-2071"><a href="#cb314-2071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2072"><a href="#cb314-2072" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2073"><a href="#cb314-2073" aria-hidden="true" tabindex="-1"></a>productionpacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(production_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-2074"><a href="#cb314-2074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2075"><a href="#cb314-2075" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2076"><a href="#cb314-2076" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-2077"><a href="#cb314-2077" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (productionacf <span class="sc">|</span> productionpacf)</span>
<span id="cb314-2078"><a href="#cb314-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2079"><a href="#cb314-2079" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-2080"><a href="#cb314-2080" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-2081"><a href="#cb314-2081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2082"><a href="#cb314-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2083"><a href="#cb314-2083" aria-hidden="true" tabindex="-1"></a>When we apply seasonal differencing to the original dataset, a correlation still remains, yet it's less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data results in least correlation. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</span>
<span id="cb314-2084"><a href="#cb314-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2085"><a href="#cb314-2085" aria-hidden="true" tabindex="-1"></a>**P:** 1 </span>
<span id="cb314-2086"><a href="#cb314-2086" aria-hidden="true" tabindex="-1"></a>**Q:** 1 </span>
<span id="cb314-2087"><a href="#cb314-2087" aria-hidden="true" tabindex="-1"></a>**D:**1 </span>
<span id="cb314-2088"><a href="#cb314-2088" aria-hidden="true" tabindex="-1"></a>**d:**1</span>
<span id="cb314-2089"><a href="#cb314-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2090"><a href="#cb314-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-2091"><a href="#cb314-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2094"><a href="#cb314-2094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2095"><a href="#cb314-2095" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2096"><a href="#cb314-2096" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2097"><a href="#cb314-2097" aria-hidden="true" tabindex="-1"></a>imports_diff<span class="ot">&lt;-</span>imports_ts <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">12</span>)<span class="sc">%&gt;%</span> diff</span>
<span id="cb314-2098"><a href="#cb314-2098" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(imports_diff, <span class="at">main=</span><span class="st">"Seasonal Plot for Natural Gas Imports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-2099"><a href="#cb314-2099" aria-hidden="true" tabindex="-1"></a>importsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(imports_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-2100"><a href="#cb314-2100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2101"><a href="#cb314-2101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2102"><a href="#cb314-2102" aria-hidden="true" tabindex="-1"></a>importspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(imports_diff)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-2103"><a href="#cb314-2103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2104"><a href="#cb314-2104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2105"><a href="#cb314-2105" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-2106"><a href="#cb314-2106" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (importsacf <span class="sc">|</span> importspacf)</span>
<span id="cb314-2107"><a href="#cb314-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2108"><a href="#cb314-2108" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-2109"><a href="#cb314-2109" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-2110"><a href="#cb314-2110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2111"><a href="#cb314-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2112"><a href="#cb314-2112" aria-hidden="true" tabindex="-1"></a>When we apply seasonal differencing to the original dataset, a correlation still remains, yet it's less pronounced than what was seen with first-order differencing. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 1 and keeping the non-seasonal differencing parameter (d) at 0. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data results in least correlation. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</span>
<span id="cb314-2113"><a href="#cb314-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2114"><a href="#cb314-2114" aria-hidden="true" tabindex="-1"></a>**P:** 1 </span>
<span id="cb314-2115"><a href="#cb314-2115" aria-hidden="true" tabindex="-1"></a>**Q:** 1 </span>
<span id="cb314-2116"><a href="#cb314-2116" aria-hidden="true" tabindex="-1"></a>**D:**1 </span>
<span id="cb314-2117"><a href="#cb314-2117" aria-hidden="true" tabindex="-1"></a>**d:**1</span>
<span id="cb314-2118"><a href="#cb314-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2119"><a href="#cb314-2119" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-2120"><a href="#cb314-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2123"><a href="#cb314-2123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2124"><a href="#cb314-2124" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2125"><a href="#cb314-2125" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2126"><a href="#cb314-2126" aria-hidden="true" tabindex="-1"></a><span class="co"># exports_diff&lt;-exports_ts %&gt;% diff(lag = 12)%&gt;% diff</span></span>
<span id="cb314-2127"><a href="#cb314-2127" aria-hidden="true" tabindex="-1"></a>exports_diff <span class="ot">&lt;-</span> exports_ts <span class="sc">%&gt;%</span></span>
<span id="cb314-2128"><a href="#cb314-2128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="at">lag =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>  <span class="co"># First difference</span></span>
<span id="cb314-2129"><a href="#cb314-2129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()  <span class="co"># Remove NAs that result from differencing</span></span>
<span id="cb314-2130"><a href="#cb314-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2131"><a href="#cb314-2131" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">autoplot</span>(exports_diff, <span class="at">main=</span><span class="st">"Seasonal Plot for Natural Gas Exports"</span>, <span class="at">colour =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-2132"><a href="#cb314-2132" aria-hidden="true" tabindex="-1"></a>exportsacf <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(exports_diff, <span class="at">lag.max =</span> <span class="dv">12</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal ACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb314-2133"><a href="#cb314-2133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2134"><a href="#cb314-2134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2135"><a href="#cb314-2135" aria-hidden="true" tabindex="-1"></a>exportspacf <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(exports_diff, <span class="at">lag.max =</span> <span class="dv">12</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Seasonal PACF Plot "</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb314-2136"><a href="#cb314-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"butt"</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb314-2137"><a href="#cb314-2137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#92c54b"</span>)</span>
<span id="cb314-2138"><a href="#cb314-2138" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb314-2139"><a href="#cb314-2139" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">/</span> (exportsacf <span class="sc">|</span> exportspacf)</span>
<span id="cb314-2140"><a href="#cb314-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2141"><a href="#cb314-2141" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb314-2142"><a href="#cb314-2142" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span>
<span id="cb314-2143"><a href="#cb314-2143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2144"><a href="#cb314-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2145"><a href="#cb314-2145" aria-hidden="true" tabindex="-1"></a>When we apply non-seasonal first differencing to the original dataset, the correlation is less pronounced. This observation leads to the possibility of setting the seasonal differencing parameter (D) to 0 and keeping the non-seasonal differencing parameter (d) at 1. Moving forward with performing both seasonal differencing and first-order differencing on the raw monthly data might result in over-differencing, which we want to avoid. Therefore, the appropriate P, D, Q, and d values for our SARIMA model would be determined as follows.</span>
<span id="cb314-2146"><a href="#cb314-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2147"><a href="#cb314-2147" aria-hidden="true" tabindex="-1"></a>**P:** 1 </span>
<span id="cb314-2148"><a href="#cb314-2148" aria-hidden="true" tabindex="-1"></a>**Q:** 1,2 </span>
<span id="cb314-2149"><a href="#cb314-2149" aria-hidden="true" tabindex="-1"></a>**D:** 0 </span>
<span id="cb314-2150"><a href="#cb314-2150" aria-hidden="true" tabindex="-1"></a>**d:**1</span>
<span id="cb314-2151"><a href="#cb314-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2152"><a href="#cb314-2152" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2153"><a href="#cb314-2153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2154"><a href="#cb314-2154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Selection &amp; Fitting</span></span>
<span id="cb314-2155"><a href="#cb314-2155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2156"><a href="#cb314-2156" aria-hidden="true" tabindex="-1"></a>In this section, we'll use insights from the ACF and PACF plots, alongside the differencing steps we've executed, to fit SARIMA(p,d,q)(P,D,Q) models manually by exploring various combinations of the parameters p, d, q and P, D, Q. And get the best models resulted from manual fitting and from Auto.ARIMA().</span>
<span id="cb314-2157"><a href="#cb314-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2158"><a href="#cb314-2158" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2159"><a href="#cb314-2159" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-2160"><a href="#cb314-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2161"><a href="#cb314-2161" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2162"><a href="#cb314-2162" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Manual Prameter Selection</span></span>
<span id="cb314-2163"><a href="#cb314-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2164"><a href="#cb314-2164" aria-hidden="true" tabindex="-1"></a>**p** :1,2,3,4</span>
<span id="cb314-2165"><a href="#cb314-2165" aria-hidden="true" tabindex="-1"></a>**d**: 0</span>
<span id="cb314-2166"><a href="#cb314-2166" aria-hidden="true" tabindex="-1"></a>**q** : 1, 2</span>
<span id="cb314-2167"><a href="#cb314-2167" aria-hidden="true" tabindex="-1"></a>**P**: 1</span>
<span id="cb314-2168"><a href="#cb314-2168" aria-hidden="true" tabindex="-1"></a>**D**: 1</span>
<span id="cb314-2169"><a href="#cb314-2169" aria-hidden="true" tabindex="-1"></a>**Q**:1,2,3,4</span>
<span id="cb314-2170"><a href="#cb314-2170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2173"><a href="#cb314-2173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2174"><a href="#cb314-2174" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2175"><a href="#cb314-2175" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2176"><a href="#cb314-2176" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb314-2177"><a href="#cb314-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2178"><a href="#cb314-2178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2179"><a href="#cb314-2179" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb314-2180"><a href="#cb314-2180" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb314-2181"><a href="#cb314-2181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2182"><a href="#cb314-2182" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb314-2183"><a href="#cb314-2183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2184"><a href="#cb314-2184" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb314-2185"><a href="#cb314-2185" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb314-2186"><a href="#cb314-2186" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2187"><a href="#cb314-2187" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb314-2188"><a href="#cb314-2188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2189"><a href="#cb314-2189" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2190"><a href="#cb314-2190" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-2191"><a href="#cb314-2191" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb314-2192"><a href="#cb314-2192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2193"><a href="#cb314-2193" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2194"><a href="#cb314-2194" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb314-2195"><a href="#cb314-2195" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-2196"><a href="#cb314-2196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb314-2197"><a href="#cb314-2197" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-2198"><a href="#cb314-2198" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb314-2199"><a href="#cb314-2199" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-2200"><a href="#cb314-2200" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb314-2201"><a href="#cb314-2201" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb314-2202"><a href="#cb314-2202" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb314-2203"><a href="#cb314-2203" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb314-2204"><a href="#cb314-2204" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2205"><a href="#cb314-2205" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-2206"><a href="#cb314-2206" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-2207"><a href="#cb314-2207" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-2208"><a href="#cb314-2208" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb314-2209"><a href="#cb314-2209" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2210"><a href="#cb314-2210" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb314-2211"><a href="#cb314-2211" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb314-2212"><a href="#cb314-2212" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb314-2213"><a href="#cb314-2213" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-2214"><a href="#cb314-2214" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-2215"><a href="#cb314-2215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-2216"><a href="#cb314-2216" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-2217"><a href="#cb314-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2218"><a href="#cb314-2218" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2219"><a href="#cb314-2219" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-2220"><a href="#cb314-2220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-2221"><a href="#cb314-2221" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2222"><a href="#cb314-2222" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb314-2223"><a href="#cb314-2223" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2224"><a href="#cb314-2224" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-2225"><a href="#cb314-2225" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb314-2226"><a href="#cb314-2226" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">4</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">2</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">4</span>,<span class="at">data=</span>prices_ts)</span>
<span id="cb314-2227"><a href="#cb314-2227" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb314-2228"><a href="#cb314-2228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2229"><a href="#cb314-2229" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb314-2230"><a href="#cb314-2230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2231"><a href="#cb314-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2234"><a href="#cb314-2234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2235"><a href="#cb314-2235" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2236"><a href="#cb314-2236" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2237"><a href="#cb314-2237" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span>
<span id="cb314-2238"><a href="#cb314-2238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2239"><a href="#cb314-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2242"><a href="#cb314-2242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2243"><a href="#cb314-2243" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2244"><a href="#cb314-2244" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2245"><a href="#cb314-2245" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span>
<span id="cb314-2246"><a href="#cb314-2246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2247"><a href="#cb314-2247" aria-hidden="true" tabindex="-1"></a>The model with the lowest AIC and BIC is ARIMA(1,0,0)x(0,1,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span>.</span>
<span id="cb314-2248"><a href="#cb314-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2249"><a href="#cb314-2249" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Auto ARIMA</span></span>
<span id="cb314-2250"><a href="#cb314-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2253"><a href="#cb314-2253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2254"><a href="#cb314-2254" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2255"><a href="#cb314-2255" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2256"><a href="#cb314-2256" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(prices_ts)</span>
<span id="cb314-2257"><a href="#cb314-2257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2258"><a href="#cb314-2258" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2259"><a href="#cb314-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2260"><a href="#cb314-2260" aria-hidden="true" tabindex="-1"></a>Best Model 1: ARIMA(1,0,0)x(0,1,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2261"><a href="#cb314-2261" aria-hidden="true" tabindex="-1"></a>Best Model 2 (from Auto ARIMA): ARIMA(1,1,1)(2,0,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2262"><a href="#cb314-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2263"><a href="#cb314-2263" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-2264"><a href="#cb314-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2265"><a href="#cb314-2265" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2266"><a href="#cb314-2266" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Manual Prameter Selection</span></span>
<span id="cb314-2267"><a href="#cb314-2267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2268"><a href="#cb314-2268" aria-hidden="true" tabindex="-1"></a>**p**: 1,2,3</span>
<span id="cb314-2269"><a href="#cb314-2269" aria-hidden="true" tabindex="-1"></a>**d**:0</span>
<span id="cb314-2270"><a href="#cb314-2270" aria-hidden="true" tabindex="-1"></a>**q**: 1</span>
<span id="cb314-2271"><a href="#cb314-2271" aria-hidden="true" tabindex="-1"></a>**P**: 1</span>
<span id="cb314-2272"><a href="#cb314-2272" aria-hidden="true" tabindex="-1"></a>**D**:1</span>
<span id="cb314-2273"><a href="#cb314-2273" aria-hidden="true" tabindex="-1"></a>**Q**: 1,2,3,4</span>
<span id="cb314-2274"><a href="#cb314-2274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2277"><a href="#cb314-2277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2278"><a href="#cb314-2278" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2279"><a href="#cb314-2279" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2280"><a href="#cb314-2280" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb314-2281"><a href="#cb314-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2282"><a href="#cb314-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2283"><a href="#cb314-2283" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb314-2284"><a href="#cb314-2284" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb314-2285"><a href="#cb314-2285" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2286"><a href="#cb314-2286" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb314-2287"><a href="#cb314-2287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2288"><a href="#cb314-2288" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb314-2289"><a href="#cb314-2289" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb314-2290"><a href="#cb314-2290" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2291"><a href="#cb314-2291" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb314-2292"><a href="#cb314-2292" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2293"><a href="#cb314-2293" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2294"><a href="#cb314-2294" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-2295"><a href="#cb314-2295" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb314-2296"><a href="#cb314-2296" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2297"><a href="#cb314-2297" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2298"><a href="#cb314-2298" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb314-2299"><a href="#cb314-2299" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-2300"><a href="#cb314-2300" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb314-2301"><a href="#cb314-2301" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-2302"><a href="#cb314-2302" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb314-2303"><a href="#cb314-2303" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-2304"><a href="#cb314-2304" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb314-2305"><a href="#cb314-2305" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb314-2306"><a href="#cb314-2306" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb314-2307"><a href="#cb314-2307" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb314-2308"><a href="#cb314-2308" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2309"><a href="#cb314-2309" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-2310"><a href="#cb314-2310" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-2311"><a href="#cb314-2311" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-2312"><a href="#cb314-2312" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb314-2313"><a href="#cb314-2313" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2314"><a href="#cb314-2314" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb314-2315"><a href="#cb314-2315" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb314-2316"><a href="#cb314-2316" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb314-2317"><a href="#cb314-2317" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-2318"><a href="#cb314-2318" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-2319"><a href="#cb314-2319" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-2320"><a href="#cb314-2320" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-2321"><a href="#cb314-2321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2322"><a href="#cb314-2322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2323"><a href="#cb314-2323" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-2324"><a href="#cb314-2324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-2325"><a href="#cb314-2325" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2326"><a href="#cb314-2326" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb314-2327"><a href="#cb314-2327" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2328"><a href="#cb314-2328" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-2329"><a href="#cb314-2329" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb314-2330"><a href="#cb314-2330" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">3</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">1</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">4</span>,<span class="at">data=</span>consumption_ts)</span>
<span id="cb314-2331"><a href="#cb314-2331" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb314-2332"><a href="#cb314-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2333"><a href="#cb314-2333" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb314-2334"><a href="#cb314-2334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2335"><a href="#cb314-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2338"><a href="#cb314-2338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2339"><a href="#cb314-2339" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2340"><a href="#cb314-2340" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2341"><a href="#cb314-2341" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span>
<span id="cb314-2342"><a href="#cb314-2342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2343"><a href="#cb314-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2346"><a href="#cb314-2346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2347"><a href="#cb314-2347" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2348"><a href="#cb314-2348" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2349"><a href="#cb314-2349" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span>
<span id="cb314-2350"><a href="#cb314-2350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2351"><a href="#cb314-2351" aria-hidden="true" tabindex="-1"></a>The model with the lowest AIC is ARIMA(2,0,0)x(0,1,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> and the model with the lowest BIC is ARIMA(2,0,0)x(0,1,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2352"><a href="#cb314-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2353"><a href="#cb314-2353" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Auto ARIMA</span></span>
<span id="cb314-2354"><a href="#cb314-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2357"><a href="#cb314-2357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2358"><a href="#cb314-2358" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2359"><a href="#cb314-2359" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2360"><a href="#cb314-2360" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(consumption_ts)</span>
<span id="cb314-2361"><a href="#cb314-2361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2362"><a href="#cb314-2362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2363"><a href="#cb314-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2364"><a href="#cb314-2364" aria-hidden="true" tabindex="-1"></a>Best Model 1: ARIMA(2,0,0)x(0,1,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2365"><a href="#cb314-2365" aria-hidden="true" tabindex="-1"></a>Best Model 2: ARIMA(2,0,0)x(0,1,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2366"><a href="#cb314-2366" aria-hidden="true" tabindex="-1"></a>Best Model 3 (from Auto ARIMA): ARIMA(2,0,3)(2,1,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2367"><a href="#cb314-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2368"><a href="#cb314-2368" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-2369"><a href="#cb314-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2370"><a href="#cb314-2370" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2371"><a href="#cb314-2371" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Manual Prameter Selection</span></span>
<span id="cb314-2372"><a href="#cb314-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2373"><a href="#cb314-2373" aria-hidden="true" tabindex="-1"></a>**p**: 1,2,3,4</span>
<span id="cb314-2374"><a href="#cb314-2374" aria-hidden="true" tabindex="-1"></a>**d**:1</span>
<span id="cb314-2375"><a href="#cb314-2375" aria-hidden="true" tabindex="-1"></a>**q**: 1</span>
<span id="cb314-2376"><a href="#cb314-2376" aria-hidden="true" tabindex="-1"></a>**P**: 1</span>
<span id="cb314-2377"><a href="#cb314-2377" aria-hidden="true" tabindex="-1"></a>**D**:1</span>
<span id="cb314-2378"><a href="#cb314-2378" aria-hidden="true" tabindex="-1"></a>**Q**: 1</span>
<span id="cb314-2379"><a href="#cb314-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2382"><a href="#cb314-2382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2383"><a href="#cb314-2383" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2384"><a href="#cb314-2384" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2385"><a href="#cb314-2385" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb314-2386"><a href="#cb314-2386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2387"><a href="#cb314-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2388"><a href="#cb314-2388" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb314-2389"><a href="#cb314-2389" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb314-2390"><a href="#cb314-2390" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2391"><a href="#cb314-2391" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb314-2392"><a href="#cb314-2392" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2393"><a href="#cb314-2393" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb314-2394"><a href="#cb314-2394" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2395"><a href="#cb314-2395" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2396"><a href="#cb314-2396" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb314-2397"><a href="#cb314-2397" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2398"><a href="#cb314-2398" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2399"><a href="#cb314-2399" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-2400"><a href="#cb314-2400" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb314-2401"><a href="#cb314-2401" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2402"><a href="#cb314-2402" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2403"><a href="#cb314-2403" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb314-2404"><a href="#cb314-2404" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-2405"><a href="#cb314-2405" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb314-2406"><a href="#cb314-2406" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-2407"><a href="#cb314-2407" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb314-2408"><a href="#cb314-2408" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-2409"><a href="#cb314-2409" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb314-2410"><a href="#cb314-2410" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb314-2411"><a href="#cb314-2411" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb314-2412"><a href="#cb314-2412" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb314-2413"><a href="#cb314-2413" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2414"><a href="#cb314-2414" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-2415"><a href="#cb314-2415" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-2416"><a href="#cb314-2416" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-2417"><a href="#cb314-2417" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb314-2418"><a href="#cb314-2418" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2419"><a href="#cb314-2419" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb314-2420"><a href="#cb314-2420" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb314-2421"><a href="#cb314-2421" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb314-2422"><a href="#cb314-2422" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-2423"><a href="#cb314-2423" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-2424"><a href="#cb314-2424" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-2425"><a href="#cb314-2425" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-2426"><a href="#cb314-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2427"><a href="#cb314-2427" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2428"><a href="#cb314-2428" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-2429"><a href="#cb314-2429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-2430"><a href="#cb314-2430" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2431"><a href="#cb314-2431" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb314-2432"><a href="#cb314-2432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2433"><a href="#cb314-2433" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-2434"><a href="#cb314-2434" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb314-2435"><a href="#cb314-2435" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">4</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">1</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">1</span>,<span class="at">data=</span>production_ts)</span>
<span id="cb314-2436"><a href="#cb314-2436" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb314-2437"><a href="#cb314-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2438"><a href="#cb314-2438" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb314-2439"><a href="#cb314-2439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2440"><a href="#cb314-2440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2443"><a href="#cb314-2443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2444"><a href="#cb314-2444" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2445"><a href="#cb314-2445" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2446"><a href="#cb314-2446" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span>
<span id="cb314-2447"><a href="#cb314-2447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2448"><a href="#cb314-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2451"><a href="#cb314-2451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2452"><a href="#cb314-2452" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2453"><a href="#cb314-2453" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2454"><a href="#cb314-2454" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span>
<span id="cb314-2455"><a href="#cb314-2455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2456"><a href="#cb314-2456" aria-hidden="true" tabindex="-1"></a>The model with the lowest AIC is ARIMA(3,1,0)x(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> and the model with the lowest BIC is ARIMA(1,1,0)x(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2457"><a href="#cb314-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2458"><a href="#cb314-2458" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Auto ARIMA</span></span>
<span id="cb314-2459"><a href="#cb314-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2462"><a href="#cb314-2462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2463"><a href="#cb314-2463" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2464"><a href="#cb314-2464" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2465"><a href="#cb314-2465" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(production_ts)</span>
<span id="cb314-2466"><a href="#cb314-2466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2467"><a href="#cb314-2467" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2468"><a href="#cb314-2468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2469"><a href="#cb314-2469" aria-hidden="true" tabindex="-1"></a>Best Model 1: ARIMA(3,1,0)x(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2470"><a href="#cb314-2470" aria-hidden="true" tabindex="-1"></a>Best Model 2: ARIMA(1,1,0)x(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span>  </span>
<span id="cb314-2471"><a href="#cb314-2471" aria-hidden="true" tabindex="-1"></a>Best Model 3 (from Auto ARIMA): ARIMA(0,1,1)(1,1,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2472"><a href="#cb314-2472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2473"><a href="#cb314-2473" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-2474"><a href="#cb314-2474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2475"><a href="#cb314-2475" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2476"><a href="#cb314-2476" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Manual Prameter Selection</span></span>
<span id="cb314-2477"><a href="#cb314-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2478"><a href="#cb314-2478" aria-hidden="true" tabindex="-1"></a>**p**: 1,2</span>
<span id="cb314-2479"><a href="#cb314-2479" aria-hidden="true" tabindex="-1"></a>**d**:1</span>
<span id="cb314-2480"><a href="#cb314-2480" aria-hidden="true" tabindex="-1"></a>**q**: 1</span>
<span id="cb314-2481"><a href="#cb314-2481" aria-hidden="true" tabindex="-1"></a>**P**: 1</span>
<span id="cb314-2482"><a href="#cb314-2482" aria-hidden="true" tabindex="-1"></a>**D**:1</span>
<span id="cb314-2483"><a href="#cb314-2483" aria-hidden="true" tabindex="-1"></a>**Q**: 1</span>
<span id="cb314-2484"><a href="#cb314-2484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2487"><a href="#cb314-2487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2488"><a href="#cb314-2488" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2489"><a href="#cb314-2489" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2490"><a href="#cb314-2490" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb314-2491"><a href="#cb314-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2492"><a href="#cb314-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2493"><a href="#cb314-2493" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb314-2494"><a href="#cb314-2494" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb314-2495"><a href="#cb314-2495" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2496"><a href="#cb314-2496" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb314-2497"><a href="#cb314-2497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2498"><a href="#cb314-2498" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb314-2499"><a href="#cb314-2499" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2500"><a href="#cb314-2500" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2501"><a href="#cb314-2501" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb314-2502"><a href="#cb314-2502" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2503"><a href="#cb314-2503" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2504"><a href="#cb314-2504" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-2505"><a href="#cb314-2505" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb314-2506"><a href="#cb314-2506" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2507"><a href="#cb314-2507" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2508"><a href="#cb314-2508" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb314-2509"><a href="#cb314-2509" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-2510"><a href="#cb314-2510" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb314-2511"><a href="#cb314-2511" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-2512"><a href="#cb314-2512" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb314-2513"><a href="#cb314-2513" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-2514"><a href="#cb314-2514" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb314-2515"><a href="#cb314-2515" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb314-2516"><a href="#cb314-2516" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb314-2517"><a href="#cb314-2517" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb314-2518"><a href="#cb314-2518" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2519"><a href="#cb314-2519" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-2520"><a href="#cb314-2520" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-2521"><a href="#cb314-2521" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-2522"><a href="#cb314-2522" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb314-2523"><a href="#cb314-2523" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2524"><a href="#cb314-2524" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb314-2525"><a href="#cb314-2525" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb314-2526"><a href="#cb314-2526" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb314-2527"><a href="#cb314-2527" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-2528"><a href="#cb314-2528" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-2529"><a href="#cb314-2529" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-2530"><a href="#cb314-2530" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-2531"><a href="#cb314-2531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2532"><a href="#cb314-2532" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2533"><a href="#cb314-2533" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-2534"><a href="#cb314-2534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-2535"><a href="#cb314-2535" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2536"><a href="#cb314-2536" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb314-2537"><a href="#cb314-2537" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2538"><a href="#cb314-2538" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-2539"><a href="#cb314-2539" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb314-2540"><a href="#cb314-2540" aria-hidden="true" tabindex="-1"></a>  output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">2</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">1</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">1</span>,<span class="at">data=</span>imports_ts)</span>
<span id="cb314-2541"><a href="#cb314-2541" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb314-2542"><a href="#cb314-2542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2543"><a href="#cb314-2543" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb314-2544"><a href="#cb314-2544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2545"><a href="#cb314-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2548"><a href="#cb314-2548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2549"><a href="#cb314-2549" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2550"><a href="#cb314-2550" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2551"><a href="#cb314-2551" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span>
<span id="cb314-2552"><a href="#cb314-2552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2553"><a href="#cb314-2553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2556"><a href="#cb314-2556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2557"><a href="#cb314-2557" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2558"><a href="#cb314-2558" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2559"><a href="#cb314-2559" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span>
<span id="cb314-2560"><a href="#cb314-2560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2561"><a href="#cb314-2561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2562"><a href="#cb314-2562" aria-hidden="true" tabindex="-1"></a>The model with the lowest AIC and BIC is ARIMA(1,1,0)x(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2563"><a href="#cb314-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2564"><a href="#cb314-2564" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Auto ARIMA</span></span>
<span id="cb314-2565"><a href="#cb314-2565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2568"><a href="#cb314-2568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2569"><a href="#cb314-2569" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2570"><a href="#cb314-2570" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2571"><a href="#cb314-2571" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(imports_ts)</span>
<span id="cb314-2572"><a href="#cb314-2572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2573"><a href="#cb314-2573" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2574"><a href="#cb314-2574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2575"><a href="#cb314-2575" aria-hidden="true" tabindex="-1"></a>Best Model 1: ARIMA(1,1,0)x(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2576"><a href="#cb314-2576" aria-hidden="true" tabindex="-1"></a>Best Model 2 (from Auto ARIMA): ARIMA(0,1,3)(1,1,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2577"><a href="#cb314-2577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2578"><a href="#cb314-2578" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-2579"><a href="#cb314-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2580"><a href="#cb314-2580" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2581"><a href="#cb314-2581" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Manual Prameter Selection</span></span>
<span id="cb314-2582"><a href="#cb314-2582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2583"><a href="#cb314-2583" aria-hidden="true" tabindex="-1"></a>**p**: 1</span>
<span id="cb314-2584"><a href="#cb314-2584" aria-hidden="true" tabindex="-1"></a>**d**: 1</span>
<span id="cb314-2585"><a href="#cb314-2585" aria-hidden="true" tabindex="-1"></a>**q**: 1,2</span>
<span id="cb314-2586"><a href="#cb314-2586" aria-hidden="true" tabindex="-1"></a>**P**: 1</span>
<span id="cb314-2587"><a href="#cb314-2587" aria-hidden="true" tabindex="-1"></a>**D**: 0</span>
<span id="cb314-2588"><a href="#cb314-2588" aria-hidden="true" tabindex="-1"></a>**Q**: 1,2</span>
<span id="cb314-2589"><a href="#cb314-2589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2592"><a href="#cb314-2592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2593"><a href="#cb314-2593" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2594"><a href="#cb314-2594" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2595"><a href="#cb314-2595" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb314-2596"><a href="#cb314-2596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2597"><a href="#cb314-2597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2598"><a href="#cb314-2598" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb314-2599"><a href="#cb314-2599" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb314-2600"><a href="#cb314-2600" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2601"><a href="#cb314-2601" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb314-2602"><a href="#cb314-2602" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2603"><a href="#cb314-2603" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb314-2604"><a href="#cb314-2604" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2605"><a href="#cb314-2605" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb314-2606"><a href="#cb314-2606" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb314-2607"><a href="#cb314-2607" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2608"><a href="#cb314-2608" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb314-2609"><a href="#cb314-2609" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb314-2610"><a href="#cb314-2610" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb314-2611"><a href="#cb314-2611" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2612"><a href="#cb314-2612" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2613"><a href="#cb314-2613" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb314-2614"><a href="#cb314-2614" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb314-2615"><a href="#cb314-2615" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb314-2616"><a href="#cb314-2616" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb314-2617"><a href="#cb314-2617" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb314-2618"><a href="#cb314-2618" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb314-2619"><a href="#cb314-2619" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb314-2620"><a href="#cb314-2620" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb314-2621"><a href="#cb314-2621" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb314-2622"><a href="#cb314-2622" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb314-2623"><a href="#cb314-2623" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2624"><a href="#cb314-2624" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-2625"><a href="#cb314-2625" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb314-2626"><a href="#cb314-2626" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb314-2627"><a href="#cb314-2627" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb314-2628"><a href="#cb314-2628" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb314-2629"><a href="#cb314-2629" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb314-2630"><a href="#cb314-2630" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb314-2631"><a href="#cb314-2631" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb314-2632"><a href="#cb314-2632" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb314-2633"><a href="#cb314-2633" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb314-2634"><a href="#cb314-2634" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-2635"><a href="#cb314-2635" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb314-2636"><a href="#cb314-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2637"><a href="#cb314-2637" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2638"><a href="#cb314-2638" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb314-2639"><a href="#cb314-2639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb314-2640"><a href="#cb314-2640" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2641"><a href="#cb314-2641" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb314-2642"><a href="#cb314-2642" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2643"><a href="#cb314-2643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-2644"><a href="#cb314-2644" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,; Q=0,1 and PACF plot: p=0,1; P=0,1, D=0 and d=O</span></span>
<span id="cb314-2645"><a href="#cb314-2645" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">1</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">2</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">2</span>,<span class="at">data=</span>exports_ts)</span>
<span id="cb314-2646"><a href="#cb314-2646" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb314-2647"><a href="#cb314-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2648"><a href="#cb314-2648" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb314-2649"><a href="#cb314-2649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2650"><a href="#cb314-2650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2653"><a href="#cb314-2653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2654"><a href="#cb314-2654" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2655"><a href="#cb314-2655" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2656"><a href="#cb314-2656" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span>
<span id="cb314-2657"><a href="#cb314-2657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2658"><a href="#cb314-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2661"><a href="#cb314-2661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2662"><a href="#cb314-2662" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2663"><a href="#cb314-2663" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2664"><a href="#cb314-2664" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),] </span>
<span id="cb314-2665"><a href="#cb314-2665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2666"><a href="#cb314-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2667"><a href="#cb314-2667" aria-hidden="true" tabindex="-1"></a>The model with the lowest AIC and BIC is ARIMA(0,1,1)x(0,0,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span>. </span>
<span id="cb314-2668"><a href="#cb314-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2669"><a href="#cb314-2669" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Auto ARIMA</span></span>
<span id="cb314-2670"><a href="#cb314-2670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2673"><a href="#cb314-2673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2674"><a href="#cb314-2674" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2675"><a href="#cb314-2675" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2676"><a href="#cb314-2676" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(exports_ts)</span>
<span id="cb314-2677"><a href="#cb314-2677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2678"><a href="#cb314-2678" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2679"><a href="#cb314-2679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2680"><a href="#cb314-2680" aria-hidden="true" tabindex="-1"></a>Best Model 1: ARIMA(0,1,1)x(0,0,1)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb314-2681"><a href="#cb314-2681" aria-hidden="true" tabindex="-1"></a>Best Model 2 (from Auto ARIMA): ARIMA(0,1,1)(1,0,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span> </span>
<span id="cb314-2682"><a href="#cb314-2682" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2683"><a href="#cb314-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2684"><a href="#cb314-2684" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Diagnostics</span></span>
<span id="cb314-2685"><a href="#cb314-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2686"><a href="#cb314-2686" aria-hidden="true" tabindex="-1"></a>In this part, we're going to fit all the best model obtained from our earlier analysis, and then dive into some model diagnostics to see how each one of them is performing.</span>
<span id="cb314-2687"><a href="#cb314-2687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2688"><a href="#cb314-2688" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2689"><a href="#cb314-2689" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-2690"><a href="#cb314-2690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2691"><a href="#cb314-2691" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2692"><a href="#cb314-2692" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb314-2693"><a href="#cb314-2693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2696"><a href="#cb314-2696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2697"><a href="#cb314-2697" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2698"><a href="#cb314-2698" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2699"><a href="#cb314-2699" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(prices_ts, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span>
<span id="cb314-2700"><a href="#cb314-2700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2701"><a href="#cb314-2701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2704"><a href="#cb314-2704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2705"><a href="#cb314-2705" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2706"><a href="#cb314-2706" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2707"><a href="#cb314-2707" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">39</span><span class="sc">:</span><span class="dv">49</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2708"><a href="#cb314-2708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2709"><a href="#cb314-2709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2710"><a href="#cb314-2710" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb314-2711"><a href="#cb314-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2714"><a href="#cb314-2714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2715"><a href="#cb314-2715" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2716"><a href="#cb314-2716" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2717"><a href="#cb314-2717" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(prices_ts, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb314-2718"><a href="#cb314-2718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2719"><a href="#cb314-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2722"><a href="#cb314-2722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2723"><a href="#cb314-2723" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2724"><a href="#cb314-2724" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2725"><a href="#cb314-2725" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">63</span><span class="sc">:</span><span class="dv">73</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2726"><a href="#cb314-2726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2727"><a href="#cb314-2727" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2728"><a href="#cb314-2728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2729"><a href="#cb314-2729" aria-hidden="true" tabindex="-1"></a>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for both the models. The Q-Q plot suggest that the residuals are normally distributed for both the models.From the Ljung-Box Test, the p-values for model1 are typically below 0.05 suggesting that the residuals are not random, which is not desirable in a good model fit while for model2 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, and BIC, model 2 has lower values indicating a better fit.</span>
<span id="cb314-2730"><a href="#cb314-2730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2731"><a href="#cb314-2731" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-2732"><a href="#cb314-2732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2733"><a href="#cb314-2733" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2734"><a href="#cb314-2734" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb314-2735"><a href="#cb314-2735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2738"><a href="#cb314-2738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2739"><a href="#cb314-2739" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2740"><a href="#cb314-2740" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2741"><a href="#cb314-2741" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>))</span>
<span id="cb314-2742"><a href="#cb314-2742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2743"><a href="#cb314-2743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2746"><a href="#cb314-2746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2747"><a href="#cb314-2747" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2748"><a href="#cb314-2748" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2749"><a href="#cb314-2749" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">30</span><span class="sc">:</span><span class="dv">44</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2750"><a href="#cb314-2750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2751"><a href="#cb314-2751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2752"><a href="#cb314-2752" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb314-2753"><a href="#cb314-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2756"><a href="#cb314-2756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2757"><a href="#cb314-2757" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2758"><a href="#cb314-2758" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2759"><a href="#cb314-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2760"><a href="#cb314-2760" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span>
<span id="cb314-2761"><a href="#cb314-2761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2762"><a href="#cb314-2762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2765"><a href="#cb314-2765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2766"><a href="#cb314-2766" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2767"><a href="#cb314-2767" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2768"><a href="#cb314-2768" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">23</span><span class="sc">:</span><span class="dv">36</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2769"><a href="#cb314-2769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2770"><a href="#cb314-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2771"><a href="#cb314-2771" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 3</span></span>
<span id="cb314-2772"><a href="#cb314-2772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2775"><a href="#cb314-2775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2776"><a href="#cb314-2776" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2777"><a href="#cb314-2777" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2778"><a href="#cb314-2778" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(consumption_ts, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>))</span>
<span id="cb314-2779"><a href="#cb314-2779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2780"><a href="#cb314-2780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2783"><a href="#cb314-2783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2784"><a href="#cb314-2784" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2785"><a href="#cb314-2785" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2786"><a href="#cb314-2786" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">79</span><span class="sc">:</span><span class="dv">98</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2787"><a href="#cb314-2787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2788"><a href="#cb314-2788" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2789"><a href="#cb314-2789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2790"><a href="#cb314-2790" aria-hidden="true" tabindex="-1"></a>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for all the models are typically below 0.05 suggesting that the residuals are not random, which may not be desirable in a good model fit. On comparing AIC, AICc, and BIC, model 3 has lower values indicating a better fit.</span>
<span id="cb314-2791"><a href="#cb314-2791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2792"><a href="#cb314-2792" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-2793"><a href="#cb314-2793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2794"><a href="#cb314-2794" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2795"><a href="#cb314-2795" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb314-2796"><a href="#cb314-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2799"><a href="#cb314-2799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2800"><a href="#cb314-2800" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2801"><a href="#cb314-2801" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2802"><a href="#cb314-2802" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts, <span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb314-2803"><a href="#cb314-2803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2804"><a href="#cb314-2804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2805"><a href="#cb314-2805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2808"><a href="#cb314-2808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2809"><a href="#cb314-2809" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2810"><a href="#cb314-2810" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2811"><a href="#cb314-2811" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">14</span><span class="sc">:</span><span class="dv">25</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2812"><a href="#cb314-2812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2813"><a href="#cb314-2813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2814"><a href="#cb314-2814" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb314-2815"><a href="#cb314-2815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2818"><a href="#cb314-2818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2819"><a href="#cb314-2819" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2820"><a href="#cb314-2820" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2821"><a href="#cb314-2821" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb314-2822"><a href="#cb314-2822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2823"><a href="#cb314-2823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2826"><a href="#cb314-2826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2827"><a href="#cb314-2827" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2828"><a href="#cb314-2828" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2829"><a href="#cb314-2829" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">13</span><span class="sc">:</span><span class="dv">23</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2830"><a href="#cb314-2830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2831"><a href="#cb314-2831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2832"><a href="#cb314-2832" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 3</span></span>
<span id="cb314-2833"><a href="#cb314-2833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2836"><a href="#cb314-2836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2837"><a href="#cb314-2837" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2838"><a href="#cb314-2838" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2839"><a href="#cb314-2839" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(production_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span>
<span id="cb314-2840"><a href="#cb314-2840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2841"><a href="#cb314-2841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2844"><a href="#cb314-2844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2845"><a href="#cb314-2845" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2846"><a href="#cb314-2846" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2847"><a href="#cb314-2847" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">21</span><span class="sc">:</span><span class="dv">33</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2848"><a href="#cb314-2848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2849"><a href="#cb314-2849" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2850"><a href="#cb314-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2851"><a href="#cb314-2851" aria-hidden="true" tabindex="-1"></a>On comparing, the ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for model 3. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for the model 3 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, and BIC, model 3 has lower values indicating a better fit.</span>
<span id="cb314-2852"><a href="#cb314-2852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2853"><a href="#cb314-2853" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-2854"><a href="#cb314-2854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2855"><a href="#cb314-2855" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2856"><a href="#cb314-2856" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb314-2857"><a href="#cb314-2857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2860"><a href="#cb314-2860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2861"><a href="#cb314-2861" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2862"><a href="#cb314-2862" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2863"><a href="#cb314-2863" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(imports_ts, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb314-2864"><a href="#cb314-2864" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2865"><a href="#cb314-2865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2868"><a href="#cb314-2868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2869"><a href="#cb314-2869" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2870"><a href="#cb314-2870" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2871"><a href="#cb314-2871" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">13</span><span class="sc">:</span><span class="dv">23</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2872"><a href="#cb314-2872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2873"><a href="#cb314-2873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2874"><a href="#cb314-2874" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb314-2875"><a href="#cb314-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2878"><a href="#cb314-2878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2879"><a href="#cb314-2879" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2880"><a href="#cb314-2880" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2881"><a href="#cb314-2881" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(imports_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span>
<span id="cb314-2882"><a href="#cb314-2882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2883"><a href="#cb314-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2886"><a href="#cb314-2886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2887"><a href="#cb314-2887" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2888"><a href="#cb314-2888" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2889"><a href="#cb314-2889" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">24</span><span class="sc">:</span><span class="dv">37</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2890"><a href="#cb314-2890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2891"><a href="#cb314-2891" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2892"><a href="#cb314-2892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2893"><a href="#cb314-2893" aria-hidden="true" tabindex="-1"></a>On comparing, the ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for model 2. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for the model 2 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, and BIC, model 2 has lower values indicating a better fit.</span>
<span id="cb314-2894"><a href="#cb314-2894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2895"><a href="#cb314-2895" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-2896"><a href="#cb314-2896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2897"><a href="#cb314-2897" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2898"><a href="#cb314-2898" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb314-2899"><a href="#cb314-2899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2902"><a href="#cb314-2902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2903"><a href="#cb314-2903" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2904"><a href="#cb314-2904" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2905"><a href="#cb314-2905" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(exports_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span>
<span id="cb314-2906"><a href="#cb314-2906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2907"><a href="#cb314-2907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2910"><a href="#cb314-2910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2911"><a href="#cb314-2911" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2912"><a href="#cb314-2912" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2913"><a href="#cb314-2913" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">21</span><span class="sc">:</span><span class="dv">29</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2914"><a href="#cb314-2914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2915"><a href="#cb314-2915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2916"><a href="#cb314-2916" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb314-2917"><a href="#cb314-2917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2920"><a href="#cb314-2920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2921"><a href="#cb314-2921" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2922"><a href="#cb314-2922" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2923"><a href="#cb314-2923" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(exports_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb314-2924"><a href="#cb314-2924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2925"><a href="#cb314-2925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2926"><a href="#cb314-2926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2929"><a href="#cb314-2929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2930"><a href="#cb314-2930" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2931"><a href="#cb314-2931" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2932"><a href="#cb314-2932" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">25</span><span class="sc">:</span><span class="dv">33</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb314-2933"><a href="#cb314-2933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2934"><a href="#cb314-2934" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2935"><a href="#cb314-2935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2936"><a href="#cb314-2936" aria-hidden="true" tabindex="-1"></a>On comparing, the ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for both the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for both the models are typically below 0.05 suggesting that the residuals are not random, which may not be desirable in a good model fit. On comparing AIC, AICc, and BIC, model 2 has lower values indicating a better fit.</span>
<span id="cb314-2937"><a href="#cb314-2937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2938"><a href="#cb314-2938" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-2939"><a href="#cb314-2939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2940"><a href="#cb314-2940" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cross-Validation</span></span>
<span id="cb314-2941"><a href="#cb314-2941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2942"><a href="#cb314-2942" aria-hidden="true" tabindex="-1"></a>In this part, we'll pinpoint the model that fits our data best by employing cross-validation and identifying the one with the lowest mean absolute error (MAE) and root mean square error (RMSE).</span>
<span id="cb314-2943"><a href="#cb314-2943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2944"><a href="#cb314-2944" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-2945"><a href="#cb314-2945" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-2946"><a href="#cb314-2946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2949"><a href="#cb314-2949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-2950"><a href="#cb314-2950" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-2951"><a href="#cb314-2951" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-2952"><a href="#cb314-2952" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>prices_ts</span>
<span id="cb314-2953"><a href="#cb314-2953" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2954"><a href="#cb314-2954" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb314-2955"><a href="#cb314-2955" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb314-2956"><a href="#cb314-2956" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb314-2957"><a href="#cb314-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2958"><a href="#cb314-2958" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb314-2959"><a href="#cb314-2959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2960"><a href="#cb314-2960" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb314-2961"><a href="#cb314-2961" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-2962"><a href="#cb314-2962" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-2963"><a href="#cb314-2963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2964"><a href="#cb314-2964" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-2965"><a href="#cb314-2965" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-2966"><a href="#cb314-2966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2967"><a href="#cb314-2967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2968"><a href="#cb314-2968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2969"><a href="#cb314-2969" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb314-2970"><a href="#cb314-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2971"><a href="#cb314-2971" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb314-2972"><a href="#cb314-2972" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-2973"><a href="#cb314-2973" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb314-2974"><a href="#cb314-2974" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb314-2975"><a href="#cb314-2975" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb314-2976"><a href="#cb314-2976" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2977"><a href="#cb314-2977" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-2978"><a href="#cb314-2978" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-2979"><a href="#cb314-2979" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-2980"><a href="#cb314-2980" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2981"><a href="#cb314-2981" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-2982"><a href="#cb314-2982" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-2983"><a href="#cb314-2983" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-2984"><a href="#cb314-2984" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2985"><a href="#cb314-2985" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-2986"><a href="#cb314-2986" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-2987"><a href="#cb314-2987" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2988"><a href="#cb314-2988" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb314-2989"><a href="#cb314-2989" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-2990"><a href="#cb314-2990" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-2991"><a href="#cb314-2991" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2992"><a href="#cb314-2992" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-2993"><a href="#cb314-2993" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-2994"><a href="#cb314-2994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-2995"><a href="#cb314-2995" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb314-2996"><a href="#cb314-2996" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-2997"><a href="#cb314-2997" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,0,0)x(0,1,1)12"</span>,<span class="st">"Fit2:SARIMA(1,1,1)(2,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-2998"><a href="#cb314-2998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-2999"><a href="#cb314-2999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3002"><a href="#cb314-3002" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3003"><a href="#cb314-3003" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3004"><a href="#cb314-3004" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3005"><a href="#cb314-3005" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb314-3006"><a href="#cb314-3006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3007"><a href="#cb314-3007" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3008"><a href="#cb314-3008" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3009"><a href="#cb314-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3010"><a href="#cb314-3010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3011"><a href="#cb314-3011" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb314-3012"><a href="#cb314-3012" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3013"><a href="#cb314-3013" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,0,0)x(0,1,1)12"</span>,<span class="st">"Fit2:SARIMA(1,1,1)(2,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3014"><a href="#cb314-3014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3015"><a href="#cb314-3015" aria-hidden="true" tabindex="-1"></a>Overall, Fit 2 pulls ahead with slightly lower errors. So, it looks like Fit 2 is better.</span>
<span id="cb314-3016"><a href="#cb314-3016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3017"><a href="#cb314-3017" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-3018"><a href="#cb314-3018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3021"><a href="#cb314-3021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3022"><a href="#cb314-3022" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3023"><a href="#cb314-3023" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3024"><a href="#cb314-3024" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>consumption_ts</span>
<span id="cb314-3025"><a href="#cb314-3025" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3026"><a href="#cb314-3026" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb314-3027"><a href="#cb314-3027" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb314-3028"><a href="#cb314-3028" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb314-3029"><a href="#cb314-3029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3030"><a href="#cb314-3030" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb314-3031"><a href="#cb314-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3032"><a href="#cb314-3032" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb314-3033"><a href="#cb314-3033" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3034"><a href="#cb314-3034" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3035"><a href="#cb314-3035" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3036"><a href="#cb314-3036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3037"><a href="#cb314-3037" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3038"><a href="#cb314-3038" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3039"><a href="#cb314-3039" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3040"><a href="#cb314-3040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3041"><a href="#cb314-3041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3042"><a href="#cb314-3042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3043"><a href="#cb314-3043" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb314-3044"><a href="#cb314-3044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3045"><a href="#cb314-3045" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb314-3046"><a href="#cb314-3046" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-3047"><a href="#cb314-3047" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb314-3048"><a href="#cb314-3048" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb314-3049"><a href="#cb314-3049" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb314-3050"><a href="#cb314-3050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3051"><a href="#cb314-3051" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3052"><a href="#cb314-3052" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-3053"><a href="#cb314-3053" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3054"><a href="#cb314-3054" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3055"><a href="#cb314-3055" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3056"><a href="#cb314-3056" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-3057"><a href="#cb314-3057" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3058"><a href="#cb314-3058" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3059"><a href="#cb314-3059" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3060"><a href="#cb314-3060" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-3061"><a href="#cb314-3061" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3062"><a href="#cb314-3062" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3063"><a href="#cb314-3063" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3064"><a href="#cb314-3064" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3065"><a href="#cb314-3065" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3066"><a href="#cb314-3066" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3067"><a href="#cb314-3067" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb314-3068"><a href="#cb314-3068" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3069"><a href="#cb314-3069" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3070"><a href="#cb314-3070" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3071"><a href="#cb314-3071" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3072"><a href="#cb314-3072" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3073"><a href="#cb314-3073" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-3074"><a href="#cb314-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3075"><a href="#cb314-3075" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb314-3076"><a href="#cb314-3076" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3077"><a href="#cb314-3077" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb314-3078"><a href="#cb314-3078" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(2,0,0)x(0,1,2)12"</span>,<span class="st">"Fit2:SARIMA(2,0,0)x(0,1,1)12"</span>,<span class="st">"Fit3:SARIMA(2,0,3)x(2,1,2)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3079"><a href="#cb314-3079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3080"><a href="#cb314-3080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3083"><a href="#cb314-3083" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3084"><a href="#cb314-3084" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3085"><a href="#cb314-3085" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3086"><a href="#cb314-3086" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb314-3087"><a href="#cb314-3087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3088"><a href="#cb314-3088" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3089"><a href="#cb314-3089" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3090"><a href="#cb314-3090" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3091"><a href="#cb314-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3092"><a href="#cb314-3092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3093"><a href="#cb314-3093" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb314-3094"><a href="#cb314-3094" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3095"><a href="#cb314-3095" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb314-3096"><a href="#cb314-3096" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(2,0,0)x(0,1,2)12"</span>,<span class="st">"Fit2:SARIMA(2,0,0)x(0,1,1)12"</span>,<span class="st">"Fit3:SARIMA(2,0,3)x(2,1,2)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3097"><a href="#cb314-3097" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3098"><a href="#cb314-3098" aria-hidden="true" tabindex="-1"></a>Overall, Fit 3 pulls ahead with slightly lower errors. So, it looks like Fit 3 is better.</span>
<span id="cb314-3099"><a href="#cb314-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3100"><a href="#cb314-3100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-3101"><a href="#cb314-3101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3104"><a href="#cb314-3104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3105"><a href="#cb314-3105" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3106"><a href="#cb314-3106" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3107"><a href="#cb314-3107" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>production_ts</span>
<span id="cb314-3108"><a href="#cb314-3108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3109"><a href="#cb314-3109" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb314-3110"><a href="#cb314-3110" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb314-3111"><a href="#cb314-3111" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb314-3112"><a href="#cb314-3112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3113"><a href="#cb314-3113" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb314-3114"><a href="#cb314-3114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3115"><a href="#cb314-3115" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb314-3116"><a href="#cb314-3116" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3117"><a href="#cb314-3117" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3118"><a href="#cb314-3118" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3119"><a href="#cb314-3119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3120"><a href="#cb314-3120" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3121"><a href="#cb314-3121" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3122"><a href="#cb314-3122" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3123"><a href="#cb314-3123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3124"><a href="#cb314-3124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3125"><a href="#cb314-3125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3126"><a href="#cb314-3126" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb314-3127"><a href="#cb314-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3128"><a href="#cb314-3128" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb314-3129"><a href="#cb314-3129" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-3130"><a href="#cb314-3130" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb314-3131"><a href="#cb314-3131" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb314-3132"><a href="#cb314-3132" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb314-3133"><a href="#cb314-3133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3134"><a href="#cb314-3134" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3135"><a href="#cb314-3135" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-3136"><a href="#cb314-3136" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3137"><a href="#cb314-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3138"><a href="#cb314-3138" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3139"><a href="#cb314-3139" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-3140"><a href="#cb314-3140" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3141"><a href="#cb314-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3142"><a href="#cb314-3142" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3143"><a href="#cb314-3143" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb314-3144"><a href="#cb314-3144" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3145"><a href="#cb314-3145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3146"><a href="#cb314-3146" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3147"><a href="#cb314-3147" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3148"><a href="#cb314-3148" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3149"><a href="#cb314-3149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3150"><a href="#cb314-3150" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb314-3151"><a href="#cb314-3151" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3152"><a href="#cb314-3152" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3153"><a href="#cb314-3153" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3154"><a href="#cb314-3154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3155"><a href="#cb314-3155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3156"><a href="#cb314-3156" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-3157"><a href="#cb314-3157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3158"><a href="#cb314-3158" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb314-3159"><a href="#cb314-3159" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3160"><a href="#cb314-3160" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb314-3161"><a href="#cb314-3161" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(3,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit3:SARIMA(0,1,1)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3162"><a href="#cb314-3162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3163"><a href="#cb314-3163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3166"><a href="#cb314-3166" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3167"><a href="#cb314-3167" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3168"><a href="#cb314-3168" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3169"><a href="#cb314-3169" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb314-3170"><a href="#cb314-3170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3171"><a href="#cb314-3171" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3172"><a href="#cb314-3172" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3173"><a href="#cb314-3173" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3174"><a href="#cb314-3174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3175"><a href="#cb314-3175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3176"><a href="#cb314-3176" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb314-3177"><a href="#cb314-3177" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3178"><a href="#cb314-3178" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb314-3179"><a href="#cb314-3179" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(3,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit3:SARIMA(0,1,1)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3180"><a href="#cb314-3180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3181"><a href="#cb314-3181" aria-hidden="true" tabindex="-1"></a>Overall, Fit 3 pulls ahead with slightly lower errors. So, it looks like Fit 3 is better.</span>
<span id="cb314-3182"><a href="#cb314-3182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3183"><a href="#cb314-3183" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-3184"><a href="#cb314-3184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3187"><a href="#cb314-3187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3188"><a href="#cb314-3188" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3189"><a href="#cb314-3189" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3190"><a href="#cb314-3190" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>imports_ts</span>
<span id="cb314-3191"><a href="#cb314-3191" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3192"><a href="#cb314-3192" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb314-3193"><a href="#cb314-3193" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">51</span><span class="co"># first training set length </span></span>
<span id="cb314-3194"><a href="#cb314-3194" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb314-3195"><a href="#cb314-3195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3196"><a href="#cb314-3196" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb314-3197"><a href="#cb314-3197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3198"><a href="#cb314-3198" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb314-3199"><a href="#cb314-3199" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3200"><a href="#cb314-3200" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3201"><a href="#cb314-3201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3202"><a href="#cb314-3202" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3203"><a href="#cb314-3203" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3204"><a href="#cb314-3204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3205"><a href="#cb314-3205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3206"><a href="#cb314-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3207"><a href="#cb314-3207" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb314-3208"><a href="#cb314-3208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3209"><a href="#cb314-3209" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb314-3210"><a href="#cb314-3210" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-3211"><a href="#cb314-3211" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb314-3212"><a href="#cb314-3212" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb314-3213"><a href="#cb314-3213" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb314-3214"><a href="#cb314-3214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3215"><a href="#cb314-3215" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3216"><a href="#cb314-3216" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-3217"><a href="#cb314-3217" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3218"><a href="#cb314-3218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3219"><a href="#cb314-3219" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3220"><a href="#cb314-3220" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-3221"><a href="#cb314-3221" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3222"><a href="#cb314-3222" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3223"><a href="#cb314-3223" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3224"><a href="#cb314-3224" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3225"><a href="#cb314-3225" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3226"><a href="#cb314-3226" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb314-3227"><a href="#cb314-3227" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3228"><a href="#cb314-3228" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3229"><a href="#cb314-3229" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3230"><a href="#cb314-3230" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3231"><a href="#cb314-3231" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-3232"><a href="#cb314-3232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3233"><a href="#cb314-3233" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb314-3234"><a href="#cb314-3234" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3235"><a href="#cb314-3235" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(0,1,3)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3236"><a href="#cb314-3236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3237"><a href="#cb314-3237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3240"><a href="#cb314-3240" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3241"><a href="#cb314-3241" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3242"><a href="#cb314-3242" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3243"><a href="#cb314-3243" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb314-3244"><a href="#cb314-3244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3245"><a href="#cb314-3245" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3246"><a href="#cb314-3246" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3247"><a href="#cb314-3247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3248"><a href="#cb314-3248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3249"><a href="#cb314-3249" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb314-3250"><a href="#cb314-3250" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3251"><a href="#cb314-3251" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(1,1,0)x(0,1,0)12"</span>,<span class="st">"Fit2:SARIMA(0,1,3)x(1,1,1)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3252"><a href="#cb314-3252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3253"><a href="#cb314-3253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3254"><a href="#cb314-3254" aria-hidden="true" tabindex="-1"></a>Overall, Fit 2 pulls ahead with slightly lower errors. So, it looks like Fit 2 is better.</span>
<span id="cb314-3255"><a href="#cb314-3255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3256"><a href="#cb314-3256" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-3257"><a href="#cb314-3257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3260"><a href="#cb314-3260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3261"><a href="#cb314-3261" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3262"><a href="#cb314-3262" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3263"><a href="#cb314-3263" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>exports_ts</span>
<span id="cb314-3264"><a href="#cb314-3264" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3265"><a href="#cb314-3265" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb314-3266"><a href="#cb314-3266" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb314-3267"><a href="#cb314-3267" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb314-3268"><a href="#cb314-3268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3269"><a href="#cb314-3269" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb314-3270"><a href="#cb314-3270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3271"><a href="#cb314-3271" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb314-3272"><a href="#cb314-3272" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3273"><a href="#cb314-3273" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3274"><a href="#cb314-3274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3275"><a href="#cb314-3275" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3276"><a href="#cb314-3276" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb314-3277"><a href="#cb314-3277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3278"><a href="#cb314-3278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3279"><a href="#cb314-3279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3280"><a href="#cb314-3280" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb314-3281"><a href="#cb314-3281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3282"><a href="#cb314-3282" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb314-3283"><a href="#cb314-3283" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb314-3284"><a href="#cb314-3284" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb314-3285"><a href="#cb314-3285" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb314-3286"><a href="#cb314-3286" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb314-3287"><a href="#cb314-3287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3288"><a href="#cb314-3288" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3289"><a href="#cb314-3289" aria-hidden="true" tabindex="-1"></a>               <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-3290"><a href="#cb314-3290" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3291"><a href="#cb314-3291" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3292"><a href="#cb314-3292" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb314-3293"><a href="#cb314-3293" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-3294"><a href="#cb314-3294" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb314-3295"><a href="#cb314-3295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3296"><a href="#cb314-3296" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3297"><a href="#cb314-3297" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb314-3298"><a href="#cb314-3298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3299"><a href="#cb314-3299" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb314-3300"><a href="#cb314-3300" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3301"><a href="#cb314-3301" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-3302"><a href="#cb314-3302" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3303"><a href="#cb314-3303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb314-3304"><a href="#cb314-3304" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-3305"><a href="#cb314-3305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3306"><a href="#cb314-3306" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb314-3307"><a href="#cb314-3307" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3308"><a href="#cb314-3308" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(0,1,1)x(0,0,1)12"</span>,<span class="st">"Fit2:SARIMA(0,1,1)x(1,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3309"><a href="#cb314-3309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3310"><a href="#cb314-3310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3313"><a href="#cb314-3313" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3314"><a href="#cb314-3314" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3315"><a href="#cb314-3315" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3316"><a href="#cb314-3316" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb314-3317"><a href="#cb314-3317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3318"><a href="#cb314-3318" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3319"><a href="#cb314-3319" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3320"><a href="#cb314-3320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3321"><a href="#cb314-3321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3322"><a href="#cb314-3322" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb314-3323"><a href="#cb314-3323" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb314-3324"><a href="#cb314-3324" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1: SARIMA(0,1,1)x(0,0,1)12"</span>,<span class="st">"Fit2:SARIMA(0,1,1)x(1,0,0)12"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb314-3325"><a href="#cb314-3325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3326"><a href="#cb314-3326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3327"><a href="#cb314-3327" aria-hidden="true" tabindex="-1"></a>Overall, Fit 2 pulls ahead with slightly lower errors. So, it looks like Fit 2 is better.</span>
<span id="cb314-3328"><a href="#cb314-3328" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3329"><a href="#cb314-3329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3330"><a href="#cb314-3330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final Model Fitting</span></span>
<span id="cb314-3331"><a href="#cb314-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3332"><a href="#cb314-3332" aria-hidden="true" tabindex="-1"></a>In this part, we're going to fit the best model from our earlier analysis and jot down its equation.</span>
<span id="cb314-3333"><a href="#cb314-3333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3334"><a href="#cb314-3334" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3335"><a href="#cb314-3335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-3336"><a href="#cb314-3336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3339"><a href="#cb314-3339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3340"><a href="#cb314-3340" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3341"><a href="#cb314-3341" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3342"><a href="#cb314-3342" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(prices_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb314-3343"><a href="#cb314-3343" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb314-3344"><a href="#cb314-3344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3345"><a href="#cb314-3345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3346"><a href="#cb314-3346" aria-hidden="true" tabindex="-1"></a>Model equation:</span>
<span id="cb314-3347"><a href="#cb314-3347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3348"><a href="#cb314-3348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3349"><a href="#cb314-3349" aria-hidden="true" tabindex="-1"></a>(1 - 0.9618B)(1-B)(1-0.1570B^{12}-0.1649B^{24})Y_t =(1+0.9071B)w_t</span>
<span id="cb314-3350"><a href="#cb314-3350" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3351"><a href="#cb314-3351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3352"><a href="#cb314-3352" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-3353"><a href="#cb314-3353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3356"><a href="#cb314-3356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3357"><a href="#cb314-3357" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3358"><a href="#cb314-3358" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3359"><a href="#cb314-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3360"><a href="#cb314-3360" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(consumption_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">period=</span><span class="dv">12</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb314-3361"><a href="#cb314-3361" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb314-3362"><a href="#cb314-3362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3363"><a href="#cb314-3363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3364"><a href="#cb314-3364" aria-hidden="true" tabindex="-1"></a>Model equation:</span>
<span id="cb314-3365"><a href="#cb314-3365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3366"><a href="#cb314-3366" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3367"><a href="#cb314-3367" aria-hidden="true" tabindex="-1"></a>(1 - 0.0163B - 0.9800B^2)(1 - 0.6047B^{12} + 0.4146B^{24})(1 - B^{12})^1Y_t = (1 + 0.3435B - 0.8232B^2 - 0.2451B^3)(1 - 1.4154B^{12} + 0.5988B^{24})w_t</span>
<span id="cb314-3368"><a href="#cb314-3368" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3369"><a href="#cb314-3369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3370"><a href="#cb314-3370" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-3371"><a href="#cb314-3371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3374"><a href="#cb314-3374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3375"><a href="#cb314-3375" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3376"><a href="#cb314-3376" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3377"><a href="#cb314-3377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3378"><a href="#cb314-3378" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(production_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb314-3379"><a href="#cb314-3379" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb314-3380"><a href="#cb314-3380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3381"><a href="#cb314-3381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3382"><a href="#cb314-3382" aria-hidden="true" tabindex="-1"></a>Model equation:</span>
<span id="cb314-3383"><a href="#cb314-3383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3384"><a href="#cb314-3384" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3385"><a href="#cb314-3385" aria-hidden="true" tabindex="-1"></a>(1 - B)(1 - B^{12}) Y_t = (1−0.2318B) (1−0.1148B^{12}) (1−0.6329B^{12}) w_t</span>
<span id="cb314-3386"><a href="#cb314-3386" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3387"><a href="#cb314-3387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3388"><a href="#cb314-3388" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-3389"><a href="#cb314-3389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3392"><a href="#cb314-3392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3393"><a href="#cb314-3393" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3394"><a href="#cb314-3394" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3395"><a href="#cb314-3395" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(imports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb314-3396"><a href="#cb314-3396" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span>
<span id="cb314-3397"><a href="#cb314-3397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3398"><a href="#cb314-3398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3399"><a href="#cb314-3399" aria-hidden="true" tabindex="-1"></a>Model equation:</span>
<span id="cb314-3400"><a href="#cb314-3400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3401"><a href="#cb314-3401" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3402"><a href="#cb314-3402" aria-hidden="true" tabindex="-1"></a>(1 - B)Y_t = (1−0.3213B) (1−0.6779B^{12})w_t</span>
<span id="cb314-3403"><a href="#cb314-3403" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3404"><a href="#cb314-3404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3405"><a href="#cb314-3405" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-3406"><a href="#cb314-3406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3409"><a href="#cb314-3409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3410"><a href="#cb314-3410" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3411"><a href="#cb314-3411" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3412"><a href="#cb314-3412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3413"><a href="#cb314-3413" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(exports_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb314-3414"><a href="#cb314-3414" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit5)</span>
<span id="cb314-3415"><a href="#cb314-3415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3416"><a href="#cb314-3416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3417"><a href="#cb314-3417" aria-hidden="true" tabindex="-1"></a>Model equation:</span>
<span id="cb314-3418"><a href="#cb314-3418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3419"><a href="#cb314-3419" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3420"><a href="#cb314-3420" aria-hidden="true" tabindex="-1"></a>(1 - B)(1 - B^{12}) Y_t = (1 + 0.5912 B^{12} - 0.1420 B^{24} - 0.0031 B^{36}) w_t</span>
<span id="cb314-3421"><a href="#cb314-3421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb314-3422"><a href="#cb314-3422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3423"><a href="#cb314-3423" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3424"><a href="#cb314-3424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3425"><a href="#cb314-3425" aria-hidden="true" tabindex="-1"></a><span class="fu">### SARIMA vs. Benchmark methods</span></span>
<span id="cb314-3426"><a href="#cb314-3426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3427"><a href="#cb314-3427" aria-hidden="true" tabindex="-1"></a>Now, we are going to compare the best model we chose above with the benchmark methods</span>
<span id="cb314-3428"><a href="#cb314-3428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3429"><a href="#cb314-3429" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3430"><a href="#cb314-3430" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-3431"><a href="#cb314-3431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3434"><a href="#cb314-3434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3435"><a href="#cb314-3435" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3436"><a href="#cb314-3436" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3437"><a href="#cb314-3437" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prices_ts) <span class="sc">+</span></span>
<span id="cb314-3438"><a href="#cb314-3438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3439"><a href="#cb314-3439" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3440"><a href="#cb314-3440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3441"><a href="#cb314-3441" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3442"><a href="#cb314-3442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3443"><a href="#cb314-3443" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3444"><a href="#cb314-3444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb314-3445"><a href="#cb314-3445" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3446"><a href="#cb314-3446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit1,<span class="dv">12</span>), </span>
<span id="cb314-3447"><a href="#cb314-3447" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb314-3448"><a href="#cb314-3448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span>
<span id="cb314-3449"><a href="#cb314-3449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3450"><a href="#cb314-3450" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-3451"><a href="#cb314-3451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3454"><a href="#cb314-3454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3455"><a href="#cb314-3455" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3456"><a href="#cb314-3456" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3457"><a href="#cb314-3457" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit1,<span class="dv">12</span>))</span>
<span id="cb314-3458"><a href="#cb314-3458" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3459"><a href="#cb314-3459" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(prices_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3460"><a href="#cb314-3460" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(prices_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3461"><a href="#cb314-3461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3462"><a href="#cb314-3462" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-3463"><a href="#cb314-3463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3464"><a href="#cb314-3464" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-3465"><a href="#cb314-3465" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-3466"><a href="#cb314-3466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3467"><a href="#cb314-3467" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-3468"><a href="#cb314-3468" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-3469"><a href="#cb314-3469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3470"><a href="#cb314-3470" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-3471"><a href="#cb314-3471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3472"><a href="#cb314-3472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3473"><a href="#cb314-3473" aria-hidden="true" tabindex="-1"></a>The Seasonal Naive method's trend line looked a lot like last year's. The SARIMA model has lower RMSE so it can be said that it did better than most of the other methods we checked out.</span>
<span id="cb314-3474"><a href="#cb314-3474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3475"><a href="#cb314-3475" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-3476"><a href="#cb314-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3479"><a href="#cb314-3479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3480"><a href="#cb314-3480" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3481"><a href="#cb314-3481" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3482"><a href="#cb314-3482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3483"><a href="#cb314-3483" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(consumption_ts) <span class="sc">+</span></span>
<span id="cb314-3484"><a href="#cb314-3484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3485"><a href="#cb314-3485" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3486"><a href="#cb314-3486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3487"><a href="#cb314-3487" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3488"><a href="#cb314-3488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3489"><a href="#cb314-3489" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3490"><a href="#cb314-3490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb314-3491"><a href="#cb314-3491" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3492"><a href="#cb314-3492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit2,<span class="dv">12</span>), </span>
<span id="cb314-3493"><a href="#cb314-3493" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb314-3494"><a href="#cb314-3494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span>
<span id="cb314-3495"><a href="#cb314-3495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3496"><a href="#cb314-3496" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-3497"><a href="#cb314-3497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3500"><a href="#cb314-3500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3501"><a href="#cb314-3501" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3502"><a href="#cb314-3502" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3503"><a href="#cb314-3503" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit2,<span class="dv">12</span>))</span>
<span id="cb314-3504"><a href="#cb314-3504" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3505"><a href="#cb314-3505" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(consumption_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3506"><a href="#cb314-3506" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(consumption_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3507"><a href="#cb314-3507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3508"><a href="#cb314-3508" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-3509"><a href="#cb314-3509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3510"><a href="#cb314-3510" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-3511"><a href="#cb314-3511" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-3512"><a href="#cb314-3512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3513"><a href="#cb314-3513" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-3514"><a href="#cb314-3514" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-3515"><a href="#cb314-3515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3516"><a href="#cb314-3516" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-3517"><a href="#cb314-3517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3518"><a href="#cb314-3518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3519"><a href="#cb314-3519" aria-hidden="true" tabindex="-1"></a>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method's trend line looked a lot like last year's, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</span>
<span id="cb314-3520"><a href="#cb314-3520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3521"><a href="#cb314-3521" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-3522"><a href="#cb314-3522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3525"><a href="#cb314-3525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3526"><a href="#cb314-3526" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3527"><a href="#cb314-3527" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3528"><a href="#cb314-3528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3529"><a href="#cb314-3529" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(production_ts) <span class="sc">+</span></span>
<span id="cb314-3530"><a href="#cb314-3530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3531"><a href="#cb314-3531" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3532"><a href="#cb314-3532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3533"><a href="#cb314-3533" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3534"><a href="#cb314-3534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3535"><a href="#cb314-3535" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3536"><a href="#cb314-3536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb314-3537"><a href="#cb314-3537" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3538"><a href="#cb314-3538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit3,<span class="dv">12</span>), </span>
<span id="cb314-3539"><a href="#cb314-3539" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb314-3540"><a href="#cb314-3540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span>
<span id="cb314-3541"><a href="#cb314-3541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3542"><a href="#cb314-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3543"><a href="#cb314-3543" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-3544"><a href="#cb314-3544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3547"><a href="#cb314-3547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3548"><a href="#cb314-3548" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3549"><a href="#cb314-3549" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3550"><a href="#cb314-3550" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit3,<span class="dv">12</span>))</span>
<span id="cb314-3551"><a href="#cb314-3551" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3552"><a href="#cb314-3552" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(production_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3553"><a href="#cb314-3553" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(production_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3554"><a href="#cb314-3554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3555"><a href="#cb314-3555" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-3556"><a href="#cb314-3556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3557"><a href="#cb314-3557" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-3558"><a href="#cb314-3558" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-3559"><a href="#cb314-3559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3560"><a href="#cb314-3560" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-3561"><a href="#cb314-3561" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-3562"><a href="#cb314-3562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3563"><a href="#cb314-3563" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-3564"><a href="#cb314-3564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3565"><a href="#cb314-3565" aria-hidden="true" tabindex="-1"></a>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method's trend line looked a lot like last year's, but the SARIMA model smoothed out the ups and downs a bit more.  Moreover, the RMSE of the SARIMA fit is the lowest.</span>
<span id="cb314-3566"><a href="#cb314-3566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3567"><a href="#cb314-3567" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-3568"><a href="#cb314-3568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3571"><a href="#cb314-3571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3572"><a href="#cb314-3572" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3573"><a href="#cb314-3573" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3574"><a href="#cb314-3574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3575"><a href="#cb314-3575" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(imports_ts) <span class="sc">+</span></span>
<span id="cb314-3576"><a href="#cb314-3576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3577"><a href="#cb314-3577" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3578"><a href="#cb314-3578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3579"><a href="#cb314-3579" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3580"><a href="#cb314-3580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3581"><a href="#cb314-3581" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3582"><a href="#cb314-3582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb314-3583"><a href="#cb314-3583" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3584"><a href="#cb314-3584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit4,<span class="dv">12</span>), </span>
<span id="cb314-3585"><a href="#cb314-3585" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb314-3586"><a href="#cb314-3586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span>
<span id="cb314-3587"><a href="#cb314-3587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3588"><a href="#cb314-3588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3589"><a href="#cb314-3589" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-3590"><a href="#cb314-3590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3593"><a href="#cb314-3593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3594"><a href="#cb314-3594" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3595"><a href="#cb314-3595" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3596"><a href="#cb314-3596" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit4,<span class="dv">12</span>))</span>
<span id="cb314-3597"><a href="#cb314-3597" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3598"><a href="#cb314-3598" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(imports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3599"><a href="#cb314-3599" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(imports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3600"><a href="#cb314-3600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3601"><a href="#cb314-3601" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-3602"><a href="#cb314-3602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3603"><a href="#cb314-3603" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-3604"><a href="#cb314-3604" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-3605"><a href="#cb314-3605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3606"><a href="#cb314-3606" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-3607"><a href="#cb314-3607" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-3608"><a href="#cb314-3608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3609"><a href="#cb314-3609" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-3610"><a href="#cb314-3610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3611"><a href="#cb314-3611" aria-hidden="true" tabindex="-1"></a>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method's trend line looked a lot like last year's, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</span>
<span id="cb314-3612"><a href="#cb314-3612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3613"><a href="#cb314-3613" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-3614"><a href="#cb314-3614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3617"><a href="#cb314-3617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3618"><a href="#cb314-3618" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3619"><a href="#cb314-3619" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3620"><a href="#cb314-3620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3621"><a href="#cb314-3621" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exports_ts) <span class="sc">+</span></span>
<span id="cb314-3622"><a href="#cb314-3622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3623"><a href="#cb314-3623" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3624"><a href="#cb314-3624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3625"><a href="#cb314-3625" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb314-3626"><a href="#cb314-3626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>),</span>
<span id="cb314-3627"><a href="#cb314-3627" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3628"><a href="#cb314-3628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb314-3629"><a href="#cb314-3629" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb314-3630"><a href="#cb314-3630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit5,<span class="dv">12</span>), </span>
<span id="cb314-3631"><a href="#cb314-3631" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb314-3632"><a href="#cb314-3632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span>
<span id="cb314-3633"><a href="#cb314-3633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3634"><a href="#cb314-3634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3635"><a href="#cb314-3635" aria-hidden="true" tabindex="-1"></a>**Comparing Accuracy Metrics**</span>
<span id="cb314-3636"><a href="#cb314-3636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3639"><a href="#cb314-3639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3640"><a href="#cb314-3640" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3641"><a href="#cb314-3641" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3642"><a href="#cb314-3642" aria-hidden="true" tabindex="-1"></a>output1 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit5,<span class="dv">12</span>))</span>
<span id="cb314-3643"><a href="#cb314-3643" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">meanf</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3644"><a href="#cb314-3644" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">naive</span>(exports_ts, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3645"><a href="#cb314-3645" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">rwf</span>(exports_ts, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">12</span>))</span>
<span id="cb314-3646"><a href="#cb314-3646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3647"><a href="#cb314-3647" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>(output1, output2, output3, output4)</span>
<span id="cb314-3648"><a href="#cb314-3648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3649"><a href="#cb314-3649" aria-hidden="true" tabindex="-1"></a><span class="co"># Put into df</span></span>
<span id="cb314-3650"><a href="#cb314-3650" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, output_list)</span>
<span id="cb314-3651"><a href="#cb314-3651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3652"><a href="#cb314-3652" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names for the dataframe</span></span>
<span id="cb314-3653"><a href="#cb314-3653" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(output_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SARIMA fit"</span>, <span class="st">"Meanf"</span>, <span class="st">"Naive"</span>, <span class="st">"Drift"</span>)</span>
<span id="cb314-3654"><a href="#cb314-3654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3655"><a href="#cb314-3655" aria-hidden="true" tabindex="-1"></a>output_df</span>
<span id="cb314-3656"><a href="#cb314-3656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3657"><a href="#cb314-3657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3658"><a href="#cb314-3658" aria-hidden="true" tabindex="-1"></a>The SARIMA model did better than most of the other methods we checked out. It picked up on the seasonal swings that a lot of the other methods missed. The Seasonal Naive method's trend line looked a lot like last year's, but the SARIMA model smoothed out the ups and downs a bit more. Moreover, the RMSE of the SARIMA fit is the lowest.</span>
<span id="cb314-3659"><a href="#cb314-3659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3660"><a href="#cb314-3660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3661"><a href="#cb314-3661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3662"><a href="#cb314-3662" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting</span></span>
<span id="cb314-3663"><a href="#cb314-3663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3664"><a href="#cb314-3664" aria-hidden="true" tabindex="-1"></a>Finally, we'll forecast and plot the forecast for the next 3 years using our final fit.</span>
<span id="cb314-3665"><a href="#cb314-3665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3666"><a href="#cb314-3666" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3667"><a href="#cb314-3667" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-3668"><a href="#cb314-3668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3671"><a href="#cb314-3671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3672"><a href="#cb314-3672" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3673"><a href="#cb314-3673" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3674"><a href="#cb314-3674" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb314-3675"><a href="#cb314-3675" aria-hidden="true" tabindex="-1"></a>fit1 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Prices Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb314-3676"><a href="#cb314-3676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prices"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-3677"><a href="#cb314-3677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3678"><a href="#cb314-3678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3679"><a href="#cb314-3679" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-3680"><a href="#cb314-3680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3683"><a href="#cb314-3683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3684"><a href="#cb314-3684" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3685"><a href="#cb314-3685" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3686"><a href="#cb314-3686" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb314-3687"><a href="#cb314-3687" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Consumption Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb314-3688"><a href="#cb314-3688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Consumption"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-3689"><a href="#cb314-3689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3690"><a href="#cb314-3690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3691"><a href="#cb314-3691" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-3692"><a href="#cb314-3692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3695"><a href="#cb314-3695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3696"><a href="#cb314-3696" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3697"><a href="#cb314-3697" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3698"><a href="#cb314-3698" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb314-3699"><a href="#cb314-3699" aria-hidden="true" tabindex="-1"></a>fit3 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Production Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb314-3700"><a href="#cb314-3700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Production"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-3701"><a href="#cb314-3701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3702"><a href="#cb314-3702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3703"><a href="#cb314-3703" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-3704"><a href="#cb314-3704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3707"><a href="#cb314-3707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3708"><a href="#cb314-3708" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3709"><a href="#cb314-3709" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3710"><a href="#cb314-3710" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb314-3711"><a href="#cb314-3711" aria-hidden="true" tabindex="-1"></a>fit4 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Imports Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb314-3712"><a href="#cb314-3712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Imports"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-3713"><a href="#cb314-3713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3714"><a href="#cb314-3714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3715"><a href="#cb314-3715" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-3716"><a href="#cb314-3716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3719"><a href="#cb314-3719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb314-3720"><a href="#cb314-3720" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3721"><a href="#cb314-3721" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3722"><a href="#cb314-3722" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast next three years</span></span>
<span id="cb314-3723"><a href="#cb314-3723" aria-hidden="true" tabindex="-1"></a>fit5 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">main =</span> <span class="st">"Natual Gas Exports Prediction"</span>,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span></span>
<span id="cb314-3724"><a href="#cb314-3724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Exports"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() </span>
<span id="cb314-3725"><a href="#cb314-3725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3726"><a href="#cb314-3726" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3727"><a href="#cb314-3727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3728"><a href="#cb314-3728" aria-hidden="true" tabindex="-1"></a>The forecasted values come from the model's parameters, which we figured out by looking at past data. To see how accurate these forecasts are, we can use cross-validation. This means we split the data into a part for training and another part for testing. Then we see how well the model's predictions stack up against the real numbers in the test set. This step is key for spotting any issues with the model and tweaking the parameters to get things just right.</span>
<span id="cb314-3729"><a href="#cb314-3729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3730"><a href="#cb314-3730" aria-hidden="true" tabindex="-1"></a><span class="fu">### Seasonal Cross-Validation</span></span>
<span id="cb314-3731"><a href="#cb314-3731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3732"><a href="#cb314-3732" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3733"><a href="#cb314-3733" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Prices</span></span>
<span id="cb314-3734"><a href="#cb314-3734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3735"><a href="#cb314-3735" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3736"><a href="#cb314-3736" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 12-step ahead CV </span></span>
<span id="cb314-3737"><a href="#cb314-3737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3740"><a href="#cb314-3740" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3741"><a href="#cb314-3741" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3742"><a href="#cb314-3742" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3743"><a href="#cb314-3743" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb314-3744"><a href="#cb314-3744" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)), <span class="at">h=</span>h)}</span>
<span id="cb314-3745"><a href="#cb314-3745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3746"><a href="#cb314-3746" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb314-3747"><a href="#cb314-3747" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(prices_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb314-3748"><a href="#cb314-3748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3749"><a href="#cb314-3749" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb314-3750"><a href="#cb314-3750" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb314-3751"><a href="#cb314-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3752"><a href="#cb314-3752" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3753"><a href="#cb314-3753" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3754"><a href="#cb314-3754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb314-3755"><a href="#cb314-3755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3756"><a href="#cb314-3756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3757"><a href="#cb314-3757" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1-step ahead CV </span></span>
<span id="cb314-3760"><a href="#cb314-3760" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3761"><a href="#cb314-3761" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3762"><a href="#cb314-3762" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3763"><a href="#cb314-3763" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb314-3764"><a href="#cb314-3764" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span>h)}</span>
<span id="cb314-3765"><a href="#cb314-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3766"><a href="#cb314-3766" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb314-3767"><a href="#cb314-3767" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(prices_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb314-3768"><a href="#cb314-3768" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3769"><a href="#cb314-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3770"><a href="#cb314-3770" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3771"><a href="#cb314-3771" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3772"><a href="#cb314-3772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3773"><a href="#cb314-3773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3774"><a href="#cb314-3774" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3775"><a href="#cb314-3775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3776"><a href="#cb314-3776" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consumption</span></span>
<span id="cb314-3777"><a href="#cb314-3777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3778"><a href="#cb314-3778" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3779"><a href="#cb314-3779" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 12-step ahead CV </span></span>
<span id="cb314-3780"><a href="#cb314-3780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3783"><a href="#cb314-3783" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3784"><a href="#cb314-3784" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3785"><a href="#cb314-3785" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3786"><a href="#cb314-3786" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb314-3787"><a href="#cb314-3787" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)), <span class="at">h=</span>h)}</span>
<span id="cb314-3788"><a href="#cb314-3788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3789"><a href="#cb314-3789" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb314-3790"><a href="#cb314-3790" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(consumption_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb314-3791"><a href="#cb314-3791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3792"><a href="#cb314-3792" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb314-3793"><a href="#cb314-3793" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb314-3794"><a href="#cb314-3794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3795"><a href="#cb314-3795" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3796"><a href="#cb314-3796" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3797"><a href="#cb314-3797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3798"><a href="#cb314-3798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3799"><a href="#cb314-3799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3800"><a href="#cb314-3800" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1-step ahead CV </span></span>
<span id="cb314-3801"><a href="#cb314-3801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3804"><a href="#cb314-3804" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3805"><a href="#cb314-3805" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3806"><a href="#cb314-3806" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3807"><a href="#cb314-3807" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb314-3808"><a href="#cb314-3808" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)),<span class="at">h=</span>h)}</span>
<span id="cb314-3809"><a href="#cb314-3809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3810"><a href="#cb314-3810" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb314-3811"><a href="#cb314-3811" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(consumption_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb314-3812"><a href="#cb314-3812" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3813"><a href="#cb314-3813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3814"><a href="#cb314-3814" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3815"><a href="#cb314-3815" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3816"><a href="#cb314-3816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3817"><a href="#cb314-3817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3818"><a href="#cb314-3818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3819"><a href="#cb314-3819" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3820"><a href="#cb314-3820" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Production</span></span>
<span id="cb314-3821"><a href="#cb314-3821" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3822"><a href="#cb314-3822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3823"><a href="#cb314-3823" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 12-step ahead CV </span></span>
<span id="cb314-3824"><a href="#cb314-3824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3827"><a href="#cb314-3827" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3828"><a href="#cb314-3828" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3829"><a href="#cb314-3829" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3830"><a href="#cb314-3830" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb314-3831"><a href="#cb314-3831" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb314-3832"><a href="#cb314-3832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3833"><a href="#cb314-3833" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb314-3834"><a href="#cb314-3834" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(production_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb314-3835"><a href="#cb314-3835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3836"><a href="#cb314-3836" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb314-3837"><a href="#cb314-3837" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb314-3838"><a href="#cb314-3838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3839"><a href="#cb314-3839" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3840"><a href="#cb314-3840" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3841"><a href="#cb314-3841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3842"><a href="#cb314-3842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3843"><a href="#cb314-3843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3844"><a href="#cb314-3844" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1-step ahead CV </span></span>
<span id="cb314-3845"><a href="#cb314-3845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3848"><a href="#cb314-3848" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3849"><a href="#cb314-3849" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3850"><a href="#cb314-3850" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3851"><a href="#cb314-3851" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb314-3852"><a href="#cb314-3852" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)),<span class="at">h=</span>h)}</span>
<span id="cb314-3853"><a href="#cb314-3853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3854"><a href="#cb314-3854" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb314-3855"><a href="#cb314-3855" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(production_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb314-3856"><a href="#cb314-3856" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3857"><a href="#cb314-3857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3858"><a href="#cb314-3858" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3859"><a href="#cb314-3859" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3860"><a href="#cb314-3860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3861"><a href="#cb314-3861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3862"><a href="#cb314-3862" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3863"><a href="#cb314-3863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3864"><a href="#cb314-3864" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Imports</span></span>
<span id="cb314-3865"><a href="#cb314-3865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3866"><a href="#cb314-3866" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3867"><a href="#cb314-3867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3868"><a href="#cb314-3868" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 12-step ahead CV</span></span>
<span id="cb314-3869"><a href="#cb314-3869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3872"><a href="#cb314-3872" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3873"><a href="#cb314-3873" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3874"><a href="#cb314-3874" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3875"><a href="#cb314-3875" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb314-3876"><a href="#cb314-3876" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)), <span class="at">h=</span>h)}</span>
<span id="cb314-3877"><a href="#cb314-3877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3878"><a href="#cb314-3878" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb314-3879"><a href="#cb314-3879" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(imports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb314-3880"><a href="#cb314-3880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3881"><a href="#cb314-3881" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb314-3882"><a href="#cb314-3882" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb314-3883"><a href="#cb314-3883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3884"><a href="#cb314-3884" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3885"><a href="#cb314-3885" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3886"><a href="#cb314-3886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3887"><a href="#cb314-3887" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3888"><a href="#cb314-3888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3889"><a href="#cb314-3889" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1-step ahead CV </span></span>
<span id="cb314-3890"><a href="#cb314-3890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3893"><a href="#cb314-3893" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3894"><a href="#cb314-3894" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3895"><a href="#cb314-3895" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3896"><a href="#cb314-3896" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb314-3897"><a href="#cb314-3897" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span>h)}</span>
<span id="cb314-3898"><a href="#cb314-3898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3899"><a href="#cb314-3899" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb314-3900"><a href="#cb314-3900" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(imports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb314-3901"><a href="#cb314-3901" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3902"><a href="#cb314-3902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3903"><a href="#cb314-3903" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3904"><a href="#cb314-3904" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3905"><a href="#cb314-3905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3906"><a href="#cb314-3906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3907"><a href="#cb314-3907" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3908"><a href="#cb314-3908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3909"><a href="#cb314-3909" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb314-3910"><a href="#cb314-3910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3911"><a href="#cb314-3911" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb314-3912"><a href="#cb314-3912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3913"><a href="#cb314-3913" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 12-step ahead CV </span></span>
<span id="cb314-3914"><a href="#cb314-3914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3917"><a href="#cb314-3917" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3918"><a href="#cb314-3918" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3919"><a href="#cb314-3919" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3920"><a href="#cb314-3920" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 12 steps ahead forecasts</span></span>
<span id="cb314-3921"><a href="#cb314-3921" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)), <span class="at">h=</span>h)}</span>
<span id="cb314-3922"><a href="#cb314-3922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3923"><a href="#cb314-3923" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb314-3924"><a href="#cb314-3924" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(exports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb314-3925"><a href="#cb314-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3926"><a href="#cb314-3926" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb314-3927"><a href="#cb314-3927" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb314-3928"><a href="#cb314-3928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3929"><a href="#cb314-3929" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3930"><a href="#cb314-3930" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3931"><a href="#cb314-3931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"12 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3932"><a href="#cb314-3932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3933"><a href="#cb314-3933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3934"><a href="#cb314-3934" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1-step ahead CV </span></span>
<span id="cb314-3935"><a href="#cb314-3935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3938"><a href="#cb314-3938" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb314-3939"><a href="#cb314-3939" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb314-3940"><a href="#cb314-3940" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb314-3941"><a href="#cb314-3941" aria-hidden="true" tabindex="-1"></a><span class="co">#a seasonal cross validation using 1 steps ahead forecasts</span></span>
<span id="cb314-3942"><a href="#cb314-3942" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(x, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)),<span class="at">h=</span>h)}</span>
<span id="cb314-3943"><a href="#cb314-3943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3944"><a href="#cb314-3944" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 1 steps ahead</span></span>
<span id="cb314-3945"><a href="#cb314-3945" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(exports_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">1</span>)</span>
<span id="cb314-3946"><a href="#cb314-3946" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-3947"><a href="#cb314-3947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3948"><a href="#cb314-3948" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb314-3949"><a href="#cb314-3949" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb314-3950"><a href="#cb314-3950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#92c54b"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"1 Step Ahead Cross Validation"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-3951"><a href="#cb314-3951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb314-3952"><a href="#cb314-3952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3953"><a href="#cb314-3953" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3954"><a href="#cb314-3954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3955"><a href="#cb314-3955" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb314-3956"><a href="#cb314-3956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3957"><a href="#cb314-3957" aria-hidden="true" tabindex="-1"></a>The MSE tends to rise by 12 steps at each step of cross-validation it suggests that there's a pattern of increasing error which indicates that the model becomes less accurate at predicting values one year ahead. However, the one-step-ahead forecasting plots show that the MSE seems to be stable. Indicating that our model's predictions are consistently close to the actual values for each subsequent time point in the series.</span>
<span id="cb314-3958"><a href="#cb314-3958" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2024, Samiksha Rajendra Thikekar</div>
  </div>
</footer>



</body></html>