<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.246">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Multivariate TS Models (ARIMAX/SARIMAX/VAR)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><a href="https://samikshathikekar.georgetown.domains/time-series-project-website/_site/intro.html">DSAN-5600 PROJECT</a></span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://samikshathikekar.georgetown.domains/time-series-project-layout/_site/">
 <span class="menu-text">Author</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://samikshathikekar.georgetown.domains/time-series-project-layout/_site/ts.html">
 <span class="menu-text">Time Series Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./intro.qmd">
 <span class="menu-text">Time Series Project</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasrc.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataviz.html" class="sidebar-item-text sidebar-link">Data Visualization</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">Exploratory Data Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./univariate.html" class="sidebar-item-text sidebar-link">Univariate TS Models (ARIMA / SARIMA)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate.html" class="sidebar-item-text sidebar-link active">Multivariate TS Models (ARIMAX / SARIMAX / VAR)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial.html" class="sidebar-item-text sidebar-link">Financial TS Models (ARCH / GARCH)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dl.html" class="sidebar-item-text sidebar-link">Deep Learning for TS</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">Conclusions / Discussion</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link active" data-scroll-target="#literature-review">Literature Review</a></li>
  <li><a href="#datasets-models" id="toc-datasets-models" class="nav-link" data-scroll-target="#datasets-models">Datasets &amp; Models</a></li>
  <li><a href="#arimaxsarimax-modeling" id="toc-arimaxsarimax-modeling" class="nav-link" data-scroll-target="#arimaxsarimax-modeling">ARIMAX/SARIMAX Modeling</a>
  <ul class="collapse">
  <li><a href="#time-series-plot" id="toc-time-series-plot" class="nav-link" data-scroll-target="#time-series-plot">Time series plot</a></li>
  <li><a href="#automatic-model-fitting" id="toc-automatic-model-fitting" class="nav-link" data-scroll-target="#automatic-model-fitting">Automatic Model Fitting</a></li>
  <li><a href="#manual-model-fitting" id="toc-manual-model-fitting" class="nav-link" data-scroll-target="#manual-model-fitting">Manual Model Fitting</a></li>
  <li><a href="#fitting-residuals" id="toc-fitting-residuals" class="nav-link" data-scroll-target="#fitting-residuals">Fitting residuals</a></li>
  <li><a href="#finding-model-parameters" id="toc-finding-model-parameters" class="nav-link" data-scroll-target="#finding-model-parameters">Finding Model Parameters</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross Validation</a></li>
  <li><a href="#final-model-fitting" id="toc-final-model-fitting" class="nav-link" data-scroll-target="#final-model-fitting">Final Model Fitting</a></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting</a></li>
  </ul></li>
  <li><a href="#var-modeling" id="toc-var-modeling" class="nav-link" data-scroll-target="#var-modeling">VAR Modeling</a>
  <ul class="collapse">
  <li><a href="#time-series-plot-1" id="toc-time-series-plot-1" class="nav-link" data-scroll-target="#time-series-plot-1">Time series plot</a></li>
  <li><a href="#finding-best-p" id="toc-finding-best-p" class="nav-link" data-scroll-target="#finding-best-p">Finding Best p</a></li>
  <li><a href="#var-model-fitting" id="toc-var-model-fitting" class="nav-link" data-scroll-target="#var-model-fitting">VAR model fitting</a></li>
  <li><a href="#cross-validation-1" id="toc-cross-validation-1" class="nav-link" data-scroll-target="#cross-validation-1">Cross validation</a></li>
  <li><a href="#model-equation" id="toc-model-equation" class="nav-link" data-scroll-target="#model-equation">Model Equation</a></li>
  <li><a href="#forecasting-1" id="toc-forecasting-1" class="nav-link" data-scroll-target="#forecasting-1">Forecasting</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This section delves into the use of ARIMAX, SARIMAX, and VAR modeling techniques for the time series datasets relevant to my project.</p>
<p>The ARIMAX (AutoRegressive Integrated Moving Average with eXogenous variables) and SARIMAX (Seasonal ARIMAX) models are particularly useful when you’re looking to predict the behavior of one primary variable based on its past values, while also considering the impact of other external variables. These models are invaluable for scenarios where external factors significantly drive changes in the primary variable, but the influence isn’t bidirectional.</p>
<p>On the other hand, VAR (Vector Autoregression) models are pivotal when analyzing systems where variables are interdependent. These models allow us to explore how each variable in the dataset influences others over time, providing a comprehensive view of the dynamic interactions within the data.</p>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature Review</h2>
<p><a href="http://eprints.ubhara.ac.id/746/1/Macroeconomi%20factor.pdf">Macroeconomic Factors Affecting Natural Gas Export Management</a>: The paper demonstrates that domestic consumption, exchange rates, and GDP per capita of the importing country significantly influence natural gas export volumes both in the short and long term. This suggests that these variables are critical predictors for modeling and forecasting the volume of natural gas exports</p>
<p><a href="https://www.energypolicy.columbia.edu/sites/default/files/pictures/LowUSStorageLevels-CGEP_FINAL.pdf">Low US Storage Levels Point to Winter Natural Gas Price Spike Risk</a>: The article highlights how low gas storage levels significantly impact natural gas prices, suggesting that storage could be a critical dependent variable in models predicting these prices, especially during high-demand winter periods. This relationship also implies that storage levels could serve as a dependent variable in predicting natural gas demand, reflecting its role in balancing supply and demand seasonally.</p>
<p><a href="https://www.eia.gov/outlooks/steo/special/supplements/2023/2023_sp_01.pdf">Short-Term Energy Outlook Supplement: Market Drivers and Other Factors Affecting Natural Gas Prices</a>: This report provides a detailed analysis of various factors influencing natural gas prices. The report’s emphasis on the direct impacts of consumption and production on natural gas pricing. The report’s discussion on macroeconomic trends affecting industrial activity and natural gas consumption, suggesting that broader economic conditions significantly impact natural gas demand and, consequently, prices.</p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7954813/">Impacts of long-term temperature change and variability on electricity investments</a>: This paper highlights how temperature increases significantly impact electric capacity and investment needs in the U.S. Analyzing climate and socioeconomic scenarios, it shows that higher temperatures boost electricity demand and capital investments, especially during peak times. This suggests that temperature is a crucial factor in predicting natural gas demand, as it is integral to electricity generation.</p>
<p><a href="https://www.nature.com/articles/ncomms8714">Drivers of the US CO2 emissions 1997–2013</a>: This paper uses structural decomposition analysis (SDA) to identify the key factors influencing CO2 emissions in the United States. It reveals that increases in consumption drove emissions up during 1997-2007, while reductions in consumption and changes in production structures helped decrease emissions from 2007-2013. These findings highlights the importance of targeting consumption patterns and production structures in CO2 emissions management.</p>
</section>
<section id="datasets-models" class="level2">
<h2 class="anchored" data-anchor-id="datasets-models">Datasets &amp; Models</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">CO2 Emissions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Supply Influence</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>(SARIMAX) Consumption ~ Temperature + Production + Storage</strong></p>
<p>I chose Temperature, Production, and Storage as exogenous variables in the SARIMAX model for predicting natural gas demand because Temperature directly influences consumption due to heating and cooling needs, varying with the seasons. Production levels impact market supply, which can affect consumption by altering availability and prices. Storage levels act as a buffer for supply fluctuations and have implications on consumption through their effect on market dynamics.</p>
<div class="cell">

</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>temperature<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/temperature.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>temperature<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(temperature<span class="sc">$</span>moonth, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">subset</span>(temperature, <span class="at">select =</span> <span class="fu">c</span>(Date,avg_temp))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temperature)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"temperature"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">subset</span>(production, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>storage<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Storage.csv"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>storage<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(storage<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>storage <span class="ot">&lt;-</span> <span class="fu">subset</span>(storage, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(storage)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"storage"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> consumption <span class="sc">%&gt;%</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temperature, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(production, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(storage, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> demand[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(demand))]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>demand_ts <span class="ot">=</span> <span class="fu">ts</span>(demand, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>), <span class="at">frequency =</span><span class="dv">12</span> )</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>head_demand<span class="ot">&lt;-</span><span class="fu">head</span>(demand)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_demand, <span class="at">caption =</span> <span class="st">"Natural Gas Demand in the US Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Natural Gas Demand in the US Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: right;">Consumption</th>
<th style="text-align: right;">temperature</th>
<th style="text-align: right;">Production</th>
<th style="text-align: right;">storage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: right;">2561858</td>
<td style="text-align: right;">33.4</td>
<td style="text-align: right;">2035036</td>
<td style="text-align: right;">6199291</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-02-01</td>
<td style="text-align: right;">2242986</td>
<td style="text-align: right;">37.9</td>
<td style="text-align: right;">1870546</td>
<td style="text-align: right;">5768939</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-03-01</td>
<td style="text-align: right;">2205787</td>
<td style="text-align: right;">42.3</td>
<td style="text-align: right;">2080504</td>
<td style="text-align: right;">5484332</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: right;">1724877</td>
<td style="text-align: right;">52.3</td>
<td style="text-align: right;">1979474</td>
<td style="text-align: right;">5699060</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: right;">1522613</td>
<td style="text-align: right;">59.6</td>
<td style="text-align: right;">2010625</td>
<td style="text-align: right;">6075521</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-06-01</td>
<td style="text-align: right;">1534122</td>
<td style="text-align: right;">69.2</td>
<td style="text-align: right;">1972975</td>
<td style="text-align: right;">6398738</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>(ARIMAX) Prices(Henry Hub) ~ GDP + Unemployment</strong></p>
<p>I chose GDP and unemployment rates as exogenous variables for this analysis because they are key indicators of economic activity and health, which directly influence energy demand and pricing. Changes in GDP reflect shifts in industrial and consumer demand for energy, while unemployment rates can impact consumption patterns, both of which affect natural gas prices at Henry Hub.</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>price<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Henry_Hub_Natural_Gas_Spot_Price.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>price<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(price<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">subset</span>(price, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"price"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> price[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"price"</span>)]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">price =</span> <span class="fu">round</span>(<span class="fu">mean</span>(price),<span class="dv">2</span>),  </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>gdp<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/gdp.csv"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>gdp<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(gdp<span class="sc">$</span>Quarter, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">&lt;-</span> <span class="fu">subset</span>(gdp, <span class="at">select =</span> <span class="sc">-</span>Quarter)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gdp)[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"gdp"</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">&lt;-</span> gdp[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"gdp"</span>)]</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>unemp<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/unemp.csv"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="do">##unpivot</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp <span class="sc">%&gt;%</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Jan<span class="sc">:</span>Dec,  <span class="co">#the range of columns to unpivot</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Month"</span>,  </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Unemp"</span>  </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>unemp<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">make_date</span>(<span class="at">year =</span> unemp<span class="sc">$</span>Year, <span class="at">month =</span> <span class="fu">match</span>(unemp<span class="sc">$</span>Month, month.abb), <span class="at">day =</span> <span class="dv">1</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder columns to place Date first and drop Year and Month as they are no longer needed</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp[, <span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Unemp"</span>)]</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>unemp<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(unemp<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp <span class="sc">%&gt;%</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">unemp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Unemp),<span class="dv">2</span>),  </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>eco <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gdp, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(unemp, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>eco_ts <span class="ot">=</span> <span class="fu">ts</span>(eco, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">frequency =</span><span class="dv">4</span> )</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>head_eco<span class="ot">&lt;-</span><span class="fu">head</span>(eco)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_eco, <span class="at">caption =</span> <span class="st">"Natural Gas Henry Hub Prices and Macroeconomic Indicators in the US Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Natural Gas Henry Hub Prices and Macroeconomic Indicators in the US Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">gdp</th>
<th style="text-align: right;">unemp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: right;">6.42</td>
<td style="text-align: right;">12767.29</td>
<td style="text-align: right;">5.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: right;">6.94</td>
<td style="text-align: right;">12922.66</td>
<td style="text-align: right;">5.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-07-01</td>
<td style="text-align: right;">9.64</td>
<td style="text-align: right;">13142.64</td>
<td style="text-align: right;">4.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-10-01</td>
<td style="text-align: right;">12.26</td>
<td style="text-align: right;">13324.20</td>
<td style="text-align: right;">4.97</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2006-01-01</td>
<td style="text-align: right;">7.71</td>
<td style="text-align: right;">13599.16</td>
<td style="text-align: right;">4.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">2006-04-01</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">13753.42</td>
<td style="text-align: right;">4.63</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>(ARIMAX) Exports ~ Domestic Consumption + Exchange Rate + GDP of of the importing country(Netherlands) </strong></p>
<p>I chose domestic consumption for this analysis because it directly reflects the internal demand for natural gas within the U.S., influencing how much is available for export. The exchange rate affects the competitiveness of U.S. natural gas in global markets, with favorable rates potentially boosting exports by making them more cost-effective for foreign buyers. Additionally, the GDP of the importing country, the Netherlands in this case, was chosen because it indicates the economic health and energy demand of a key market, impacting the volume of natural gas they are likely to import from the U.S.</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>exports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/exports.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>exports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(exports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> <span class="fu">subset</span>(exports, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Exports"</span>)]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is greater than 2004</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports[<span class="fu">as.integer</span>(<span class="fu">format</span>(exports<span class="sc">$</span>Date, <span class="st">"%Y"</span>)) <span class="sc">&gt;</span> <span class="dv">2004</span>, ]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">exports =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Exports),<span class="dv">2</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Consumption"</span>)]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption <span class="sc">%&gt;%</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">consumption =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Consumption),<span class="dv">2</span>),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>fx_rate<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/exchange_rate.csv"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>fx_rate<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(fx_rate<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fx_rate)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"fx_rate"</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>gdp_nl<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/gdp_int.csv"</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>gdp_nl<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(gdp_nl<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gdp_nl)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"gdp_nl"</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>export <span class="ot">&lt;-</span> exports <span class="sc">%&gt;%</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(consumption, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fx_rate, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gdp_nl, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>export_ts <span class="ot">=</span> <span class="fu">ts</span>(export, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">frequency =</span><span class="dv">4</span> )</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>head_export<span class="ot">&lt;-</span><span class="fu">head</span>(export)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_export, <span class="at">caption =</span> <span class="st">"US Exports of Natural Gas and the Influencing Factors Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>US Exports of Natural Gas and the Influencing Factors Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: right;">exports</th>
<th style="text-align: right;">consumption</th>
<th style="text-align: right;">fx_rate</th>
<th style="text-align: right;">gdp_nl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: right;">92397.00</td>
<td style="text-align: right;">2336877</td>
<td style="text-align: right;">105.2033</td>
<td style="text-align: right;">134841.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: right;">56429.67</td>
<td style="text-align: right;">1593871</td>
<td style="text-align: right;">103.9500</td>
<td style="text-align: right;">136587.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-07-01</td>
<td style="text-align: right;">50286.33</td>
<td style="text-align: right;">1601402</td>
<td style="text-align: right;">102.4767</td>
<td style="text-align: right;">138671.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-10-01</td>
<td style="text-align: right;">43753.67</td>
<td style="text-align: right;">1805996</td>
<td style="text-align: right;">101.5567</td>
<td style="text-align: right;">140509.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2006-01-01</td>
<td style="text-align: right;">61266.67</td>
<td style="text-align: right;">2145338</td>
<td style="text-align: right;">100.7100</td>
<td style="text-align: right;">143090.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">2006-04-01</td>
<td style="text-align: right;">57815.33</td>
<td style="text-align: right;">1586060</td>
<td style="text-align: right;">102.1833</td>
<td style="text-align: right;">145172.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p><strong>(ARIMAX) CO2 emissions ~ Natural Gas Consumption + Natural Gas Production</strong></p>
<p>I chose Natural Gas Consumption and Natural Gas Production as exogenous variables in the ARIMAX model for predicting CO2 emissions, because these variables are directly linked to emissions levels. Natural gas consumption is a primary source of CO2 emissions, particularly in power generation and industrial uses, making it a key variable for accurate emissions modeling. Similarly, the rate of natural gas production influences the availability and usage of natural gas, thereby affecting overall emissions.</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/co2_emissions.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(co2_emissions<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>co2_emissions <span class="ot">&lt;-</span> <span class="fu">subset</span>(co2_emissions, <span class="at">select =</span> <span class="fu">c</span>(Date,co2_value))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is greater than 2004</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>co2_emissions <span class="ot">&lt;-</span> co2_emissions[<span class="fu">as.integer</span>(<span class="fu">format</span>(co2_emissions<span class="sc">$</span>Date, <span class="st">"%Y"</span>)) <span class="sc">&gt;</span> <span class="dv">2004</span>, ]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is less than 2023</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>co2_emissions <span class="ot">&lt;-</span> co2_emissions[<span class="fu">as.integer</span>(<span class="fu">format</span>(co2_emissions<span class="sc">$</span>Date, <span class="st">"%Y"</span>))<span class="sc">&lt;</span><span class="dv">2023</span>, ]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">subset</span>(production, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>env_impact <span class="ot">&lt;-</span> co2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(consumption, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(production, <span class="at">by =</span> <span class="st">"Date"</span>) </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>env_impact_ts <span class="ot">=</span> <span class="fu">ts</span>(env_impact, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>), <span class="at">frequency =</span><span class="dv">12</span> )</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>head_env_impact<span class="ot">&lt;-</span><span class="fu">head</span>(env_impact)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_env_impact, <span class="at">caption =</span> <span class="st">"Natural Gas Environmental Impact in the US Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Natural Gas Environmental Impact in the US Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: right;">co2_value</th>
<th style="text-align: right;">Consumption</th>
<th style="text-align: right;">Production</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: right;">1200.931</td>
<td style="text-align: right;">2561858</td>
<td style="text-align: right;">2035036</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: right;">138.000</td>
<td style="text-align: right;">2561858</td>
<td style="text-align: right;">2035036</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-02-01</td>
<td style="text-align: right;">120.689</td>
<td style="text-align: right;">2242986</td>
<td style="text-align: right;">1870546</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-03-01</td>
<td style="text-align: right;">118.592</td>
<td style="text-align: right;">2205787</td>
<td style="text-align: right;">2080504</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: right;">92.529</td>
<td style="text-align: right;">1724877</td>
<td style="text-align: right;">1979474</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: right;">81.622</td>
<td style="text-align: right;">1522613</td>
<td style="text-align: right;">2010625</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p><strong>(VAR) Prices(Henry Hub) ~ Imports + Production</strong></p>
<p>Prices at Henry Hub, imports, and production were chosen as endogenous variables for the VAR model to capture the interdependent dynamics within the natural gas market. Henry Hub prices are a benchmark for natural gas pricing and are influenced by changes in supply and demand, which are directly impacted by production levels and import volumes. By analyzing these variables together, the model can illustrate how fluctuations in production and imports directly affect prices, providing a comprehensive view of the supply-demand balance in the U.S. natural gas market.</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>price<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Henry_Hub_Natural_Gas_Spot_Price.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>price<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(price<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">subset</span>(price, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"price"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>imports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/imports.csv"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>imports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(imports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>imports <span class="ot">&lt;-</span> <span class="fu">subset</span>(imports, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(imports)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"imports"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>imports <span class="ot">&lt;-</span> imports[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"imports"</span>)]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is greater than 2004</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>imports <span class="ot">&lt;-</span> imports[<span class="fu">as.integer</span>(<span class="fu">format</span>(imports<span class="sc">$</span>Date, <span class="st">"%Y"</span>)) <span class="sc">&gt;</span> <span class="dv">2004</span>, ]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">subset</span>(production, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>supply_dynamics <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(imports, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(production, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>supply_dynamics <span class="ot">&lt;-</span> supply_dynamics[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(supply_dynamics))]</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(supply_dynamics), <span class="at">caption =</span> <span class="st">"Natural Gas Supply Dynamics in the US Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Natural Gas Supply Dynamics in the US Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">imports</th>
<th style="text-align: right;">Production</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: right;">6.15</td>
<td style="text-align: right;">405016</td>
<td style="text-align: right;">2035036</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-02-01</td>
<td style="text-align: right;">6.14</td>
<td style="text-align: right;">356495</td>
<td style="text-align: right;">1870546</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-03-01</td>
<td style="text-align: right;">6.96</td>
<td style="text-align: right;">379650</td>
<td style="text-align: right;">2080504</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: right;">7.16</td>
<td style="text-align: right;">326147</td>
<td style="text-align: right;">1979474</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: right;">6.47</td>
<td style="text-align: right;">333997</td>
<td style="text-align: right;">2010625</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-06-01</td>
<td style="text-align: right;">7.18</td>
<td style="text-align: right;">321710</td>
<td style="text-align: right;">1972975</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arimaxsarimax-modeling" class="level2">
<h2 class="anchored" data-anchor-id="arimaxsarimax-modeling">ARIMAX/SARIMAX Modeling</h2>
<section id="time-series-plot" class="level3">
<h3 class="anchored" data-anchor-id="time-series-plot">Time series plot</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(demand_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Factors Affecting Consumption Variations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph seems to illustrate a clear seasonal pattern in natural gas consumption, which is likely correlated with temperature variations. This pattern typically shows higher consumption during the colder months when temperatures are low, indicating heating demand is driving usage. The production of natural gas appears to trend upward over time, suggesting increased capacity or efficiency in production methods. Interestingly, while there’s seasonality in consumption that aligns with temperature changes, production doesn’t show a similar seasonal dip but instead a steady or possibly growing trend over the years. Storage levels also exhibit seasonality, with peaks presumably during times of lower consumption when excess production can be stored, and troughs when storage is drawn down during periods of high consumption.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(eco_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Macroeconomic Factors Affecting Natural Gas Prices"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph shows an unexpected trend between natural gas prices, U.S. GDP, and unemployment. Despite steady economic growth indicated by rising GDP, natural gas prices rise initially but then decline, suggesting influences from factors like technological advances or energy policy changes. The sharp increase in unemployment in 2020 leads to a significant drop in prices, indicating decreased demand. However, as the economy recovers and unemployment falls, prices begin to recover, reflecting a rebound in demand for natural gas.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(export_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Factors Affecting Variations in US Exports"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot shows that the growth of U.S. natural gas exports alongside factors like domestic consumption, foreign exchange rates, and the GDP of the Netherlands. It shows a steady increase in exports, reflecting the U.S.’s growing role in global energy markets. Domestic consumption follows a consistent cyclical pattern, suggesting seasonal variability in demand which doesn’t appear to directly impact the rising trend in exports. The foreign exchange rate exhibits fluctuations which could influence international trade dynamics, potentially making U.S. gas more or less attractive to foreign buyers depending on the strength of the dollar. Lastly, the GDP of the Netherlands, a significant importer, shows a steady rise, indicating economic growth that could correlate with increased demand for U.S. natural gas, aligning with the increase in exports.</p>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(env_impact_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Factors Affecting CO2 Emission Variations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>According to the graph CO2 emissions exhibit sharp, periodic spikes that could correlate with specific events or time periods—potentially seasonal changes in energy use. Natural gas consumption shows a fluctuating but consistent pattern, suggesting a regular, perhaps seasonal, variation—likely related to heating needs in winter and cooling in summer. Production, however, trends upward, indicating growing output over the years. Together, this plot shows consumption and production trends directly impact emission levels.</p>
</div>
</div>
</div>
</section>
<section id="automatic-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="automatic-model-fitting">Automatic Model Fitting</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>xreg_demand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">temperature =</span> demand_ts[, <span class="st">"temperature"</span>],</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span> demand_ts[, <span class="st">"Production"</span>],</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">storage =</span> demand_ts[, <span class="st">"storage"</span>] )</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>fit_demand <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(demand_ts[, <span class="st">"Consumption"</span>], <span class="at">xreg =</span> xreg_demand)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_demand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: demand_ts[, "Consumption"] 
Regression with ARIMA(0,0,2)(0,1,2)[12] errors 

Coefficients:
         ma1     ma2    sma1     sma2      drift  temperature  Production
      0.4825  0.2238  -0.723  -0.1183  2111.3781   -28006.454      0.2838
s.e.  0.0771  0.0638   0.081   0.0827   669.2816     2840.643      0.0732
      storage
      -0.0663
s.e.   0.0329

sigma^2 = 6.886e+09:  log likelihood = -2602.93
AIC=5223.86   AICc=5224.78   BIC=5253.72

Training set error measures:
                    ME     RMSE      MAE        MPE    MAPE     MASE
Training set -521.2747 79045.42 61595.38 -0.1426391 2.80638 0.526904
                    ACF1
Training set 0.003687805</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_demand, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,2)(0,1,2)[12] errors
Q* = 28.821, df = 20, p-value = 0.09135

Model df: 4.   Total lags used: 24</code></pre>
</div>
</div>
<p>Best model: ARIMA(0,0,2)(0,1,2)[12]</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>xreg_eco <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">gdp =</span> eco_ts[, <span class="st">"gdp"</span>],</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">unemp =</span> eco_ts[, <span class="st">"unemp"</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>fit_eco <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(eco_ts[, <span class="st">"price"</span>], <span class="at">xreg =</span> xreg_eco)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_eco)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: eco_ts[, "price"] 
Regression with ARIMA(0,1,0)(0,0,2)[4] errors 

Coefficients:
         sma1     sma2    drift    gdp   unemp
      -0.3273  -0.4984  -0.2165  1e-03  0.2079
s.e.   0.1632   0.2082   0.1129  7e-04  0.1730

sigma^2 = 1.141:  log likelihood = -105.07
AIC=222.15   AICc=223.46   BIC=235.72

Training set error measures:
                       ME     RMSE       MAE       MPE    MAPE      MASE
Training set -0.002765651 1.022808 0.7047353 -1.651351 15.3355 0.5172927
                    ACF1
Training set -0.03771922</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_eco, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,1,0)(0,0,2)[4] errors
Q* = 13.842, df = 6, p-value = 0.03145

Model df: 2.   Total lags used: 8</code></pre>
</div>
</div>
<p>Best model: ARIMA(0,1,0)(0,0,2)[4]</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>xreg_export <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">consumption =</span> export_ts[, <span class="st">"consumption"</span>],</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fx_rate =</span> export_ts[, <span class="st">"fx_rate"</span>],</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gdp_nl =</span> export_ts[, <span class="st">"gdp_nl"</span>] )</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>fit_export <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(export_ts[, <span class="st">"exports"</span>], <span class="at">xreg =</span> xreg_export)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_export)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: export_ts[, "exports"] 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  consumption    fx_rate  gdp_nl
      0.9682       0.0256  -2805.966  2.7013
s.e.  0.0280       0.0061   1423.789  0.7156

sigma^2 = 618599493:  log likelihood = -830.24
AIC=1670.48   AICc=1671.38   BIC=1681.86

Training set error measures:
                   ME     RMSE     MAE       MPE     MAPE      MASE       ACF1
Training set 631.4008 24170.91 15116.9 -3.351663 9.746448 0.4376682 -0.1334921</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_export, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(1,0,0) errors
Q* = 10.79, df = 7, p-value = 0.1481

Model df: 1.   Total lags used: 8</code></pre>
</div>
</div>
<p>Best model: ARIMA(1,0,0)</p>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>xreg_env_impact <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Consumption =</span> env_impact_ts[, <span class="st">"Consumption"</span>],</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span> env_impact_ts[, <span class="st">"Production"</span>] )</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>fit_env_impact <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(env_impact_ts[, <span class="st">"co2_value"</span>], <span class="at">xreg =</span> xreg_env_impact)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_env_impact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: env_impact_ts[, "co2_value"] 
Regression with ARIMA(0,0,1)(0,0,2)[12] errors 

Coefficients:
          ma1     sma1     sma2  intercept  Consumption  Production
      -0.6175  -0.3055  -0.5099  -248.4645        4e-04      -2e-04
s.e.   0.1470   0.1103   0.0763     6.0078        1e-04       0e+00

sigma^2 = 55394:  log likelihood = -1489.81
AIC=2993.62   AICc=2994.15   BIC=3017.24

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE      ACF1
Training set 5.983612 232.0674 162.3454 -19.40169 99.99742 0.7961153 0.1138366</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_env_impact, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,1)(0,0,2)[12] errors
Q* = 246.45, df = 21, p-value &lt; 2.2e-16

Model df: 3.   Total lags used: 24</code></pre>
</div>
</div>
<p>Best model: ARIMA(0,0,1)(0,0,2)[12]</p>
</div>
</div>
</div>
</section>
<section id="manual-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="manual-model-fitting">Manual Model Fitting</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>Consumption<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>Consumption,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>Production<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>Production,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>temperature<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>temperature,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>storage<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>storage,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>fit_demand.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Consumption <span class="sc">~</span> Production<span class="sc">+</span>temperature<span class="sc">+</span>storage, <span class="at">data=</span>demand)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_demand.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Consumption ~ Production + temperature + storage, 
    data = demand)

Residuals:
    Min      1Q  Median      3Q     Max 
-423377 -179561   -8729  202940  528191 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.289e+06  1.523e+05  15.031   &lt;2e-16 ***
Production   5.123e-01  2.859e-02  17.918   &lt;2e-16 ***
temperature -2.041e+04  1.054e+03 -19.366   &lt;2e-16 ***
storage     -4.938e-02  2.122e-02  -2.327   0.0209 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 225800 on 212 degrees of freedom
Multiple R-squared:  0.7787,    Adjusted R-squared:  0.7756 
F-statistic: 248.6 on 3 and 212 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_demand.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 172.11, df = 10, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The ACF plot suggests that there’s autocorrelation at certain lags that the model hasn’t accounted for.Residuals Distribution resemble a normal distribution, which is a good sign of model fit.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>eco<span class="sc">$</span>price<span class="ot">&lt;-</span><span class="fu">ts</span>(eco<span class="sc">$</span>price,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>eco<span class="sc">$</span>gdp<span class="ot">&lt;-</span><span class="fu">ts</span>(eco<span class="sc">$</span>gdp,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>eco<span class="sc">$</span>unemp<span class="ot">&lt;-</span><span class="fu">ts</span>(eco<span class="sc">$</span>unemp,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>fit_eco.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> gdp<span class="sc">+</span>unemp, <span class="at">data=</span>eco)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_eco.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ gdp + unemp, data = eco)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7756 -1.5938 -0.1842  0.7598  5.6088 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.385e+01  1.672e+00   8.285 6.02e-12 ***
gdp         -3.668e-04  6.976e-05  -5.259 1.54e-06 ***
unemp       -4.647e-01  1.157e-01  -4.017 0.000148 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.907 on 69 degrees of freedom
Multiple R-squared:  0.3164,    Adjusted R-squared:  0.2966 
F-statistic: 15.97 on 2 and 69 DF,  p-value: 2.001e-06</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_eco.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 49.407, df = 10, p-value = 3.43e-07</code></pre>
</div>
</div>
<p>The ACF plot does not display significant autocorrelation in the residuals, this generally indicates that the residuals are random, which is a sign of a good fit. The histogram shows some deviations from normality, especially with a skew towards the right.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>export<span class="sc">$</span>consumption<span class="ot">&lt;-</span><span class="fu">ts</span>(export<span class="sc">$</span>consumption,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>export<span class="sc">$</span>fx_rate<span class="ot">&lt;-</span><span class="fu">ts</span>(export<span class="sc">$</span>fx_rate,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>export<span class="sc">$</span>gdp_nl<span class="ot">&lt;-</span><span class="fu">ts</span>(export<span class="sc">$</span>gdp_nl,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fit_export.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(exports <span class="sc">~</span> consumption<span class="sc">+</span>fx_rate<span class="sc">+</span>gdp_nl, <span class="at">data=</span>export)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_export.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = exports ~ consumption + fx_rate + gdp_nl, data = export)

Residuals:
    Min      1Q  Median      3Q     Max 
-114272  -29193   -5976   19885  115631 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.476e+06  2.234e+05  -6.609 7.14e-09 ***
consumption  4.085e-02  1.622e-02   2.519   0.0141 *  
fx_rate      5.554e+03  2.097e+03   2.648   0.0101 *  
gdp_nl       5.956e+00  2.619e-01  22.742  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 45270 on 68 degrees of freedom
Multiple R-squared:  0.9298,    Adjusted R-squared:  0.9267 
F-statistic: 300.1 on 3 and 68 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_export.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 47.27, df = 10, p-value = 8.432e-07</code></pre>
</div>
</div>
<p>The ACF plot indicates significant autocorrelations at multiple lags. This is a strong indication that the model has not fully captured the autocorrelative structure of the data, and there may be additional lags or other dependencies that should be incorporated into the model. The shape of residual plot is also not perfectly symmetrical, indicating skewness in the distribution of residuals. Overall, the residuals exhibit some problematic features such as trends, heavy tails, skewness, and significant autocorrelation, all of which suggest that the current model could be improved to better fit the underlying dynamics of the data.</p>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>env_impact<span class="sc">$</span>co2_value<span class="ot">&lt;-</span><span class="fu">ts</span>(env_impact<span class="sc">$</span>co2_value,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>env_impact<span class="sc">$</span>Consumption<span class="ot">&lt;-</span><span class="fu">ts</span>(env_impact<span class="sc">$</span>Consumption,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>env_impact<span class="sc">$</span>Production<span class="ot">&lt;-</span><span class="fu">ts</span>(env_impact<span class="sc">$</span>Production,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>fit_env_impact.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(co2_value <span class="sc">~</span> Consumption<span class="sc">+</span>Production, <span class="at">data=</span>env_impact)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_env_impact.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = co2_value ~ Consumption + Production, data = env_impact)

Residuals:
    Min      1Q  Median      3Q     Max 
-446.15 -164.77   -5.79   50.29 1172.80 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.106e+02  1.046e+02  -2.969 0.003305 ** 
Consumption  4.164e-04  4.521e-05   9.209  &lt; 2e-16 ***
Production  -1.565e-04  4.225e-05  -3.703 0.000267 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 295.9 on 231 degrees of freedom
Multiple R-squared:  0.274, Adjusted R-squared:  0.2678 
F-statistic:  43.6 on 2 and 231 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_env_impact.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 90.652, df = 10, p-value = 3.977e-15</code></pre>
</div>
</div>
<p>ACF Plot suggests that there is little autocorrelation in the residuals, indicating that the model has accounted for the time series autocorrelation effectively.For the distribution of Residuals plot, while there’s a noticeable peak that aligns with the normal distribution, the long tails suggest the presence of outliers or extreme values that the model did not predict accurately.</p>
</div>
</div>
</div>
</section>
<section id="fitting-residuals" class="level3">
<h3 class="anchored" data-anchor-id="fitting-residuals">Fitting residuals</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>res.fit_demand<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_demand.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_demand,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_demand,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(res.fit_demand, <span class="at">lag =</span> <span class="dv">12</span>),<span class="at">main=</span><span class="st">"ACF Plot: Seasonality"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(<span class="fu">diff</span>(res.fit_demand, <span class="at">lag =</span> <span class="dv">12</span>),<span class="at">main=</span><span class="st">"PACF Plot: Seasonality"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>res.fit_eco<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_eco.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_eco,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_eco,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>res.fit_export<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_export.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_export,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_export,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>res.fit_env_impact<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_env_impact.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_env_impact,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_env_impact,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="finding-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="finding-model-parameters">Finding Model Parameters</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>p = 1,2,3,4</p>
<p>q = 1,2,3,4</p>
<p>P = 1</p>
<p>Q = 1,2,3</p>
<p>D = 1</p>
<p>d = 0</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,d1,d2,data){</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span>(d <span class="cf">in</span> d1<span class="sc">:</span>d2)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">10</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">4</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">4</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">3</span>,<span class="at">d1=</span><span class="dv">0</span>,<span class="at">d2=</span><span class="dv">0</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_demand.reg))</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC    BIC     AICc
38 3 0 2 0 1 0 5575.973 5599.6 5576.511</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC    BIC     AICc
38 3 0 2 0 1 0 5575.973 5599.6 5576.511</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC    BIC     AICc
38 3 0 2 0 1 0 5575.973 5599.6 5576.511</code></pre>
</div>
</div>
<p>Model 1 (Best Model) : ARIMA(3,0,2)(0,1,0)[12]</p>
<p>Model 2 (Auto Arima): ARIMA(0,0,2)(0,1,2)[12]</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>p = 1</p>
<p>q = 1,2,3,4</p>
<p>d = 0,1</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,data){</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">30</span>),<span class="at">nrow=</span><span class="dv">30</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)<span class="co">#</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)<span class="co">#</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p,d,q))</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>temp</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ARIMA.c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_eco.reg))</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q     AIC      BIC     AICc
8 0 1 3 227.575 236.6257 228.1811</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q     AIC      BIC   AICc
2 0 1 0 232.012 234.2747 232.07</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q     AIC      BIC     AICc
8 0 1 3 227.575 236.6257 228.1811</code></pre>
</div>
</div>
<p>Model 1 (Best Model) : ARIMA(0,1,3)</p>
<p>Model 2 (Second Best Model) : ARIMA(0,1,0)</p>
<p>Model 3 (Auto Arima): ARIMA(0,1,0)(0,0,2)[4]</p>
<p>Although Auto Arima have seasonal components, I opted for an ARIMA model over SARIMA based on manual analysis, which indicated that the seasonal components (P=0, D=0, Q=0) were unnecessary. This simpler ARIMA model aligns with the principle of parsimony, avoiding overfitting while adequately modeling the data without the inclusion of statistically insignificant seasonal terms.</p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>p = 1</p>
<p>q = 1,2,3,4</p>
<p>d = 0,1</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,data){</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">30</span>),<span class="at">nrow=</span><span class="dv">30</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)<span class="co">#</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)<span class="co">#</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p,d,q))</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>temp</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ARIMA.c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_export.reg))</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
14 1 1 1 1662.293 1669.081 1662.651</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
12 1 1 0 1664.272 1668.798 1664.449</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
14 1 1 1 1662.293 1669.081 1662.651</code></pre>
</div>
</div>
<p>Model 1 (Best Model) : ARIMA(1,1,1)</p>
<p>Model 2 (Second Best Model) : ARIMA(1,1,0)</p>
<p>Model 3 (Auto Arima): ARIMA(1,0,0)</p>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<p>p = 1,2,3</p>
<p>q = 1</p>
<p>d = 0,1</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,data){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">30</span>),<span class="at">nrow=</span><span class="dv">30</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)<span class="co">#</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)<span class="co">#</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p,d,q))</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>temp</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ARIMA.c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_env_impact.reg))</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC     BIC     AICc
3 2 0 1 3253.174 3270.45 3253.437</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 1 0 1 3253.988 3267.809 3254.162</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC     BIC     AICc
3 2 0 1 3253.174 3270.45 3253.437</code></pre>
</div>
</div>
<p>Model 1 (Best Model) : ARIMA(2,0,1)</p>
<p>Model 2 (Second Best Model) : ARIMA(1,0,1)</p>
<p>Model 3 (Auto Arima): ARIMA(0,0,1)(0,0,2)[12]</p>
<p>Although Auto Arima have seasonal components, I opted for an ARIMA model over SARIMA based on manual analysis, which indicated that the seasonal components (P=0, D=0, Q=0) were unnecessary. This simpler ARIMA model aligns with the principle of parsimony, avoiding overfitting while adequately modeling the data without the inclusion of statistically insignificant seasonal terms.</p>
</div>
</div>
</div>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Model 2</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>model_output_demand1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_demand, <span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_demand1[<span class="dv">98</span><span class="sc">:</span><span class="dv">109</span>], model_output_demand1[<span class="fu">length</span>(model_output_demand1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate        SE  t.value p.value
ar1        1.3989    0.0668  20.9360  0.0000
ar2       -1.2696    0.0804 -15.7986  0.0000
ar3        0.3892    0.0668   5.8256  0.0000
ma1       -1.0461    0.0267 -39.1784  0.0000
ma2        1.0000    0.0465  21.4826  0.0000
constant -48.3397 1169.8796  -0.0413  0.9671

sigma^2 estimated as 10343181207 on 198 degrees of freedom 
 
AIC = 25.99005  AICc = 25.99214  BIC = 26.10391 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>model_output_demand2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_demand, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_demand2[<span class="dv">28</span><span class="sc">:</span><span class="dv">38</span>], model_output_demand2[<span class="fu">length</span>(model_output_demand2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate       SE t.value p.value
ma1        0.4491   0.0717  6.2601  0.0000
ma2        0.2045   0.0598  3.4195  0.0008
sma1      -0.6976   0.0849 -8.2168  0.0000
sma2      -0.1778   0.0850 -2.0933  0.0376
constant 147.5125 200.8884  0.7343  0.4636

sigma^2 estimated as 7248694815 on 199 degrees of freedom 
 
AIC = 25.67953  AICc = 25.68102  BIC = 25.77712 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for both the models. The Q-Q plot suggest that the residuals are normally distributed for both the models.From the Ljung-Box Test, the p-values for model 2 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, model 2 has lower values indicating a better fit.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Model 3</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>model_output_eco1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_eco, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_eco1[<span class="dv">26</span><span class="sc">:</span><span class="dv">35</span>], model_output_eco1[<span class="fu">length</span>(model_output_eco1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
ma1       -0.0127 0.1180 -0.1077  0.9145
ma2       -0.3783 0.1036 -3.6520  0.0005
ma3       -0.1599 0.1054 -1.5164  0.1341
constant   0.0239 0.0636  0.3760  0.7081

sigma^2 estimated as 1.279842 on 67 degrees of freedom 
 
AIC = 3.231425  AICc = 3.239961  BIC = 3.390769 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>model_output_eco2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_eco, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_eco2[<span class="dv">10</span><span class="sc">:</span><span class="dv">17</span>], model_output_eco2[<span class="fu">length</span>(model_output_eco2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 
Coefficients: 
         Estimate    SE t.value p.value
constant   0.0469 0.145  0.3235  0.7473

sigma^2 estimated as 1.492206 on 70 degrees of freedom 
 
AIC = 3.294471  AICc = 3.295287  BIC = 3.358208 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>model_output_eco3 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_eco, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_eco3[<span class="dv">25</span><span class="sc">:</span><span class="dv">34</span>], model_output_eco3[<span class="fu">length</span>(model_output_eco3)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
sma1      -0.2987 0.1580 -1.8906  0.0629
sma2      -0.1484 0.1663 -0.8923  0.3754
constant   0.0241 0.0837  0.2876  0.7746

sigma^2 estimated as 1.392162 on 68 degrees of freedom 
 
AIC = 3.291319  AICc = 3.296364  BIC = 3.418794 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for model 1 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, model 1 has lower values indicating a better fit.</p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Model 3</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>model_output_export1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_export, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_export1[<span class="dv">152</span><span class="sc">:</span><span class="dv">161</span>], model_output_export1[<span class="fu">length</span>(model_output_export1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
           Estimate        SE  t.value p.value
ar1         -0.9703    0.0593 -16.3552  0.0000
ma1          0.8652    0.1209   7.1575  0.0000
constant -2972.9302 3131.5295  -0.9494  0.3458

sigma^2 estimated as 776009007 on 68 degrees of freedom 
 
AIC = 23.42813  AICc = 23.43317  BIC = 23.5556 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>model_output_export2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_export, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_export2[<span class="dv">20</span><span class="sc">:</span><span class="dv">28</span>], model_output_export2[<span class="fu">length</span>(model_output_export2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
           Estimate        SE t.value p.value
ar1         -0.2856    0.1138 -2.5099  0.0144
constant -2695.6108 2659.9601 -1.0134  0.3144

sigma^2 estimated as 824886684 on 69 degrees of freedom 
 
AIC = 23.45434  AICc = 23.45682  BIC = 23.54995 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>model_output_export3 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_export, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_export3[<span class="dv">27</span><span class="sc">:</span><span class="dv">35</span>], model_output_export3[<span class="fu">length</span>(model_output_export3)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
        Estimate         SE t.value p.value
ar1       0.7996     0.0804  9.9421  0.0000
xmean -1456.9356 16169.8092 -0.0901  0.9285

sigma^2 estimated as 838187240 on 70 degrees of freedom 
 
AIC = 23.48213  AICc = 23.48455  BIC = 23.57699 
 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for model 1 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, model 1 has lower values indicating a better fit.</p>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Model 3</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>model_output_env_impact1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_env_impact, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_env_impact1[<span class="dv">26</span><span class="sc">:</span><span class="dv">37</span>], model_output_env_impact1[<span class="fu">length</span>(model_output_env_impact1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 
Coefficients: 
      Estimate     SE  t.value p.value
ar1     0.1754 0.0847   2.0719  0.0394
ar2    -0.1298 0.0764  -1.6981  0.0908
ma1    -0.7776 0.0592 -13.1299  0.0000
xmean   0.0348 3.8214   0.0091  0.9927

sigma^2 estimated as 60969.9 on 230 degrees of freedom 
 
AIC = 13.90245  AICc = 13.9032  BIC = 13.97628 
 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>model_output_env_impact2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_env_impact, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_env_impact2[<span class="dv">29</span><span class="sc">:</span><span class="dv">37</span>], model_output_env_impact2[<span class="fu">length</span>(model_output_env_impact2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
      Estimate     SE  t.value p.value
ar1     0.2019 0.0801   2.5206  0.0124
ma1    -0.8249 0.0416 -19.8089  0.0000
xmean  -0.0189 3.6342  -0.0052  0.9958

sigma^2 estimated as 61720.43 on 231 degrees of freedom 
 
AIC = 13.90593  AICc = 13.90638  BIC = 13.965 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>model_output_env_impact3 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_env_impact, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_env_impact3[<span class="dv">38</span><span class="sc">:</span><span class="dv">47</span>], model_output_env_impact3[<span class="fu">length</span>(model_output_env_impact3)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
      Estimate     SE t.value p.value
ma1    -0.5051 0.1220 -4.1419  0.0000
sma1   -0.3161 0.1040 -3.0396  0.0026
sma2   -0.4309 0.0694 -6.2139  0.0000
xmean  -1.6697 2.6574 -0.6283  0.5304

sigma^2 estimated as 56381.74 on 230 degrees of freedom 
 
AIC = 13.86174  AICc = 13.86249  BIC = 13.93557 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for model 3.From the Ljung-Box Test, the p-values for model 1 and 2 are typically above 0.05 suggesting that the residuals are random, which is desirable in a good model fit. On comparing AIC, AICc, model 3 has lower values indicating a better fit.</p>
</div>
</div>
</div>
</section>
<section id="cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation">Cross Validation</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Model 1 (Best Model) : ARIMA(3,0,2)(0,1,0)[12]</p>
<p>Model 2 (Auto Arima): ARIMA(0,0,2)(0,1,2)[12]</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_demand</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">124</span><span class="co"># first training set length </span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:SARIMA(3,0,2)x(0,1,0)"</span>,<span class="st">"Fit2:SARIMA(0,0,2)x(0,1,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:SARIMA(3,0,2)x(0,1,0)"</span>,<span class="st">"Fit2:SARIMA(0,0,2)x(0,1,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fit2:SARIMA(0,0,2)x(0,1,2) is better as it has lower MSE and RMSE.</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_eco</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">51</span><span class="co"># first training set length </span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">4</span>),</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb111-52"><a href="#cb111-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb111-53"><a href="#cb111-53" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(0,1,3)"</span>,<span class="st">"Fit2:ARIMA(0,1,0)"</span>,<span class="st">"Fit3:ARIMA(0,1,0)(0,0,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(0,1,3)"</span>,<span class="st">"Fit2:ARIMA(0,1,0)"</span>,<span class="st">"Fit3:ARIMA(0,1,0)(0,0,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fit2:ARIMA(0,1,0) is better as it has overall lower MSE and RMSE.</p>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_export</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">51</span><span class="co"># first training set length </span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(1,1,1)"</span>,<span class="st">"Fit2:ARIMA(1,1,0)"</span>,<span class="st">"Fit3:ARIMA(1,0,0)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(1,1,1)"</span>,<span class="st">"Fit2:ARIMA(1,1,0)"</span>,<span class="st">"Fit3:ARIMA(1,0,0)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fit3:ARIMA(1,0,0) is better as it has overall lower MSE and RMSE.</p>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_env_impact</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(2,0,1)"</span>,<span class="st">"Fit2:ARIMA(1,0,1)"</span>,<span class="st">"Fit3:ARIMA(0,0,1)(0,0,2)[12]"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(2,0,1)"</span>,<span class="st">"Fit2:ARIMA(1,0,1)"</span>,<span class="st">"Fit3:ARIMA(0,0,1)(0,0,2)[12]"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fit1:ARIMA(2,0,1) is better as it has overall lower MSE and RMSE.</p>
</div>
</div>
</div>
</section>
<section id="final-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="final-model-fitting">Final Model Fitting</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>xreg_demand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">temperature =</span> demand_ts[, <span class="st">"temperature"</span>], <span class="at">Production =</span> demand_ts[, <span class="st">"Production"</span>],</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">storage =</span>  demand_ts[, <span class="st">"storage"</span>])</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>fit_demand_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(demand_ts[, <span class="st">"Consumption"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">xreg=</span>xreg_demand)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_demand_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: demand_ts[, "Consumption"] 
Regression with ARIMA(0,0,2)(0,1,2)[12] errors 

Coefficients:
         ma1     ma2     sma1     sma2  temperature  Production  storage
      0.4815  0.2300  -0.6999  -0.1436   -30050.877      0.5029  -0.0279
s.e.  0.0773  0.0636   0.0812   0.0815     2826.539      0.0263   0.0310

sigma^2 = 7.188e+09:  log likelihood = -2607.83
AIC=5231.66   AICc=5232.4   BIC=5258.21

Training set error measures:
                   ME     RMSE     MAE       MPE     MAPE      MASE
Training set 6183.833 80968.66 63415.8 0.1870671 2.888607 0.5424765
                     ACF1
Training set -0.000946875</code></pre>
</div>
</div>
<p><strong>Model_Equation</strong></p>
<p>
    <span class="math display">
        \(consumption_{t} = \mu+0.4815\varepsilon_{t-1} +0.2300\varepsilon_{t-2}−0.6999\varepsilon_{t-12}−0.1436\varepsilon_{t-24} \)<br>
        \(−30050.877temperature_t+0.5029Production_t−0.0279Storage_t+\varepsilon_t\)
    </span>
</p>

</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>xreg_eco <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="at">gdp =</span>  eco_ts[, <span class="st">"gdp"</span>],<span class="at">unemp =</span> eco_ts[, <span class="st">"unemp"</span>])</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>fit_eco_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(eco_ts[, <span class="st">"price"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">xreg=</span>xreg_eco)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_eco_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: eco_ts[, "price"] 
Regression with ARIMA(0,1,0) errors 

Coefficients:
        gdp    unemp
      2e-04  -0.0586
s.e.  6e-04   0.1777

sigma^2 = 1.395:  log likelihood = -111.55
AIC=229.1   AICc=229.46   BIC=235.89

Training set error measures:
                      ME     RMSE       MAE      MPE     MAPE      MASE
Training set -0.04566038 1.156305 0.7787039 -2.88408 16.12788 0.5715875
                  ACF1
Training set 0.1185369</code></pre>
</div>
</div>
<p><strong>Model_Equation</strong></p>
<p><span class="math inline">\(price_{t} = \mu+ (2e-04)gdp_t-0.0586unemp_t+\varepsilon_t\)</span></p>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>xreg_export <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">consumption =</span>  export_ts[, <span class="st">"consumption"</span>],<span class="at">fx_rate =</span> export_ts[, <span class="st">"fx_rate"</span>],<span class="at">gdp_nl =</span> export_ts[, <span class="st">"gdp_nl"</span>])</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>fit_export_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(export_ts[, <span class="st">"exports"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">xreg=</span>xreg_export)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_export_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: export_ts[, "exports"] 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  intercept  consumption    fx_rate  gdp_nl
      0.9658  -66757.46       0.0257  -2370.611  2.7993
s.e.  0.0323  327974.10       0.0061   2505.615  0.8929

sigma^2 = 628058050:  log likelihood = -830.22
AIC=1672.43   AICc=1673.72   BIC=1686.09

Training set error measures:
                   ME     RMSE     MAE       MPE     MAPE     MASE       ACF1
Training set 631.1364 24175.25 14983.5 -3.316443 9.583512 0.433806 -0.1389813</code></pre>
</div>
</div>
<p><strong>Model_Equation</strong></p>
<p>
    <span class="math display">
        \(exports_{t} = -66757.46+0.9658\varepsilon_{t-1} +0.0257consumption_t \)<br>
        \(-2370.611fxrate_t+2.7993gdpnl_t+\varepsilon_t\)
    </span>
</p>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>xreg_env_impact <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Consumption =</span> env_impact_ts[, <span class="st">"Consumption"</span>],</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span>  env_impact_ts[, <span class="st">"Production"</span>])</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>fit_env_impact_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(env_impact_ts[, <span class="st">"co2_value"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xreg=</span>xreg_env_impact)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_env_impact_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: env_impact_ts[, "co2_value"] 
Regression with ARIMA(2,0,1) errors 

Coefficients:
         ar1      ar2      ma1  intercept  Consumption  Production
      0.2072  -0.1185  -0.8299  -247.0346        4e-04      -1e-04
s.e.  0.0782   0.0775   0.0410    16.4180        0e+00       1e-04

sigma^2 = 61520:  log likelihood = -1494.9
AIC=3003.79   AICc=3004.33   BIC=3027.42

Training set error measures:
                   ME    RMSE      MAE       MPE     MAPE      MASE        ACF1
Training set 1.732973 244.563 150.1234 -41.40206 80.50691 0.7361805 0.001927893</code></pre>
</div>
</div>
<p><strong>Model_Equation</strong></p>
<p>
    <span class="math display">
        \(co2emissions_{t} = -247.0346 +0.2072\varepsilon_{t-1} -0.1185 \varepsilon_{t-2}-0.8299\varepsilon_{t-12} \)<br>
        \(+(4e-04) consumption_t-(1e-04)production_t+\varepsilon_t\)
    </span>
</p>
</div>
</div>
</div>
</section>
<section id="forecasting" class="level3">
<h3 class="anchored" data-anchor-id="forecasting">Forecasting</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Natural gas demand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Econometric Dynamics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Exports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">CO2 Emissions</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the temperature variable</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>temperature_fit_demand<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(demand<span class="sc">$</span>temperature) </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>ftemperature_demand<span class="ot">&lt;-</span><span class="fu">forecast</span>(temperature_fit_demand)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(temperature_fit_demand) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: demand$temperature 
ARIMA(1,0,1)(2,1,2)[12] 

Coefficients:
         ar1      ma1    sar1     sar2     sma1    sma2
      0.8966  -0.7705  0.1582  -0.3150  -1.0719  0.1859
s.e.  0.0785   0.1071  0.2699   0.0796   0.2711  0.2780

sigma^2 = 3.645:  log likelihood = -430.92
AIC=875.84   AICc=876.41   BIC=899.06

Training set error measures:
                     ME     RMSE      MAE        MPE    MAPE      MASE
Training set 0.05894715 1.827797 1.374266 -0.1026046 3.04484 0.6512202
                    ACF1
Training set -0.02248767</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the Production variable</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>Production_fit_demand<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(demand<span class="sc">$</span>Production) </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>fProduction_demand<span class="ot">&lt;-</span><span class="fu">forecast</span>(Production_fit_demand)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Production_fit_demand) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: demand$Production 
ARIMA(0,1,1)(1,1,1)[12] 

Coefficients:
          ma1     sar1     sma1
      -0.2318  -0.1148  -0.6329
s.e.   0.0806   0.0976   0.0785

sigma^2 = 3.033e+09:  log likelihood = -2506.58
AIC=5021.16   AICc=5021.36   BIC=5034.41

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE      ACF1
Training set 2289.614 52995.22 34932.59 0.07971598 1.319548 0.2680922 0.0231852</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the storage variable</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>storage_fit_demand<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(demand<span class="sc">$</span>storage) </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>fstorage_demand<span class="ot">&lt;-</span><span class="fu">forecast</span>(storage_fit_demand)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(storage_fit_demand) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: demand$storage 
ARIMA(2,0,1)(2,1,1)[12] 

Coefficients:
         ar1      ar2      ma1    sar1     sar2     sma1
      1.6807  -0.7070  -0.6125  0.0847  -0.3563  -0.8757
s.e.  0.1948   0.1852   0.2243  0.0812   0.0780   0.0837

sigma^2 = 9.631e+09:  log likelihood = -2644.73
AIC=5303.46   AICc=5304.03   BIC=5326.68

Training set error measures:
                   ME     RMSE      MAE       MPE    MAPE      MASE        ACF1
Training set 12403.42 93960.96 70783.51 0.1578639 1.02821 0.1939838 -0.01086143</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast Natural gas demand using feature variables</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>fxreg_demand_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">temperature =</span> ftemperature_demand<span class="sc">$</span>mean, <span class="at">Production =</span> fProduction_demand<span class="sc">$</span>mean,</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">storage =</span> fstorage_demand<span class="sc">$</span>mean)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>fcast_demand_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_demand_ts, <span class="at">xreg=</span>fxreg_demand_ts) </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_demand_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Consumption"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Findings:</strong> The data shows pronounced seasonal patterns, with sharp peaks and troughs occurring regularly each year. This pattern suggests strong seasonal influences on consumption.The amplitude of the seasonal fluctuations appears to be relatively stable over time, indicating consistent seasonal effects across the years. The forecast continues the pattern of seasonal peaks and troughs observed in the historical data, indicating that the model expects future behavior to be similar to past behavior.</p>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the unemp variable</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>unemp_fit_eco<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(eco<span class="sc">$</span>unemp) </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>funemp_eco<span class="ot">&lt;-</span><span class="fu">forecast</span>(unemp_fit_eco)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(unemp_fit_eco) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: eco$unemp 
ARIMA(0,1,0) 

sigma^2 = 1.615:  log likelihood = -117.76
AIC=237.52   AICc=237.58   BIC=239.78

Training set error measures:
                      ME     RMSE       MAE       MPE     MAPE      MASE
Training set -0.02395417 1.261955 0.4446569 -1.600193 5.992066 0.3438721
                   ACF1
Training set -0.1753812</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the GDP variable</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>gdp_fit_eco<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(eco<span class="sc">$</span>gdp) </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>fgdp_eco<span class="ot">&lt;-</span><span class="fu">forecast</span>(gdp_fit_eco)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gdp_fit_eco) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: eco$gdp 
ARIMA(0,2,1) 

Coefficients:
          ma1
      -0.9320
s.e.   0.0502

sigma^2 = 123648:  log likelihood = -510.22
AIC=1024.44   AICc=1024.61   BIC=1028.93

Training set error measures:
                   ME     RMSE     MAE       MPE      MAPE     MASE       ACF1
Training set 33.78236 344.2332 154.266 0.1181144 0.8012411 0.185697 -0.1468472</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast price using feature variables</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>fxreg_eco_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">gdp =</span> fgdp_eco<span class="sc">$</span>mean,</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">unemp=</span>funemp_eco<span class="sc">$</span>mean)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>fcast_eco_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_eco_ts, <span class="at">xreg=</span>fxreg_eco_ts) </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_eco_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prices influenced by macroeconomic factors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Findings:</strong> The time series shows significant fluctuations and a couple of sharp peaks, particularly notable around the years 2005, 2010, and 2020. These peaks indicates market disruptions impacting the prices modeled. The general trend between the peaks appears relatively stable or slowly declining, especially from around 2010 to 2015 and stabilizing with slight fluctuations thereafter until 2020. The forecast suggests a potential continuation of the recent trend seen just before 2022, which appears to be upward, suggesting an expectation of rising prices influenced by macroeconomic factors.</p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the consumption variable</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>consumption_fit_export<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(export<span class="sc">$</span>consumption) </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>fconsumption_export<span class="ot">&lt;-</span><span class="fu">forecast</span>(consumption_fit_export)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(consumption_fit_export) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: export$consumption 
ARIMA(0,0,1)(2,1,1)[4] with drift 

Coefficients:
         ma1    sar1     sar2     sma1       drift
      0.6381  0.1587  -0.4543  -0.7347  12841.9715
s.e.  0.1188  0.1279   0.1171   0.1216    886.8046

sigma^2 = 5.066e+09:  log likelihood = -857.01
AIC=1726.02   AICc=1727.4   BIC=1739.34

Training set error measures:
                    ME     RMSE      MAE        MPE    MAPE      MASE
Training set -4520.991 66581.18 52819.52 -0.3773109 2.46093 0.5640389
                    ACF1
Training set -0.04919122</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the exchange rate variable</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>fx_rate_fit_export<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(export<span class="sc">$</span>fx_rate) </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>ffx_rate_export<span class="ot">&lt;-</span><span class="fu">forecast</span>(fx_rate_fit_export)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fx_rate_fit_export) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: export$fx_rate 
ARIMA(0,1,0) 

sigma^2 = 1.4:  log likelihood = -112.69
AIC=227.38   AICc=227.44   BIC=229.64

Training set error measures:
                      ME     RMSE       MAE         MPE      MAPE      MASE
Training set -0.04918699 1.175063 0.9309056 -0.05457483 0.9354786 0.5015178
                  ACF1
Training set 0.1887399</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the GDP variable</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>gdp_nl_fit_export<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(export<span class="sc">$</span>gdp_nl) </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>fgdp_nl_export<span class="ot">&lt;-</span><span class="fu">forecast</span>(gdp_nl_fit_export)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gdp_nl_fit_export) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: export$gdp_nl 
ARIMA(0,2,1) 

Coefficients:
          ma1
      -0.8849
s.e.   0.0659

sigma^2 = 1.1e+07:  log likelihood = -667.05
AIC=1338.09   AICc=1338.27   BIC=1342.59

Training set error measures:
                   ME   RMSE     MAE        MPE      MAPE      MASE       ACF1
Training set 245.7257 3246.4 1565.21 0.08137514 0.8394132 0.2156717 -0.1191757</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast export using feature variables</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>fxreg_export_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">consumption =</span> fconsumption_export<span class="sc">$</span>mean,</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">fx_rate=</span>ffx_rate_export<span class="sc">$</span>mean,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">gdp_nl=</span>fgdp_nl_export<span class="sc">$</span>mean )</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>fcast_export_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_export_ts, <span class="at">xreg=</span>fxreg_export_ts) </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_export_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Exports"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Findings:</strong> There’s a clear upward trend in the exports from around 2005 to approximately 2022. This suggests growth over these years.There is a particularly sharp increase in exports around the years 2015 through 2022, indicating a period of significant growth. Overall, the forecast suggests optimism about the future direction of exports, albeit with growing uncertainty as predictions extend further into the future.</p>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the Consumption variable</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>Consumption_fit_env_impact<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(env_impact<span class="sc">$</span>Consumption) </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>fConsumption_env_impact<span class="ot">&lt;-</span><span class="fu">forecast</span>(Consumption_fit_env_impact)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Consumption_fit_env_impact) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: env_impact$Consumption 
ARIMA(1,1,1)(1,0,2)[12] 

Coefficients:
         ar1      ma1    sar1    sma1    sma2
      0.6145  -0.9779  0.1611  0.6208  0.4307
s.e.  0.0639   0.0110  0.1453  0.1250  0.0806

sigma^2 = 4.605e+10:  log likelihood = -3193.85
AIC=6399.71   AICc=6400.08   BIC=6420.41

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set 14612.77 211822.9 174026.2 -0.5983582 7.724336 0.7300607
                   ACF1
Training set 0.07045743</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the Production variable</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>Production_fit_env_impact<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(env_impact<span class="sc">$</span>Production) </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>fProduction_env_impact<span class="ot">&lt;-</span><span class="fu">forecast</span>(Production_fit_env_impact)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Production_fit_env_impact) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: env_impact$Production 
ARIMA(0,1,1)(0,0,1)[12] with drift 

Coefficients:
          ma1     sma1     drift
      -0.5927  -0.3839  7708.609
s.e.   0.0704   0.0857  1646.643

sigma^2 = 9.379e+09:  log likelihood = -3005.32
AIC=6018.64   AICc=6018.81   BIC=6032.44

Training set error measures:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set -1087.363 96013.37 70250.08 -0.2407207 2.667694 0.4658773
                   ACF1
Training set 0.01137183</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast co2 emmisions using feature variables</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>fxreg_env_impact_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Consumption =</span> fConsumption_env_impact<span class="sc">$</span>mean,</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span> fProduction_env_impact<span class="sc">$</span>mean)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>fcast_env_impact_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_env_impact_ts, <span class="at">xreg=</span>fxreg_env_impact_ts) </span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_env_impact_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"CO2 Emissions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Findings:</strong> The best model forecast maintains the seasonal pattern, but with a diminishing intensity compared to the observed trend. However, the observed trend line depicts a growing intensity, suggesting that this model may not fully capture the trend. This discrepancy indicates that the chosen exogenous variables alone might not exert a significant influence on CO2 emissions, suggesting additional regressors for a more comprehensive analysis</p>
</div>
</div>
</div>
</section>
</section>
<section id="var-modeling" class="level2">
<h2 class="anchored" data-anchor-id="var-modeling">VAR Modeling</h2>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">cbind</span>(<span class="at">price=</span>price[, <span class="sc">-</span><span class="dv">1</span>] , <span class="at">production=</span>production[, <span class="sc">-</span><span class="dv">1</span>] , <span class="at">imports=</span>imports[, <span class="sc">-</span><span class="dv">1</span>] ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>data_no_date <span class="ot">&lt;-</span> supply_dynamics[, <span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(data_no_date), <span class="at">method=</span><span class="st">'color'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-89-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plots above display the relationships between price, production, and imports using scatter plots and correlation matrices. The scatter plots show potential nonlinear relationships among the variables, particularly between imports and the other two variables, while the correlation matrix reveals strong negative correlations between production and imports, and moderate correlations between prices and the other variables.</p>
<section id="time-series-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="time-series-plot-1">Time series plot</h3>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>price_ts <span class="ot">=</span> <span class="fu">ts</span>(price<span class="sc">$</span>price, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # storage_ts = ts(storage$storage, start = 2005,end = c(2022,12),frequency = 12)</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # exports_ts = ts(exports$exports, start = 2005,end = c(2022,12),frequency = 12)</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>imports_ts <span class="ot">=</span> <span class="fu">ts</span>(imports<span class="sc">$</span>imports, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # temp_ts = ts(temperature$temperature, start = 2005,end = c(2022,12),frequency = 12)</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>production_ts <span class="ot">=</span> <span class="fu">ts</span>(production<span class="sc">$</span>Production, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine precipitation and temp</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>supply <span class="ot">=</span> <span class="fu">cbind</span>(price_ts,imports_ts,production_ts)</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(supply) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"price"</span>, <span class="st">"imports"</span>,<span class="st">"production"</span>)</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="co"># supply.ts&lt;-ts(supply_dynamics,star=decimal_date(as.Date("2005-01-01",format = "%Y-%m-%d")),frequency = 12)</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(supply, <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Supply Dynamics in the US"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot depicts the dynamics of U.S. natural gas prices, imports, and production over time. Prices experienced significant fluctuations, particularly with notable peaks around 2005 and 2008, stabilizing and then increasing gradually post-2015, reflecting market conditions and economic factors. Imports show a general decline from 2005 until 2012, stabilizing afterward, suggesting increased self-sufficiency in domestic production or shifts in energy policy. Production consistently rose from 2005, indicating advances in extraction technologies like hydraulic fracturing.</p>
</section>
<section id="finding-best-p" class="level3">
<h3 class="anchored" data-anchor-id="finding-best-p">Finding Best p</h3>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(supply, <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
     6      3      2      6 

$criteria
                  1            2            3            4            5
AIC(n) 4.280098e+01 4.249361e+01 4.238072e+01 4.238209e+01 4.229855e+01
HQ(n)  4.289898e+01 4.265041e+01 4.259632e+01 4.265650e+01 4.263176e+01
SC(n)  4.304330e+01 4.288132e+01 4.291382e+01 4.306059e+01 4.312244e+01
FPE(n) 3.874727e+18 2.849641e+18 2.545913e+18 2.550249e+18 2.347020e+18
                  6            7            8            9           10
AIC(n) 4.223640e+01 4.229797e+01 4.233180e+01 4.231287e+01 4.228915e+01
HQ(n)  4.262841e+01 4.274878e+01 4.284141e+01 4.288129e+01 4.291637e+01
SC(n)  4.320569e+01 4.341265e+01 4.359187e+01 4.371834e+01 4.384001e+01
FPE(n) 2.207172e+18 2.349597e+18 2.433487e+18 2.391663e+18 2.340185e+18</code></pre>
</div>
</div>
<p>According to the selection criterion, p = 2, 3 and 6.Therefore, I’m fitting several models with p=1(for simplicity), 2, 3 and 6.=&gt; VAR(1), VAR(2), VAR(3), VAR(6)</p>
</section>
<section id="var-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="var-model-fitting">VAR model fitting</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">VAR(1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">VAR(2)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">VAR(3)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">VAR(6)</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: price, imports, production 
Deterministic variables: both 
Sample size: 215 
Log Likelihood: -5516.817 
Roots of the characteristic polynomial:
0.9266 0.725 0.4645
Call:
vars::VAR(y = supply, p = 1, type = "both")


Estimation results for equation price: 
====================================== 
price = price.l1 + imports.l1 + production.l1 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       8.913e-01  3.164e-02  28.175   &lt;2e-16 ***
imports.l1     7.834e-07  1.761e-06   0.445   0.6568    
production.l1  7.985e-07  3.974e-07   2.009   0.0458 *  
const         -9.641e-01  7.503e-01  -1.285   0.2002    
trend         -8.060e-03  4.058e-03  -1.986   0.0483 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.7977 on 210 degrees of freedom
Multiple R-Squared: 0.884,  Adjusted R-squared: 0.8818 
F-statistic: 400.2 on 4 and 210 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation imports: 
======================================== 
imports = price.l1 + imports.l1 + production.l1 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       2.603e+03  9.709e+02   2.681  0.00792 ** 
imports.l1     6.790e-01  5.404e-02  12.565  &lt; 2e-16 ***
production.l1 -9.263e-03  1.220e-02  -0.759  0.44843    
const          1.099e+05  2.303e+04   4.773  3.4e-06 ***
trend         -8.361e+01  1.246e+02  -0.671  0.50279    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 24480 on 210 degrees of freedom
Multiple R-Squared: 0.8168, Adjusted R-squared: 0.8133 
F-statistic:   234 on 4 and 210 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation production: 
=========================================== 
production = price.l1 + imports.l1 + production.l1 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       1.924e+04  4.654e+03   4.135 5.13e-05 ***
imports.l1    -6.366e-01  2.590e-01  -2.458   0.0148 *  
production.l1  5.458e-01  5.846e-02   9.337  &lt; 2e-16 ***
const          8.823e+05  1.104e+05   7.994 8.58e-14 ***
trend          3.814e+03  5.970e+02   6.388 1.06e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 117300 on 210 degrees of freedom
Multiple R-Squared: 0.9548, Adjusted R-squared: 0.9539 
F-statistic:  1108 on 4 and 210 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                price   imports production
price          0.6363 2.630e+03 -9.141e+03
imports     2630.1653 5.994e+08  1.170e+09
production -9141.4090 1.170e+09  1.377e+10

Correlation matrix of residuals:
              price imports production
price       1.00000  0.1347   -0.09767
imports     0.13469  1.0000    0.40742
production -0.09767  0.4074    1.00000</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: price, imports, production 
Deterministic variables: both 
Sample size: 214 
Log Likelihood: -5453.452 
Roots of the characteristic polynomial:
0.9452 0.7807 0.5786 0.5043 0.5043 0.035
Call:
vars::VAR(y = supply, p = 2, type = "both")


Estimation results for equation price: 
====================================== 
price = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       9.038e-01  7.077e-02  12.771   &lt;2e-16 ***
imports.l1    -2.306e-06  2.541e-06  -0.908   0.3652    
production.l1  1.288e-06  5.221e-07   2.467   0.0144 *  
price.l2      -1.973e-02  7.162e-02  -0.275   0.7832    
imports.l2     4.412e-06  2.571e-06   1.716   0.0876 .  
production.l2 -5.638e-07  5.054e-07  -1.115   0.2659    
const         -1.260e+00  8.685e-01  -1.451   0.1484    
trend         -6.651e-03  4.562e-03  -1.458   0.1464    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.799 on 206 degrees of freedom
Multiple R-Squared: 0.8856, Adjusted R-squared: 0.8817 
F-statistic: 227.8 on 7 and 206 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation imports: 
======================================== 
imports = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1      -4.062e+02  2.101e+03  -0.193  0.84689    
imports.l1     7.862e-01  7.543e-02  10.422  &lt; 2e-16 ***
production.l1 -4.679e-02  1.550e-02  -3.019  0.00286 ** 
price.l2       2.775e+03  2.126e+03   1.305  0.19333    
imports.l2    -1.385e-01  7.631e-02  -1.814  0.07106 .  
production.l2  6.029e-02  1.500e-02   4.018 8.23e-05 ***
const          8.410e+04  2.578e+04   3.262  0.00129 ** 
trend         -3.037e+02  1.354e+02  -2.242  0.02602 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 23720 on 206 degrees of freedom
Multiple R-Squared: 0.8296, Adjusted R-squared: 0.8238 
F-statistic: 143.3 on 7 and 206 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation production: 
=========================================== 
production = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       9.868e+03  9.102e+03   1.084 0.279554    
imports.l1    -1.109e+00  3.268e-01  -3.393 0.000828 ***
production.l1  3.528e-01  6.715e-02   5.254 3.70e-07 ***
price.l2       2.021e+03  9.211e+03   0.219 0.826584    
imports.l2     7.242e-01  3.306e-01   2.191 0.029598 *  
production.l2  4.110e-01  6.501e-02   6.323 1.56e-09 ***
const          4.658e+05  1.117e+05   4.170 4.49e-05 ***
trend          2.040e+03  5.868e+02   3.476 0.000620 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 102800 on 206 degrees of freedom
Multiple R-Squared: 0.9656, Adjusted R-squared: 0.9645 
F-statistic: 827.3 on 7 and 206 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                price   imports production
price          0.6384      3069 -9.385e+03
imports     3069.0047 562578817  9.051e+08
production -9384.9999 905147602  1.056e+10

Correlation matrix of residuals:
             price imports production
price       1.0000  0.1619    -0.1143
imports     0.1619  1.0000     0.3714
production -0.1143  0.3714     1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: price, imports, production 
Deterministic variables: both 
Sample size: 213 
Log Likelihood: -5406.267 
Roots of the characteristic polynomial:
0.9536 0.8361 0.6128 0.6128 0.5083 0.5083 0.3599 0.3599 0.3447
Call:
vars::VAR(y = supply, p = 3, type = "both")


Estimation results for equation price: 
====================================== 
price = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + price.l3 + imports.l3 + production.l3 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       8.917e-01  7.168e-02  12.440   &lt;2e-16 ***
imports.l1    -1.274e-06  2.609e-06  -0.488   0.6258    
production.l1  1.388e-06  5.930e-07   2.340   0.0202 *  
price.l2       1.107e-01  9.688e-02   1.143   0.2544    
imports.l2     1.664e-06  3.504e-06   0.475   0.6353    
production.l2 -4.726e-09  6.083e-07  -0.008   0.9938    
price.l3      -1.352e-01  7.181e-02  -1.882   0.0612 .  
imports.l3     2.785e-06  2.683e-06   1.038   0.3006    
production.l3 -7.842e-07  5.563e-07  -1.410   0.1601    
const         -1.321e+00  9.176e-01  -1.439   0.1516    
trend         -5.180e-03  4.833e-03  -1.072   0.2851    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.7963 on 202 degrees of freedom
Multiple R-Squared: 0.888,  Adjusted R-squared: 0.8824 
F-statistic: 160.1 on 10 and 202 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation imports: 
======================================== 
imports = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + price.l3 + imports.l3 + production.l3 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1      -1.095e+03  2.132e+03  -0.514  0.60815    
imports.l1     8.251e-01  7.760e-02  10.632  &lt; 2e-16 ***
production.l1 -5.559e-02  1.764e-02  -3.151  0.00187 ** 
price.l2       4.689e+03  2.882e+03   1.627  0.10526    
imports.l2    -2.799e-01  1.042e-01  -2.685  0.00785 ** 
production.l2  7.624e-02  1.809e-02   4.214 3.78e-05 ***
price.l3      -1.600e+03  2.136e+03  -0.749  0.45477    
imports.l3     1.493e-01  7.981e-02   1.871  0.06282 .  
production.l3 -9.481e-03  1.655e-02  -0.573  0.56728    
const          7.338e+04  2.729e+04   2.688  0.00778 ** 
trend         -2.541e+02  1.438e+02  -1.768  0.07862 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 23680 on 202 degrees of freedom
Multiple R-Squared: 0.8307, Adjusted R-squared: 0.8223 
F-statistic: 99.09 on 10 and 202 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation production: 
=========================================== 
production = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + price.l3 + imports.l3 + production.l3 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       3.602e+03  8.557e+03   0.421  0.67420    
imports.l1    -8.520e-01  3.115e-01  -2.735  0.00678 ** 
production.l1  1.495e-01  7.080e-02   2.112  0.03589 *  
price.l2       8.793e+03  1.157e+04   0.760  0.44799    
imports.l2    -4.815e-01  4.183e-01  -1.151  0.25111    
production.l2  4.667e-01  7.262e-02   6.427 9.19e-10 ***
price.l3      -3.848e+03  8.572e+03  -0.449  0.65399    
imports.l3     1.282e+00  3.203e-01   4.002 8.81e-05 ***
production.l3  1.953e-01  6.641e-02   2.940  0.00366 ** 
const          2.840e+05  1.095e+05   2.592  0.01023 *  
trend          1.867e+03  5.770e+02   3.236  0.00142 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 95060 on 202 degrees of freedom
Multiple R-Squared: 0.971,  Adjusted R-squared: 0.9696 
F-statistic: 676.9 on 10 and 202 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
               price   imports production
price          0.634      2831      -9707
imports     2831.428 560974632  820222971
production -9706.961 820222971 9035981970

Correlation matrix of residuals:
             price imports production
price       1.0000  0.1501    -0.1282
imports     0.1501  1.0000     0.3643
production -0.1282  0.3643     1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">6</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: price, imports, production 
Deterministic variables: both 
Sample size: 210 
Log Likelihood: -5288.235 
Roots of the characteristic polynomial:
0.9711 0.8957 0.8762 0.8762 0.7918 0.7918 0.7909 0.7909 0.782 0.782 0.7731 0.6454 0.6454 0.5766 0.5766 0.5092 0.5092 0.2999
Call:
vars::VAR(y = supply, p = 6, type = "both")


Estimation results for equation price: 
====================================== 
price = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + price.l3 + imports.l3 + production.l3 + price.l4 + imports.l4 + production.l4 + price.l5 + imports.l5 + production.l5 + price.l6 + imports.l6 + production.l6 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       9.189e-01  7.420e-02  12.385  &lt; 2e-16 ***
imports.l1    -3.981e-06  2.711e-06  -1.468  0.14366    
production.l1  1.376e-06  6.700e-07   2.054  0.04138 *  
price.l2       6.564e-02  9.728e-02   0.675  0.50061    
imports.l2     4.750e-06  3.598e-06   1.320  0.18840    
production.l2 -9.910e-07  6.806e-07  -1.456  0.14705    
price.l3      -5.121e-02  9.721e-02  -0.527  0.59894    
imports.l3     2.527e-06  3.581e-06   0.706  0.48127    
production.l3 -8.821e-07  7.096e-07  -1.243  0.21536    
price.l4       6.058e-02  9.655e-02   0.627  0.53114    
imports.l4    -7.472e-06  3.626e-06  -2.060  0.04073 *  
production.l4  1.756e-06  6.839e-07   2.568  0.01101 *  
price.l5      -3.257e-01  9.891e-02  -3.293  0.00118 ** 
imports.l5     1.155e-05  3.654e-06   3.160  0.00184 ** 
production.l5 -7.328e-07  6.880e-07  -1.065  0.28819    
price.l6       1.865e-01  7.554e-02   2.468  0.01445 *  
imports.l6    -2.989e-06  2.869e-06  -1.042  0.29870    
production.l6  1.917e-07  5.950e-07   0.322  0.74767    
const         -1.858e+00  9.771e-01  -1.902  0.05875 .  
trend         -5.544e-03  5.293e-03  -1.048  0.29618    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.7734 on 190 degrees of freedom
Multiple R-Squared: 0.8989, Adjusted R-squared: 0.8888 
F-statistic: 88.92 on 19 and 190 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation imports: 
======================================== 
imports = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + price.l3 + imports.l3 + production.l3 + price.l4 + imports.l4 + production.l4 + price.l5 + imports.l5 + production.l5 + price.l6 + imports.l6 + production.l6 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1      -6.855e+01  2.213e+03  -0.031   0.9753    
imports.l1     7.673e-01  8.085e-02   9.490   &lt;2e-16 ***
production.l1 -4.888e-02  1.998e-02  -2.447   0.0153 *  
price.l2       3.451e+03  2.901e+03   1.190   0.2357    
imports.l2    -1.985e-01  1.073e-01  -1.850   0.0659 .  
production.l2  6.676e-02  2.030e-02   3.289   0.0012 ** 
price.l3       6.500e+02  2.899e+03   0.224   0.8228    
imports.l3     2.058e-03  1.068e-01   0.019   0.9846    
production.l3  2.975e-02  2.116e-02   1.406   0.1614    
price.l4      -4.785e+03  2.879e+03  -1.662   0.0982 .  
imports.l4     8.236e-02  1.081e-01   0.762   0.4473    
production.l4  1.877e-03  2.040e-02   0.092   0.9268    
price.l5      -6.749e+02  2.950e+03  -0.229   0.8193    
imports.l5     2.113e-01  1.090e-01   1.939   0.0540 .  
production.l5 -2.352e-02  2.052e-02  -1.146   0.2531    
price.l6       3.615e+03  2.253e+03   1.605   0.1102    
imports.l6    -1.043e-01  8.555e-02  -1.219   0.2243    
production.l6 -2.000e-02  1.774e-02  -1.127   0.2611    
const          5.807e+04  2.914e+04   1.993   0.0477 *  
trend         -1.694e+02  1.578e+02  -1.073   0.2845    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 23060 on 190 degrees of freedom
Multiple R-Squared: 0.847,  Adjusted R-squared: 0.8317 
F-statistic: 55.35 on 19 and 190 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation production: 
=========================================== 
production = price.l1 + imports.l1 + production.l1 + price.l2 + imports.l2 + production.l2 + price.l3 + imports.l3 + production.l3 + price.l4 + imports.l4 + production.l4 + price.l5 + imports.l5 + production.l5 + price.l6 + imports.l6 + production.l6 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
price.l1       6.644e+03  8.586e+03   0.774 0.440056    
imports.l1    -8.224e-01  3.138e-01  -2.621 0.009477 ** 
production.l1  1.385e-01  7.753e-02   1.787 0.075568 .  
price.l2       1.166e+04  1.126e+04   1.036 0.301675    
imports.l2    -5.676e-01  4.164e-01  -1.363 0.174424    
production.l2  4.036e-01  7.877e-02   5.123 7.34e-07 ***
price.l3      -7.681e+03  1.125e+04  -0.683 0.495558    
imports.l3     1.134e+00  4.145e-01   2.735 0.006829 ** 
production.l3  1.900e-01  8.212e-02   2.314 0.021761 *  
price.l4      -1.017e+04  1.117e+04  -0.910 0.363873    
imports.l4     2.008e-01  4.197e-01   0.478 0.632909    
production.l4  1.789e-01  7.915e-02   2.260 0.024938 *  
price.l5       6.868e+03  1.145e+04   0.600 0.549245    
imports.l5     1.246e-01  4.229e-01   0.295 0.768644    
production.l5  1.944e-01  7.962e-02   2.442 0.015529 *  
price.l6       3.486e+03  8.742e+03   0.399 0.690524    
imports.l6    -2.884e-01  3.320e-01  -0.869 0.386099    
production.l6 -2.698e-01  6.885e-02  -3.918 0.000124 ***
const          2.874e+05  1.131e+05   2.541 0.011840 *  
trend          1.581e+03  6.125e+02   2.581 0.010610 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 89510 on 190 degrees of freedom
Multiple R-Squared: 0.9753, Adjusted R-squared: 0.9728 
F-statistic: 394.8 on 19 and 190 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                price   imports production
price       5.982e-01      2332     -12088
imports     2.332e+03 531981382  777816406
production -1.209e+04 777816406 8011276298

Correlation matrix of residuals:
             price imports production
price       1.0000  0.1307    -0.1746
imports     0.1307  1.0000     0.3768
production -0.1746  0.3768     1.0000</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can see that some models have some variables significant but not all. Let’s proceed with cross validation.</p>
</section>
<section id="cross-validation-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-1">Cross validation</h3>
<p>I’m using Cross validation to find the best model.</p>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(price_ts)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">15</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>rmse4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>year<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data frame to time series object</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>ts_obj <span class="ot">&lt;-</span> <span class="fu">ts</span>(supply, <span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(ts_obj )[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_obj, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_obj, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">######## first Model ############</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>  ff<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>]) <span class="co">#collecting the forecasts for 3 variables</span></span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span> <span class="co">#starting year</span></span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>  ff<span class="ot">&lt;-</span><span class="fu">ts</span>(ff,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### collecting errors ######</span></span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a>  rmse1[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">######## Second Model ############</span></span>
<span id="cb162-42"><a href="#cb162-42" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb162-43"><a href="#cb162-43" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb162-44"><a href="#cb162-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-45"><a href="#cb162-45" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast2<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb162-46"><a href="#cb162-46" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast2<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb162-47"><a href="#cb162-47" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast2<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb162-48"><a href="#cb162-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-49"><a href="#cb162-49" aria-hidden="true" tabindex="-1"></a>  ff2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>])</span>
<span id="cb162-50"><a href="#cb162-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-51"><a href="#cb162-51" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb162-52"><a href="#cb162-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-53"><a href="#cb162-53" aria-hidden="true" tabindex="-1"></a>  ff2<span class="ot">&lt;-</span><span class="fu">ts</span>(ff2,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb162-54"><a href="#cb162-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-55"><a href="#cb162-55" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb162-56"><a href="#cb162-56" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb162-57"><a href="#cb162-57" aria-hidden="true" tabindex="-1"></a>  rmse2[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff2<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb162-58"><a href="#cb162-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-59"><a href="#cb162-59" aria-hidden="true" tabindex="-1"></a>    <span class="do">######## Third Model ############</span></span>
<span id="cb162-60"><a href="#cb162-60" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb162-61"><a href="#cb162-61" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit3, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb162-62"><a href="#cb162-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-63"><a href="#cb162-63" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast3<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb162-64"><a href="#cb162-64" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast3<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb162-65"><a href="#cb162-65" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast3<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb162-66"><a href="#cb162-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-67"><a href="#cb162-67" aria-hidden="true" tabindex="-1"></a>  ff3<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>])</span>
<span id="cb162-68"><a href="#cb162-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-69"><a href="#cb162-69" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb162-70"><a href="#cb162-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-71"><a href="#cb162-71" aria-hidden="true" tabindex="-1"></a>  ff3<span class="ot">&lt;-</span><span class="fu">ts</span>(ff3,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb162-72"><a href="#cb162-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-73"><a href="#cb162-73" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb162-74"><a href="#cb162-74" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb162-75"><a href="#cb162-75" aria-hidden="true" tabindex="-1"></a>  rmse3[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff3<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb162-76"><a href="#cb162-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-77"><a href="#cb162-77" aria-hidden="true" tabindex="-1"></a>      <span class="do">######## Fourth Model ############</span></span>
<span id="cb162-78"><a href="#cb162-78" aria-hidden="true" tabindex="-1"></a>  fit4 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">6</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb162-79"><a href="#cb162-79" aria-hidden="true" tabindex="-1"></a>  fcast4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit4, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb162-80"><a href="#cb162-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-81"><a href="#cb162-81" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast4<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb162-82"><a href="#cb162-82" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast4<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb162-83"><a href="#cb162-83" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast4<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb162-84"><a href="#cb162-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-85"><a href="#cb162-85" aria-hidden="true" tabindex="-1"></a>  ff4<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>])</span>
<span id="cb162-86"><a href="#cb162-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-87"><a href="#cb162-87" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb162-88"><a href="#cb162-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-89"><a href="#cb162-89" aria-hidden="true" tabindex="-1"></a>  ff4<span class="ot">&lt;-</span><span class="fu">ts</span>(ff4,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb162-90"><a href="#cb162-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-91"><a href="#cb162-91" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb162-92"><a href="#cb162-92" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb162-93"><a href="#cb162-93" aria-hidden="true" tabindex="-1"></a>  rmse4[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff4<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb162-94"><a href="#cb162-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-95"><a href="#cb162-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-96"><a href="#cb162-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-97"><a href="#cb162-97" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>, <span class="at">main=</span><span class="st">"RMSE plot for supply"</span>)</span>
<span id="cb162-98"><a href="#cb162-98" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb162-99"><a href="#cb162-99" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb162-100"><a href="#cb162-100" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse4,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">5</span>)</span>
<span id="cb162-101"><a href="#cb162-101" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"VAR 1"</span>,<span class="st">"VAR 2"</span>,<span class="st">"VAR 3"</span>,<span class="st">"VAR 6"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>VAR(1) has lower RMSE than other VAR models , therefore VAR(1) is a better fit.</p>
</section>
<section id="model-equation" class="level3">
<h3 class="anchored" data-anchor-id="model-equation">Model Equation</h3>
<p>Model Equation for best model VAR(1)</p>
<p>Using notation I= imports, t= time, Pr= prices, and P= production</p>
<p><span class="math inline">\(\hat{Pr}=-(9.641e-01) -(8.060e-03)t+(8.913e-01)Pr_{t-1}+(7.834e-07)I_{t-1}+(7.985e-07)P_{t-1}\)</span></p>
<p><span class="math inline">\(\hat{I}=(1.099e+05) -(8.361e+01)t+(2.603e+03)Pr_{t-1}+(6.790e-01)I_{t-1}-(9.263e-03)P_{t-1}\)</span></p>
<p><span class="math inline">\(\hat{P}=( 8.823e+05) +( 3.814e+03 )t+(1.924e+04 )Pr_{t-1}-(6.366e-01)I_{t-1}-(5.458e-01)P_{t-1}\)</span></p>
</section>
<section id="forecasting-1" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-1">Forecasting</h3>
<div class="cell">
<details>
<summary>View Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">"const"</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(var1) <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">color =</span> <span class="st">'#68893c'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="multivariate_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Findings:</strong> Imports shows a generally stable trend in imports, with minor fluctuations but no significant changes indicated towards the future. The price forecast indicates a slight uptick following a period of stability, suggesting a possible increase in market prices in the near future. This could be due to external market pressures. The production forecast shows a slight decline. This suggests potential challenges or constraints that might affect production capabilities in the future. These observations suggest that while imports remain stable and prices might see a small decrease, production could face some downward pressure moving forward.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb164" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Multivariate TS Models (ARIMAX/SARIMAX/VAR)"</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "View Code"</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>This section delves into the use of ARIMAX, SARIMAX, and VAR modeling techniques for the time series datasets relevant to my project. </span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>The ARIMAX (AutoRegressive Integrated Moving Average with eXogenous variables) and SARIMAX (Seasonal ARIMAX) models are particularly useful when you're looking to predict the behavior of one primary variable based on its past values, while also considering the impact of other external variables. These models are invaluable for scenarios where external factors significantly drive changes in the primary variable, but the influence isn't bidirectional.</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>On the other hand, VAR (Vector Autoregression) models are pivotal when analyzing systems where variables are interdependent. These models allow us to explore how each variable in the dataset influences others over time, providing a comprehensive view of the dynamic interactions within the data.</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Literature Review</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Macroeconomic Factors Affecting Natural Gas Export Management</span><span class="co">](http://eprints.ubhara.ac.id/746/1/Macroeconomi%20factor.pdf)</span>:</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>The paper demonstrates that domestic consumption, exchange rates, and GDP per capita of the importing country significantly influence natural gas export volumes both in the short and long term. This suggests that these variables are critical predictors for modeling and forecasting the volume of natural gas exports</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Low US Storage Levels Point to Winter Natural Gas Price Spike Risk</span><span class="co">](https://www.energypolicy.columbia.edu/sites/default/files/pictures/LowUSStorageLevels-CGEP_FINAL.pdf)</span>:</span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>The article highlights how low gas storage levels significantly impact natural gas prices, suggesting that storage could be a critical dependent variable in models predicting these prices, especially during high-demand winter periods. This relationship also implies that storage levels could serve as a dependent variable in predicting natural gas demand, reflecting its role in balancing supply and demand seasonally.</span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Short-Term Energy Outlook Supplement: Market Drivers and Other Factors Affecting Natural Gas Prices</span><span class="co">](https://www.eia.gov/outlooks/steo/special/supplements/2023/2023_sp_01.pdf)</span>:</span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>This report provides a detailed analysis of various factors influencing natural gas prices. The report's emphasis on the direct impacts of consumption and production on natural gas pricing. The report's discussion on macroeconomic trends affecting industrial activity and natural gas consumption, suggesting that broader economic conditions significantly impact natural gas demand and, consequently, prices.</span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Impacts of long-term temperature change and variability on electricity investments</span><span class="co">](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7954813/)</span>:</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>This paper highlights how temperature increases significantly impact electric capacity and investment needs in the U.S. Analyzing climate and socioeconomic scenarios, it shows that higher temperatures boost electricity demand and capital investments, especially during peak times. This suggests that temperature is a crucial factor in predicting natural gas demand, as it is integral to electricity generation.</span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Drivers of the US CO2 emissions 1997–2013</span><span class="co">](https://www.nature.com/articles/ncomms8714)</span>:</span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>This paper uses structural decomposition analysis (SDA) to identify the key factors influencing CO2 emissions in the United States. It reveals that increases in consumption drove emissions up during 1997-2007, while reductions in consumption and changes in production structures helped decrease emissions from 2007-2013. These findings highlights the importance of targeting consumption patterns and production structures in CO2 emissions management.</span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Datasets &amp; Models</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a>**(SARIMAX) Consumption ~ Temperature + Production + Storage**</span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a>I chose Temperature, Production, and Storage as exogenous variables in the SARIMAX model for predicting natural gas demand because Temperature directly influences consumption due to heating and cooling needs, varying with the seasons. Production levels impact market supply, which can affect consumption by altering availability and prices. Storage levels act as a buffer for supply fluctuations and have implications on consumption through their effect on market dynamics.</span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-43"><a href="#cb164-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,echo=FALSE}</span></span>
<span id="cb164-44"><a href="#cb164-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-45"><a href="#cb164-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-46"><a href="#cb164-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb164-47"><a href="#cb164-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb164-48"><a href="#cb164-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb164-49"><a href="#cb164-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb164-50"><a href="#cb164-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb164-51"><a href="#cb164-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb164-52"><a href="#cb164-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb164-53"><a href="#cb164-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb164-54"><a href="#cb164-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa) </span>
<span id="cb164-55"><a href="#cb164-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb164-56"><a href="#cb164-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb164-57"><a href="#cb164-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb164-58"><a href="#cb164-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb164-59"><a href="#cb164-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb164-60"><a href="#cb164-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb164-61"><a href="#cb164-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb164-62"><a href="#cb164-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb164-63"><a href="#cb164-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb164-64"><a href="#cb164-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb164-65"><a href="#cb164-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb164-66"><a href="#cb164-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb164-67"><a href="#cb164-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  </span>
<span id="cb164-68"><a href="#cb164-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)   </span>
<span id="cb164-69"><a href="#cb164-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)          </span>
<span id="cb164-70"><a href="#cb164-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)   </span>
<span id="cb164-71"><a href="#cb164-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb164-72"><a href="#cb164-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb164-73"><a href="#cb164-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb164-74"><a href="#cb164-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb164-75"><a href="#cb164-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb164-76"><a href="#cb164-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb164-77"><a href="#cb164-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb164-78"><a href="#cb164-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb164-79"><a href="#cb164-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb164-80"><a href="#cb164-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb164-81"><a href="#cb164-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb164-82"><a href="#cb164-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb164-83"><a href="#cb164-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb164-84"><a href="#cb164-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb164-85"><a href="#cb164-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb164-86"><a href="#cb164-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-87"><a href="#cb164-87" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-88"><a href="#cb164-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-89"><a href="#cb164-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-90"><a href="#cb164-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-93"><a href="#cb164-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-94"><a href="#cb164-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-95"><a href="#cb164-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-96"><a href="#cb164-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-97"><a href="#cb164-97" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb164-98"><a href="#cb164-98" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-99"><a href="#cb164-99" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-100"><a href="#cb164-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-101"><a href="#cb164-101" aria-hidden="true" tabindex="-1"></a>temperature<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/temperature.csv"</span>)</span>
<span id="cb164-102"><a href="#cb164-102" aria-hidden="true" tabindex="-1"></a>temperature<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(temperature<span class="sc">$</span>moonth, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-103"><a href="#cb164-103" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">subset</span>(temperature, <span class="at">select =</span> <span class="fu">c</span>(Date,avg_temp))</span>
<span id="cb164-104"><a href="#cb164-104" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temperature)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"temperature"</span></span>
<span id="cb164-105"><a href="#cb164-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-106"><a href="#cb164-106" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb164-107"><a href="#cb164-107" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-108"><a href="#cb164-108" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">subset</span>(production, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-109"><a href="#cb164-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-110"><a href="#cb164-110" aria-hidden="true" tabindex="-1"></a>storage<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Storage.csv"</span>)</span>
<span id="cb164-111"><a href="#cb164-111" aria-hidden="true" tabindex="-1"></a>storage<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(storage<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-112"><a href="#cb164-112" aria-hidden="true" tabindex="-1"></a>storage <span class="ot">&lt;-</span> <span class="fu">subset</span>(storage, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-113"><a href="#cb164-113" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(storage)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"storage"</span></span>
<span id="cb164-114"><a href="#cb164-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-115"><a href="#cb164-115" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> consumption <span class="sc">%&gt;%</span></span>
<span id="cb164-116"><a href="#cb164-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temperature, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-117"><a href="#cb164-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(production, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-118"><a href="#cb164-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(storage, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb164-119"><a href="#cb164-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-120"><a href="#cb164-120" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> demand[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(demand))]</span>
<span id="cb164-121"><a href="#cb164-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-122"><a href="#cb164-122" aria-hidden="true" tabindex="-1"></a>demand_ts <span class="ot">=</span> <span class="fu">ts</span>(demand, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>), <span class="at">frequency =</span><span class="dv">12</span> )</span>
<span id="cb164-123"><a href="#cb164-123" aria-hidden="true" tabindex="-1"></a>head_demand<span class="ot">&lt;-</span><span class="fu">head</span>(demand)</span>
<span id="cb164-124"><a href="#cb164-124" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_demand, <span class="at">caption =</span> <span class="st">"Natural Gas Demand in the US Dataset"</span>)</span>
<span id="cb164-125"><a href="#cb164-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-126"><a href="#cb164-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-127"><a href="#cb164-127" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-128"><a href="#cb164-128" aria-hidden="true" tabindex="-1"></a>**(ARIMAX) Prices(Henry Hub) ~ GDP + Unemployment**</span>
<span id="cb164-129"><a href="#cb164-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-130"><a href="#cb164-130" aria-hidden="true" tabindex="-1"></a>I chose GDP and unemployment rates as exogenous variables for this analysis because they are key indicators of economic activity and health, which directly influence energy demand and pricing. Changes in GDP reflect shifts in industrial and consumer demand for energy, while unemployment rates can impact consumption patterns, both of which affect natural gas prices at Henry Hub.</span>
<span id="cb164-131"><a href="#cb164-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-134"><a href="#cb164-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-135"><a href="#cb164-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-136"><a href="#cb164-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-137"><a href="#cb164-137" aria-hidden="true" tabindex="-1"></a>price<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Henry_Hub_Natural_Gas_Spot_Price.csv"</span>)</span>
<span id="cb164-138"><a href="#cb164-138" aria-hidden="true" tabindex="-1"></a>price<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(price<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-139"><a href="#cb164-139" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">subset</span>(price, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-140"><a href="#cb164-140" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"price"</span></span>
<span id="cb164-141"><a href="#cb164-141" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> price[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"price"</span>)]</span>
<span id="cb164-142"><a href="#cb164-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb164-143"><a href="#cb164-143" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb164-144"><a href="#cb164-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb164-145"><a href="#cb164-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb164-146"><a href="#cb164-146" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb164-147"><a href="#cb164-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb164-148"><a href="#cb164-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb164-149"><a href="#cb164-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">price =</span> <span class="fu">round</span>(<span class="fu">mean</span>(price),<span class="dv">2</span>),  </span>
<span id="cb164-150"><a href="#cb164-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb164-151"><a href="#cb164-151" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb164-152"><a href="#cb164-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-153"><a href="#cb164-153" aria-hidden="true" tabindex="-1"></a>gdp<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/gdp.csv"</span>)</span>
<span id="cb164-154"><a href="#cb164-154" aria-hidden="true" tabindex="-1"></a>gdp<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(gdp<span class="sc">$</span>Quarter, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb164-155"><a href="#cb164-155" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">&lt;-</span> <span class="fu">subset</span>(gdp, <span class="at">select =</span> <span class="sc">-</span>Quarter)</span>
<span id="cb164-156"><a href="#cb164-156" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gdp)[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"gdp"</span></span>
<span id="cb164-157"><a href="#cb164-157" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">&lt;-</span> gdp[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"gdp"</span>)]</span>
<span id="cb164-158"><a href="#cb164-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-159"><a href="#cb164-159" aria-hidden="true" tabindex="-1"></a>unemp<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/unemp.csv"</span>)</span>
<span id="cb164-160"><a href="#cb164-160" aria-hidden="true" tabindex="-1"></a><span class="do">##unpivot</span></span>
<span id="cb164-161"><a href="#cb164-161" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp <span class="sc">%&gt;%</span></span>
<span id="cb164-162"><a href="#cb164-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb164-163"><a href="#cb164-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Jan<span class="sc">:</span>Dec,  <span class="co">#the range of columns to unpivot</span></span>
<span id="cb164-164"><a href="#cb164-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Month"</span>,  </span>
<span id="cb164-165"><a href="#cb164-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Unemp"</span>  </span>
<span id="cb164-166"><a href="#cb164-166" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb164-167"><a href="#cb164-167" aria-hidden="true" tabindex="-1"></a>unemp<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">make_date</span>(<span class="at">year =</span> unemp<span class="sc">$</span>Year, <span class="at">month =</span> <span class="fu">match</span>(unemp<span class="sc">$</span>Month, month.abb), <span class="at">day =</span> <span class="dv">1</span>)</span>
<span id="cb164-168"><a href="#cb164-168" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder columns to place Date first and drop Year and Month as they are no longer needed</span></span>
<span id="cb164-169"><a href="#cb164-169" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp[, <span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Unemp"</span>)]</span>
<span id="cb164-170"><a href="#cb164-170" aria-hidden="true" tabindex="-1"></a>unemp<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(unemp<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb164-171"><a href="#cb164-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb164-172"><a href="#cb164-172" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp <span class="sc">%&gt;%</span></span>
<span id="cb164-173"><a href="#cb164-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb164-174"><a href="#cb164-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb164-175"><a href="#cb164-175" aria-hidden="true" tabindex="-1"></a>unemp <span class="ot">&lt;-</span> unemp <span class="sc">%&gt;%</span></span>
<span id="cb164-176"><a href="#cb164-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb164-177"><a href="#cb164-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb164-178"><a href="#cb164-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">unemp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Unemp),<span class="dv">2</span>),  </span>
<span id="cb164-179"><a href="#cb164-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb164-180"><a href="#cb164-180" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb164-181"><a href="#cb164-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-182"><a href="#cb164-182" aria-hidden="true" tabindex="-1"></a>eco <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb164-183"><a href="#cb164-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gdp, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-184"><a href="#cb164-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(unemp, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb164-185"><a href="#cb164-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-186"><a href="#cb164-186" aria-hidden="true" tabindex="-1"></a>eco_ts <span class="ot">=</span> <span class="fu">ts</span>(eco, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">frequency =</span><span class="dv">4</span> )</span>
<span id="cb164-187"><a href="#cb164-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-188"><a href="#cb164-188" aria-hidden="true" tabindex="-1"></a>head_eco<span class="ot">&lt;-</span><span class="fu">head</span>(eco)</span>
<span id="cb164-189"><a href="#cb164-189" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_eco, <span class="at">caption =</span> <span class="st">"Natural Gas Henry Hub Prices and Macroeconomic Indicators in the US Dataset"</span>)</span>
<span id="cb164-190"><a href="#cb164-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-191"><a href="#cb164-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-192"><a href="#cb164-192" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-193"><a href="#cb164-193" aria-hidden="true" tabindex="-1"></a>**(ARIMAX) Exports ~ Domestic Consumption + Exchange Rate + GDP of of the importing country(Netherlands) **</span>
<span id="cb164-194"><a href="#cb164-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-195"><a href="#cb164-195" aria-hidden="true" tabindex="-1"></a>I chose domestic consumption for this analysis because it directly reflects the internal demand for natural gas within the U.S., influencing how much is available for export. The exchange rate affects the competitiveness of U.S. natural gas in global markets, with favorable rates potentially boosting exports by making them more cost-effective for foreign buyers. Additionally, the GDP of the importing country, the Netherlands in this case, was chosen because it indicates the economic health and energy demand of a key market, impacting the volume of natural gas they are likely to import from the U.S.</span>
<span id="cb164-196"><a href="#cb164-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-199"><a href="#cb164-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-200"><a href="#cb164-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-201"><a href="#cb164-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-202"><a href="#cb164-202" aria-hidden="true" tabindex="-1"></a>exports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/exports.csv"</span>)</span>
<span id="cb164-203"><a href="#cb164-203" aria-hidden="true" tabindex="-1"></a>exports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(exports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb164-204"><a href="#cb164-204" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> <span class="fu">subset</span>(exports, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-205"><a href="#cb164-205" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Exports"</span>)]</span>
<span id="cb164-206"><a href="#cb164-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is greater than 2004</span></span>
<span id="cb164-207"><a href="#cb164-207" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports[<span class="fu">as.integer</span>(<span class="fu">format</span>(exports<span class="sc">$</span>Date, <span class="st">"%Y"</span>)) <span class="sc">&gt;</span> <span class="dv">2004</span>, ]</span>
<span id="cb164-208"><a href="#cb164-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb164-209"><a href="#cb164-209" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports <span class="sc">%&gt;%</span></span>
<span id="cb164-210"><a href="#cb164-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb164-211"><a href="#cb164-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb164-212"><a href="#cb164-212" aria-hidden="true" tabindex="-1"></a>exports <span class="ot">&lt;-</span> exports <span class="sc">%&gt;%</span></span>
<span id="cb164-213"><a href="#cb164-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb164-214"><a href="#cb164-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb164-215"><a href="#cb164-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">exports =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Exports),<span class="dv">2</span>),</span>
<span id="cb164-216"><a href="#cb164-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb164-217"><a href="#cb164-217" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb164-218"><a href="#cb164-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-219"><a href="#cb164-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-220"><a href="#cb164-220" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb164-221"><a href="#cb164-221" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-222"><a href="#cb164-222" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-223"><a href="#cb164-223" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Consumption"</span>)]</span>
<span id="cb164-224"><a href="#cb164-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to a quarterly period using lubridate</span></span>
<span id="cb164-225"><a href="#cb164-225" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption <span class="sc">%&gt;%</span></span>
<span id="cb164-226"><a href="#cb164-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">floor_date</span>(Date, <span class="st">"quarter"</span>))</span>
<span id="cb164-227"><a href="#cb164-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by quarter</span></span>
<span id="cb164-228"><a href="#cb164-228" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption <span class="sc">%&gt;%</span></span>
<span id="cb164-229"><a href="#cb164-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb164-230"><a href="#cb164-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb164-231"><a href="#cb164-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">consumption =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Consumption),<span class="dv">2</span>),</span>
<span id="cb164-232"><a href="#cb164-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>        <span class="co"># Drops the grouping structure after summarizing</span></span>
<span id="cb164-233"><a href="#cb164-233" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb164-234"><a href="#cb164-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-235"><a href="#cb164-235" aria-hidden="true" tabindex="-1"></a>fx_rate<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/exchange_rate.csv"</span>)</span>
<span id="cb164-236"><a href="#cb164-236" aria-hidden="true" tabindex="-1"></a>fx_rate<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(fx_rate<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb164-237"><a href="#cb164-237" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fx_rate)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"fx_rate"</span></span>
<span id="cb164-238"><a href="#cb164-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-239"><a href="#cb164-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-240"><a href="#cb164-240" aria-hidden="true" tabindex="-1"></a>gdp_nl<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/gdp_int.csv"</span>)</span>
<span id="cb164-241"><a href="#cb164-241" aria-hidden="true" tabindex="-1"></a>gdp_nl<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(gdp_nl<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-242"><a href="#cb164-242" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gdp_nl)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"gdp_nl"</span></span>
<span id="cb164-243"><a href="#cb164-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-244"><a href="#cb164-244" aria-hidden="true" tabindex="-1"></a>export <span class="ot">&lt;-</span> exports <span class="sc">%&gt;%</span></span>
<span id="cb164-245"><a href="#cb164-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(consumption, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-246"><a href="#cb164-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fx_rate, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-247"><a href="#cb164-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gdp_nl, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb164-248"><a href="#cb164-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-249"><a href="#cb164-249" aria-hidden="true" tabindex="-1"></a>export_ts <span class="ot">=</span> <span class="fu">ts</span>(export, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">frequency =</span><span class="dv">4</span> )</span>
<span id="cb164-250"><a href="#cb164-250" aria-hidden="true" tabindex="-1"></a>head_export<span class="ot">&lt;-</span><span class="fu">head</span>(export)</span>
<span id="cb164-251"><a href="#cb164-251" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_export, <span class="at">caption =</span> <span class="st">"US Exports of Natural Gas and the Influencing Factors Dataset"</span>)</span>
<span id="cb164-252"><a href="#cb164-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-253"><a href="#cb164-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-254"><a href="#cb164-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-255"><a href="#cb164-255" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-256"><a href="#cb164-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-257"><a href="#cb164-257" aria-hidden="true" tabindex="-1"></a>**(ARIMAX) CO2 emissions ~ Natural Gas Consumption + Natural Gas Production**</span>
<span id="cb164-258"><a href="#cb164-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-259"><a href="#cb164-259" aria-hidden="true" tabindex="-1"></a>I chose Natural Gas Consumption and Natural Gas Production as exogenous variables in the ARIMAX model for predicting CO2 emissions, because these variables are directly linked to emissions levels. Natural gas consumption is a primary source of CO2 emissions, particularly in power generation and industrial uses, making it a key variable for accurate emissions modeling. Similarly, the rate of natural gas production influences the availability and usage of natural gas, thereby affecting overall emissions.</span>
<span id="cb164-260"><a href="#cb164-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-263"><a href="#cb164-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-264"><a href="#cb164-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-265"><a href="#cb164-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-266"><a href="#cb164-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-267"><a href="#cb164-267" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/co2_emissions.csv"</span>)</span>
<span id="cb164-268"><a href="#cb164-268" aria-hidden="true" tabindex="-1"></a>co2_emissions<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(co2_emissions<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-269"><a href="#cb164-269" aria-hidden="true" tabindex="-1"></a>co2_emissions <span class="ot">&lt;-</span> <span class="fu">subset</span>(co2_emissions, <span class="at">select =</span> <span class="fu">c</span>(Date,co2_value))</span>
<span id="cb164-270"><a href="#cb164-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is greater than 2004</span></span>
<span id="cb164-271"><a href="#cb164-271" aria-hidden="true" tabindex="-1"></a>co2_emissions <span class="ot">&lt;-</span> co2_emissions[<span class="fu">as.integer</span>(<span class="fu">format</span>(co2_emissions<span class="sc">$</span>Date, <span class="st">"%Y"</span>)) <span class="sc">&gt;</span> <span class="dv">2004</span>, ]</span>
<span id="cb164-272"><a href="#cb164-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is less than 2023</span></span>
<span id="cb164-273"><a href="#cb164-273" aria-hidden="true" tabindex="-1"></a>co2_emissions <span class="ot">&lt;-</span> co2_emissions[<span class="fu">as.integer</span>(<span class="fu">format</span>(co2_emissions<span class="sc">$</span>Date, <span class="st">"%Y"</span>))<span class="sc">&lt;</span><span class="dv">2023</span>, ]</span>
<span id="cb164-274"><a href="#cb164-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-275"><a href="#cb164-275" aria-hidden="true" tabindex="-1"></a>consumption<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Consumption.csv"</span>)</span>
<span id="cb164-276"><a href="#cb164-276" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(consumption<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-277"><a href="#cb164-277" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-278"><a href="#cb164-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-279"><a href="#cb164-279" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb164-280"><a href="#cb164-280" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-281"><a href="#cb164-281" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">subset</span>(production, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-282"><a href="#cb164-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-283"><a href="#cb164-283" aria-hidden="true" tabindex="-1"></a>env_impact <span class="ot">&lt;-</span> co2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb164-284"><a href="#cb164-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(consumption, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-285"><a href="#cb164-285" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(production, <span class="at">by =</span> <span class="st">"Date"</span>) </span>
<span id="cb164-286"><a href="#cb164-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-287"><a href="#cb164-287" aria-hidden="true" tabindex="-1"></a>env_impact_ts <span class="ot">=</span> <span class="fu">ts</span>(env_impact, <span class="at">start =</span> <span class="dv">2005</span>, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>), <span class="at">frequency =</span><span class="dv">12</span> )</span>
<span id="cb164-288"><a href="#cb164-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-289"><a href="#cb164-289" aria-hidden="true" tabindex="-1"></a>head_env_impact<span class="ot">&lt;-</span><span class="fu">head</span>(env_impact)</span>
<span id="cb164-290"><a href="#cb164-290" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(head_env_impact, <span class="at">caption =</span> <span class="st">"Natural Gas Environmental Impact in the US Dataset"</span>)</span>
<span id="cb164-291"><a href="#cb164-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-292"><a href="#cb164-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-293"><a href="#cb164-293" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Supply Influence</span></span>
<span id="cb164-294"><a href="#cb164-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-295"><a href="#cb164-295" aria-hidden="true" tabindex="-1"></a>**(VAR) Prices(Henry Hub) ~ Imports + Production**</span>
<span id="cb164-296"><a href="#cb164-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-297"><a href="#cb164-297" aria-hidden="true" tabindex="-1"></a>Prices at Henry Hub, imports, and production were chosen as endogenous variables for the VAR model to capture the interdependent dynamics within the natural gas market. Henry Hub prices are a benchmark for natural gas pricing and are influenced by changes in supply and demand, which are directly impacted by production levels and import volumes. By analyzing these variables together, the model can illustrate how fluctuations in production and imports directly affect prices, providing a comprehensive view of the supply-demand balance in the U.S. natural gas market.</span>
<span id="cb164-298"><a href="#cb164-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-301"><a href="#cb164-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-302"><a href="#cb164-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-303"><a href="#cb164-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-304"><a href="#cb164-304" aria-hidden="true" tabindex="-1"></a>price<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Henry_Hub_Natural_Gas_Spot_Price.csv"</span>)</span>
<span id="cb164-305"><a href="#cb164-305" aria-hidden="true" tabindex="-1"></a>price<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(price<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-306"><a href="#cb164-306" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">subset</span>(price, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-307"><a href="#cb164-307" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"price"</span></span>
<span id="cb164-308"><a href="#cb164-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-309"><a href="#cb164-309" aria-hidden="true" tabindex="-1"></a>imports<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/imports.csv"</span>)</span>
<span id="cb164-310"><a href="#cb164-310" aria-hidden="true" tabindex="-1"></a>imports<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(imports<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb164-311"><a href="#cb164-311" aria-hidden="true" tabindex="-1"></a>imports <span class="ot">&lt;-</span> <span class="fu">subset</span>(imports, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-312"><a href="#cb164-312" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(imports)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"imports"</span></span>
<span id="cb164-313"><a href="#cb164-313" aria-hidden="true" tabindex="-1"></a>imports <span class="ot">&lt;-</span> imports[<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"imports"</span>)]</span>
<span id="cb164-314"><a href="#cb164-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the year is greater than 2004</span></span>
<span id="cb164-315"><a href="#cb164-315" aria-hidden="true" tabindex="-1"></a>imports <span class="ot">&lt;-</span> imports[<span class="fu">as.integer</span>(<span class="fu">format</span>(imports<span class="sc">$</span>Date, <span class="st">"%Y"</span>)) <span class="sc">&gt;</span> <span class="dv">2004</span>, ]</span>
<span id="cb164-316"><a href="#cb164-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-317"><a href="#cb164-317" aria-hidden="true" tabindex="-1"></a>production<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"datasets/eda/Production.csv"</span>)</span>
<span id="cb164-318"><a href="#cb164-318" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(production<span class="sc">$</span>Month, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb164-319"><a href="#cb164-319" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">subset</span>(production, <span class="at">select =</span> <span class="sc">-</span>Month)</span>
<span id="cb164-320"><a href="#cb164-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-321"><a href="#cb164-321" aria-hidden="true" tabindex="-1"></a>supply_dynamics <span class="ot">&lt;-</span> price <span class="sc">%&gt;%</span></span>
<span id="cb164-322"><a href="#cb164-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(imports, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-323"><a href="#cb164-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(production, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb164-324"><a href="#cb164-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-325"><a href="#cb164-325" aria-hidden="true" tabindex="-1"></a>supply_dynamics <span class="ot">&lt;-</span> supply_dynamics[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(supply_dynamics))]</span>
<span id="cb164-326"><a href="#cb164-326" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(supply_dynamics), <span class="at">caption =</span> <span class="st">"Natural Gas Supply Dynamics in the US Dataset"</span>)</span>
<span id="cb164-327"><a href="#cb164-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-328"><a href="#cb164-328" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-329"><a href="#cb164-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-330"><a href="#cb164-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-331"><a href="#cb164-331" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARIMAX/SARIMAX Modeling</span></span>
<span id="cb164-332"><a href="#cb164-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-333"><a href="#cb164-333" aria-hidden="true" tabindex="-1"></a><span class="fu">### Time series plot</span></span>
<span id="cb164-334"><a href="#cb164-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-335"><a href="#cb164-335" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-336"><a href="#cb164-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-337"><a href="#cb164-337" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-338"><a href="#cb164-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-341"><a href="#cb164-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-342"><a href="#cb164-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-343"><a href="#cb164-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-344"><a href="#cb164-344" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(demand_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb164-345"><a href="#cb164-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-346"><a href="#cb164-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Factors Affecting Consumption Variations"</span>)</span>
<span id="cb164-347"><a href="#cb164-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-348"><a href="#cb164-348" aria-hidden="true" tabindex="-1"></a>The graph seems to illustrate a clear seasonal pattern in natural gas consumption, which is likely correlated with temperature variations. This pattern typically shows higher consumption during the colder months when temperatures are low, indicating heating demand is driving usage. The production of natural gas appears to trend upward over time, suggesting increased capacity or efficiency in production methods. Interestingly, while there's seasonality in consumption that aligns with temperature changes, production doesn't show a similar seasonal dip but instead a steady or possibly growing trend over the years. Storage levels also exhibit seasonality, with peaks presumably during times of lower consumption when excess production can be stored, and troughs when storage is drawn down during periods of high consumption.</span>
<span id="cb164-349"><a href="#cb164-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-350"><a href="#cb164-350" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-353"><a href="#cb164-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-354"><a href="#cb164-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-355"><a href="#cb164-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-356"><a href="#cb164-356" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(eco_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb164-357"><a href="#cb164-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-358"><a href="#cb164-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Macroeconomic Factors Affecting Natural Gas Prices"</span>)</span>
<span id="cb164-359"><a href="#cb164-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-360"><a href="#cb164-360" aria-hidden="true" tabindex="-1"></a>The graph shows an unexpected trend between natural gas prices, U.S. GDP, and unemployment. Despite steady economic growth indicated by rising GDP, natural gas prices rise initially but then decline, suggesting influences from factors like technological advances or energy policy changes. The sharp increase in unemployment in 2020 leads to a significant drop in prices, indicating decreased demand. However, as the economy recovers and unemployment falls, prices begin to recover, reflecting a rebound in demand for natural gas.</span>
<span id="cb164-361"><a href="#cb164-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-362"><a href="#cb164-362" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-365"><a href="#cb164-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-366"><a href="#cb164-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-367"><a href="#cb164-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-368"><a href="#cb164-368" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(export_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb164-369"><a href="#cb164-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-370"><a href="#cb164-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Factors Affecting Variations in US Exports"</span>)</span>
<span id="cb164-371"><a href="#cb164-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-372"><a href="#cb164-372" aria-hidden="true" tabindex="-1"></a>The plot shows that the growth of U.S. natural gas exports alongside factors like domestic consumption, foreign exchange rates, and the GDP of the Netherlands.  It shows a steady increase in exports, reflecting the U.S.'s growing role in global energy markets. Domestic consumption follows a consistent cyclical pattern, suggesting seasonal variability in demand which doesn't appear to directly impact the rising trend in exports. The foreign exchange rate exhibits fluctuations which could influence international trade dynamics, potentially making U.S. gas more or less attractive to foreign buyers depending on the strength of the dollar. Lastly, the GDP of the Netherlands, a significant importer, shows a steady rise, indicating economic growth that could correlate with increased demand for U.S. natural gas, aligning with the increase in exports.</span>
<span id="cb164-373"><a href="#cb164-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-374"><a href="#cb164-374" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-375"><a href="#cb164-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-378"><a href="#cb164-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-379"><a href="#cb164-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-380"><a href="#cb164-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-381"><a href="#cb164-381" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(env_impact_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span></span>
<span id="cb164-382"><a href="#cb164-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-383"><a href="#cb164-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Factors Affecting CO2 Emission Variations"</span>)</span>
<span id="cb164-384"><a href="#cb164-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-385"><a href="#cb164-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-386"><a href="#cb164-386" aria-hidden="true" tabindex="-1"></a>According to the graph CO2 emissions exhibit sharp, periodic spikes that could correlate with specific events or time periods—potentially seasonal changes in energy use. Natural gas consumption shows a fluctuating but consistent pattern, suggesting a regular, perhaps seasonal, variation—likely related to heating needs in winter and cooling in summer. Production, however, trends upward, indicating growing output over the years. Together, this plot shows consumption and production trends directly impact emission levels. </span>
<span id="cb164-387"><a href="#cb164-387" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-388"><a href="#cb164-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-389"><a href="#cb164-389" aria-hidden="true" tabindex="-1"></a><span class="fu">### Automatic Model Fitting</span></span>
<span id="cb164-390"><a href="#cb164-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-391"><a href="#cb164-391" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-392"><a href="#cb164-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-393"><a href="#cb164-393" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-394"><a href="#cb164-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-397"><a href="#cb164-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-398"><a href="#cb164-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-399"><a href="#cb164-399" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-400"><a href="#cb164-400" aria-hidden="true" tabindex="-1"></a>xreg_demand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">temperature =</span> demand_ts[, <span class="st">"temperature"</span>],</span>
<span id="cb164-401"><a href="#cb164-401" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span> demand_ts[, <span class="st">"Production"</span>],</span>
<span id="cb164-402"><a href="#cb164-402" aria-hidden="true" tabindex="-1"></a>               <span class="at">storage =</span> demand_ts[, <span class="st">"storage"</span>] )</span>
<span id="cb164-403"><a href="#cb164-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-404"><a href="#cb164-404" aria-hidden="true" tabindex="-1"></a>fit_demand <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(demand_ts[, <span class="st">"Consumption"</span>], <span class="at">xreg =</span> xreg_demand)</span>
<span id="cb164-405"><a href="#cb164-405" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_demand)</span>
<span id="cb164-406"><a href="#cb164-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-407"><a href="#cb164-407" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_demand, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-408"><a href="#cb164-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-409"><a href="#cb164-409" aria-hidden="true" tabindex="-1"></a>Best model: ARIMA(0,0,2)(0,1,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb164-410"><a href="#cb164-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-411"><a href="#cb164-411" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-414"><a href="#cb164-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-415"><a href="#cb164-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-416"><a href="#cb164-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-417"><a href="#cb164-417" aria-hidden="true" tabindex="-1"></a>xreg_eco <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">gdp =</span> eco_ts[, <span class="st">"gdp"</span>],</span>
<span id="cb164-418"><a href="#cb164-418" aria-hidden="true" tabindex="-1"></a>              <span class="at">unemp =</span> eco_ts[, <span class="st">"unemp"</span>])</span>
<span id="cb164-419"><a href="#cb164-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-420"><a href="#cb164-420" aria-hidden="true" tabindex="-1"></a>fit_eco <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(eco_ts[, <span class="st">"price"</span>], <span class="at">xreg =</span> xreg_eco)</span>
<span id="cb164-421"><a href="#cb164-421" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_eco)</span>
<span id="cb164-422"><a href="#cb164-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-423"><a href="#cb164-423" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_eco, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-424"><a href="#cb164-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-425"><a href="#cb164-425" aria-hidden="true" tabindex="-1"></a>Best model: ARIMA(0,1,0)(0,0,2)<span class="co">[</span><span class="ot">4</span><span class="co">]</span></span>
<span id="cb164-426"><a href="#cb164-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-427"><a href="#cb164-427" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-430"><a href="#cb164-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-431"><a href="#cb164-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-432"><a href="#cb164-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-433"><a href="#cb164-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-434"><a href="#cb164-434" aria-hidden="true" tabindex="-1"></a>xreg_export <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">consumption =</span> export_ts[, <span class="st">"consumption"</span>],</span>
<span id="cb164-435"><a href="#cb164-435" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fx_rate =</span> export_ts[, <span class="st">"fx_rate"</span>],</span>
<span id="cb164-436"><a href="#cb164-436" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gdp_nl =</span> export_ts[, <span class="st">"gdp_nl"</span>] )</span>
<span id="cb164-437"><a href="#cb164-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-438"><a href="#cb164-438" aria-hidden="true" tabindex="-1"></a>fit_export <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(export_ts[, <span class="st">"exports"</span>], <span class="at">xreg =</span> xreg_export)</span>
<span id="cb164-439"><a href="#cb164-439" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_export)</span>
<span id="cb164-440"><a href="#cb164-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-441"><a href="#cb164-441" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_export, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-442"><a href="#cb164-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-443"><a href="#cb164-443" aria-hidden="true" tabindex="-1"></a>Best model: ARIMA(1,0,0)</span>
<span id="cb164-444"><a href="#cb164-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-445"><a href="#cb164-445" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-446"><a href="#cb164-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-449"><a href="#cb164-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-450"><a href="#cb164-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-451"><a href="#cb164-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-452"><a href="#cb164-452" aria-hidden="true" tabindex="-1"></a>xreg_env_impact <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Consumption =</span> env_impact_ts[, <span class="st">"Consumption"</span>],</span>
<span id="cb164-453"><a href="#cb164-453" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span> env_impact_ts[, <span class="st">"Production"</span>] )</span>
<span id="cb164-454"><a href="#cb164-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-455"><a href="#cb164-455" aria-hidden="true" tabindex="-1"></a>fit_env_impact <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(env_impact_ts[, <span class="st">"co2_value"</span>], <span class="at">xreg =</span> xreg_env_impact)</span>
<span id="cb164-456"><a href="#cb164-456" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_env_impact)</span>
<span id="cb164-457"><a href="#cb164-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-458"><a href="#cb164-458" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_env_impact, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-459"><a href="#cb164-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-460"><a href="#cb164-460" aria-hidden="true" tabindex="-1"></a>Best model: ARIMA(0,0,1)(0,0,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb164-461"><a href="#cb164-461" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-462"><a href="#cb164-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-463"><a href="#cb164-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### Manual Model Fitting</span></span>
<span id="cb164-464"><a href="#cb164-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-465"><a href="#cb164-465" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-466"><a href="#cb164-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-467"><a href="#cb164-467" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-468"><a href="#cb164-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-471"><a href="#cb164-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-472"><a href="#cb164-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-473"><a href="#cb164-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-474"><a href="#cb164-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-475"><a href="#cb164-475" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>Consumption<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>Consumption,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-476"><a href="#cb164-476" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>Production<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>Production,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-477"><a href="#cb164-477" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>temperature<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>temperature,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-478"><a href="#cb164-478" aria-hidden="true" tabindex="-1"></a>demand<span class="sc">$</span>storage<span class="ot">&lt;-</span><span class="fu">ts</span>(demand<span class="sc">$</span>storage,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-479"><a href="#cb164-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-480"><a href="#cb164-480" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb164-481"><a href="#cb164-481" aria-hidden="true" tabindex="-1"></a>fit_demand.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Consumption <span class="sc">~</span> Production<span class="sc">+</span>temperature<span class="sc">+</span>storage, <span class="at">data=</span>demand)</span>
<span id="cb164-482"><a href="#cb164-482" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_demand.reg)</span>
<span id="cb164-483"><a href="#cb164-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-484"><a href="#cb164-484" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_demand.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-485"><a href="#cb164-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-486"><a href="#cb164-486" aria-hidden="true" tabindex="-1"></a>The ACF plot suggests that there's autocorrelation at certain lags that the model hasn't accounted for.Residuals Distribution resemble a normal distribution, which is a good sign of model fit. </span>
<span id="cb164-487"><a href="#cb164-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-488"><a href="#cb164-488" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-491"><a href="#cb164-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-492"><a href="#cb164-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-493"><a href="#cb164-493" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-494"><a href="#cb164-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-495"><a href="#cb164-495" aria-hidden="true" tabindex="-1"></a>eco<span class="sc">$</span>price<span class="ot">&lt;-</span><span class="fu">ts</span>(eco<span class="sc">$</span>price,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-496"><a href="#cb164-496" aria-hidden="true" tabindex="-1"></a>eco<span class="sc">$</span>gdp<span class="ot">&lt;-</span><span class="fu">ts</span>(eco<span class="sc">$</span>gdp,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-497"><a href="#cb164-497" aria-hidden="true" tabindex="-1"></a>eco<span class="sc">$</span>unemp<span class="ot">&lt;-</span><span class="fu">ts</span>(eco<span class="sc">$</span>unemp,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-498"><a href="#cb164-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-499"><a href="#cb164-499" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb164-500"><a href="#cb164-500" aria-hidden="true" tabindex="-1"></a>fit_eco.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> gdp<span class="sc">+</span>unemp, <span class="at">data=</span>eco)</span>
<span id="cb164-501"><a href="#cb164-501" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_eco.reg)</span>
<span id="cb164-502"><a href="#cb164-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-503"><a href="#cb164-503" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_eco.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-504"><a href="#cb164-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-505"><a href="#cb164-505" aria-hidden="true" tabindex="-1"></a>The ACF plot does not display significant autocorrelation in the residuals, this generally indicates that the residuals are random, which is a sign of a good fit. The histogram shows some deviations from normality, especially with a skew towards the right.</span>
<span id="cb164-506"><a href="#cb164-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-507"><a href="#cb164-507" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-510"><a href="#cb164-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-511"><a href="#cb164-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-512"><a href="#cb164-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-513"><a href="#cb164-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-514"><a href="#cb164-514" aria-hidden="true" tabindex="-1"></a>export<span class="sc">$</span>consumption<span class="ot">&lt;-</span><span class="fu">ts</span>(export<span class="sc">$</span>consumption,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-515"><a href="#cb164-515" aria-hidden="true" tabindex="-1"></a>export<span class="sc">$</span>fx_rate<span class="ot">&lt;-</span><span class="fu">ts</span>(export<span class="sc">$</span>fx_rate,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-516"><a href="#cb164-516" aria-hidden="true" tabindex="-1"></a>export<span class="sc">$</span>gdp_nl<span class="ot">&lt;-</span><span class="fu">ts</span>(export<span class="sc">$</span>gdp_nl,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-517"><a href="#cb164-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-518"><a href="#cb164-518" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb164-519"><a href="#cb164-519" aria-hidden="true" tabindex="-1"></a>fit_export.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(exports <span class="sc">~</span> consumption<span class="sc">+</span>fx_rate<span class="sc">+</span>gdp_nl, <span class="at">data=</span>export)</span>
<span id="cb164-520"><a href="#cb164-520" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_export.reg)</span>
<span id="cb164-521"><a href="#cb164-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-522"><a href="#cb164-522" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_export.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-523"><a href="#cb164-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-524"><a href="#cb164-524" aria-hidden="true" tabindex="-1"></a>The ACF plot indicates significant autocorrelations at multiple lags. This is a strong indication that the model has not fully captured the autocorrelative structure of the data, and there may be additional lags or other dependencies that should be incorporated into the model. The shape of residual plot is also not perfectly symmetrical, indicating skewness in the distribution of residuals. Overall, the residuals exhibit some problematic features such as trends, heavy tails, skewness, and significant autocorrelation, all of which suggest that the current model could be improved to better fit the underlying dynamics of the data.</span>
<span id="cb164-525"><a href="#cb164-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-526"><a href="#cb164-526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-527"><a href="#cb164-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-530"><a href="#cb164-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-531"><a href="#cb164-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-532"><a href="#cb164-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-533"><a href="#cb164-533" aria-hidden="true" tabindex="-1"></a>env_impact<span class="sc">$</span>co2_value<span class="ot">&lt;-</span><span class="fu">ts</span>(env_impact<span class="sc">$</span>co2_value,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-534"><a href="#cb164-534" aria-hidden="true" tabindex="-1"></a>env_impact<span class="sc">$</span>Consumption<span class="ot">&lt;-</span><span class="fu">ts</span>(env_impact<span class="sc">$</span>Consumption,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-535"><a href="#cb164-535" aria-hidden="true" tabindex="-1"></a>env_impact<span class="sc">$</span>Production<span class="ot">&lt;-</span><span class="fu">ts</span>(env_impact<span class="sc">$</span>Production,<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-536"><a href="#cb164-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-537"><a href="#cb164-537" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb164-538"><a href="#cb164-538" aria-hidden="true" tabindex="-1"></a>fit_env_impact.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(co2_value <span class="sc">~</span> Consumption<span class="sc">+</span>Production, <span class="at">data=</span>env_impact)</span>
<span id="cb164-539"><a href="#cb164-539" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_env_impact.reg)</span>
<span id="cb164-540"><a href="#cb164-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-541"><a href="#cb164-541" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_env_impact.reg, <span class="at">theme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb164-542"><a href="#cb164-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-543"><a href="#cb164-543" aria-hidden="true" tabindex="-1"></a>ACF Plot suggests that there is little autocorrelation in the residuals, indicating that the model has accounted for the time series autocorrelation effectively.For the distribution of Residuals plot, while there's a noticeable peak that aligns with the normal distribution, the long tails suggest the presence of outliers or extreme values that the model did not predict accurately.</span>
<span id="cb164-544"><a href="#cb164-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-545"><a href="#cb164-545" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-546"><a href="#cb164-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-547"><a href="#cb164-547" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting residuals</span></span>
<span id="cb164-548"><a href="#cb164-548" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-549"><a href="#cb164-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-550"><a href="#cb164-550" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-551"><a href="#cb164-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-554"><a href="#cb164-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-555"><a href="#cb164-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-556"><a href="#cb164-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-557"><a href="#cb164-557" aria-hidden="true" tabindex="-1"></a>res.fit_demand<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_demand.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-558"><a href="#cb164-558" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb164-559"><a href="#cb164-559" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_demand,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span>
<span id="cb164-560"><a href="#cb164-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-561"><a href="#cb164-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-564"><a href="#cb164-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-565"><a href="#cb164-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-566"><a href="#cb164-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-567"><a href="#cb164-567" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_demand,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span>
<span id="cb164-568"><a href="#cb164-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-571"><a href="#cb164-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-572"><a href="#cb164-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-573"><a href="#cb164-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-574"><a href="#cb164-574" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(res.fit_demand, <span class="at">lag =</span> <span class="dv">12</span>),<span class="at">main=</span><span class="st">"ACF Plot: Seasonality"</span>)</span>
<span id="cb164-575"><a href="#cb164-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-576"><a href="#cb164-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-579"><a href="#cb164-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-580"><a href="#cb164-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-581"><a href="#cb164-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-582"><a href="#cb164-582" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(<span class="fu">diff</span>(res.fit_demand, <span class="at">lag =</span> <span class="dv">12</span>),<span class="at">main=</span><span class="st">"PACF Plot: Seasonality"</span>)</span>
<span id="cb164-583"><a href="#cb164-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-584"><a href="#cb164-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-585"><a href="#cb164-585" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-588"><a href="#cb164-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-589"><a href="#cb164-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-590"><a href="#cb164-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-591"><a href="#cb164-591" aria-hidden="true" tabindex="-1"></a>res.fit_eco<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_eco.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-592"><a href="#cb164-592" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb164-593"><a href="#cb164-593" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_eco,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span>
<span id="cb164-594"><a href="#cb164-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-595"><a href="#cb164-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-598"><a href="#cb164-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-599"><a href="#cb164-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-600"><a href="#cb164-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-601"><a href="#cb164-601" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_eco,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span>
<span id="cb164-602"><a href="#cb164-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-603"><a href="#cb164-603" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-606"><a href="#cb164-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-607"><a href="#cb164-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-608"><a href="#cb164-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-609"><a href="#cb164-609" aria-hidden="true" tabindex="-1"></a>res.fit_export<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_export.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb164-610"><a href="#cb164-610" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb164-611"><a href="#cb164-611" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_export,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span>
<span id="cb164-612"><a href="#cb164-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-615"><a href="#cb164-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-616"><a href="#cb164-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-617"><a href="#cb164-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-618"><a href="#cb164-618" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_export,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span>
<span id="cb164-619"><a href="#cb164-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-620"><a href="#cb164-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-621"><a href="#cb164-621" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-622"><a href="#cb164-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-625"><a href="#cb164-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-626"><a href="#cb164-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-627"><a href="#cb164-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-628"><a href="#cb164-628" aria-hidden="true" tabindex="-1"></a>res.fit_env_impact<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit_env_impact.reg),<span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-629"><a href="#cb164-629" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb164-630"><a href="#cb164-630" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res.fit_env_impact,<span class="at">main=</span><span class="st">"ACF Plot"</span>)</span>
<span id="cb164-631"><a href="#cb164-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-634"><a href="#cb164-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-635"><a href="#cb164-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-636"><a href="#cb164-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-637"><a href="#cb164-637" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(res.fit_env_impact,<span class="at">main=</span><span class="st">"PACF Plot"</span>)</span>
<span id="cb164-638"><a href="#cb164-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-639"><a href="#cb164-639" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-640"><a href="#cb164-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-641"><a href="#cb164-641" aria-hidden="true" tabindex="-1"></a><span class="fu">### Finding Model Parameters</span></span>
<span id="cb164-642"><a href="#cb164-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-643"><a href="#cb164-643" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-644"><a href="#cb164-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-645"><a href="#cb164-645" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-646"><a href="#cb164-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-647"><a href="#cb164-647" aria-hidden="true" tabindex="-1"></a>p = 1,2,3,4</span>
<span id="cb164-648"><a href="#cb164-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-649"><a href="#cb164-649" aria-hidden="true" tabindex="-1"></a>q = 1,2,3,4</span>
<span id="cb164-650"><a href="#cb164-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-651"><a href="#cb164-651" aria-hidden="true" tabindex="-1"></a>P = 1</span>
<span id="cb164-652"><a href="#cb164-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-653"><a href="#cb164-653" aria-hidden="true" tabindex="-1"></a>Q = 1,2,3</span>
<span id="cb164-654"><a href="#cb164-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-655"><a href="#cb164-655" aria-hidden="true" tabindex="-1"></a>D = 1</span>
<span id="cb164-656"><a href="#cb164-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-657"><a href="#cb164-657" aria-hidden="true" tabindex="-1"></a>d = 0</span>
<span id="cb164-658"><a href="#cb164-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-661"><a href="#cb164-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-662"><a href="#cb164-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-663"><a href="#cb164-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-664"><a href="#cb164-664" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,d1,d2,data){</span>
<span id="cb164-665"><a href="#cb164-665" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-666"><a href="#cb164-666" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb164-667"><a href="#cb164-667" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb164-668"><a href="#cb164-668" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb164-669"><a href="#cb164-669" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-670"><a href="#cb164-670" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb164-671"><a href="#cb164-671" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb164-672"><a href="#cb164-672" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">150</span>),<span class="at">nrow=</span><span class="dv">150</span>)</span>
<span id="cb164-673"><a href="#cb164-673" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-674"><a href="#cb164-674" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-675"><a href="#cb164-675" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb164-676"><a href="#cb164-676" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb164-677"><a href="#cb164-677" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb164-678"><a href="#cb164-678" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb164-679"><a href="#cb164-679" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb164-680"><a href="#cb164-680" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb164-681"><a href="#cb164-681" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb164-682"><a href="#cb164-682" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb164-683"><a href="#cb164-683" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span>(d <span class="cf">in</span> d1<span class="sc">:</span>d2)</span>
<span id="cb164-684"><a href="#cb164-684" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb164-685"><a href="#cb164-685" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb164-686"><a href="#cb164-686" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">10</span>)</span>
<span id="cb164-687"><a href="#cb164-687" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb164-688"><a href="#cb164-688" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb164-689"><a href="#cb164-689" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>),<span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb164-690"><a href="#cb164-690" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb164-691"><a href="#cb164-691" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb164-692"><a href="#cb164-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-693"><a href="#cb164-693" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb164-694"><a href="#cb164-694" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb164-695"><a href="#cb164-695" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb164-696"><a href="#cb164-696" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb164-697"><a href="#cb164-697" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb164-698"><a href="#cb164-698" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-699"><a href="#cb164-699" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb164-700"><a href="#cb164-700" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-701"><a href="#cb164-701" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb164-702"><a href="#cb164-702" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb164-703"><a href="#cb164-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb164-704"><a href="#cb164-704" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-705"><a href="#cb164-705" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb164-706"><a href="#cb164-706" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-707"><a href="#cb164-707" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-708"><a href="#cb164-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-709"><a href="#cb164-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-710"><a href="#cb164-710" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">4</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">4</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">1</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">3</span>,<span class="at">d1=</span><span class="dv">0</span>,<span class="at">d2=</span><span class="dv">0</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_demand.reg))</span>
<span id="cb164-711"><a href="#cb164-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-712"><a href="#cb164-712" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb164-713"><a href="#cb164-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-714"><a href="#cb164-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-717"><a href="#cb164-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-718"><a href="#cb164-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-719"><a href="#cb164-719" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-720"><a href="#cb164-720" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span>
<span id="cb164-721"><a href="#cb164-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-722"><a href="#cb164-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-725"><a href="#cb164-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-726"><a href="#cb164-726" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-727"><a href="#cb164-727" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-728"><a href="#cb164-728" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span>
<span id="cb164-729"><a href="#cb164-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-730"><a href="#cb164-730" aria-hidden="true" tabindex="-1"></a>Model 1 (Best Model) : ARIMA(3,0,2)(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span>  </span>
<span id="cb164-731"><a href="#cb164-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-732"><a href="#cb164-732" aria-hidden="true" tabindex="-1"></a>Model 2 (Auto Arima): ARIMA(0,0,2)(0,1,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb164-733"><a href="#cb164-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-734"><a href="#cb164-734" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-735"><a href="#cb164-735" aria-hidden="true" tabindex="-1"></a>p = 1</span>
<span id="cb164-736"><a href="#cb164-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-737"><a href="#cb164-737" aria-hidden="true" tabindex="-1"></a>q = 1,2,3,4</span>
<span id="cb164-738"><a href="#cb164-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-739"><a href="#cb164-739" aria-hidden="true" tabindex="-1"></a>d = 0,1</span>
<span id="cb164-740"><a href="#cb164-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-743"><a href="#cb164-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-744"><a href="#cb164-744" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-745"><a href="#cb164-745" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-746"><a href="#cb164-746" aria-hidden="true" tabindex="-1"></a>ARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,data){</span>
<span id="cb164-747"><a href="#cb164-747" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb164-748"><a href="#cb164-748" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb164-749"><a href="#cb164-749" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb164-750"><a href="#cb164-750" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">30</span>),<span class="at">nrow=</span><span class="dv">30</span>)</span>
<span id="cb164-751"><a href="#cb164-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-752"><a href="#cb164-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-753"><a href="#cb164-753" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)<span class="co">#</span></span>
<span id="cb164-754"><a href="#cb164-754" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-755"><a href="#cb164-755" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)<span class="co">#</span></span>
<span id="cb164-756"><a href="#cb164-756" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb164-757"><a href="#cb164-757" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb164-758"><a href="#cb164-758" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb164-759"><a href="#cb164-759" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb164-760"><a href="#cb164-760" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb164-761"><a href="#cb164-761" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb164-762"><a href="#cb164-762" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb164-763"><a href="#cb164-763" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p,d,q))</span>
<span id="cb164-764"><a href="#cb164-764" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb164-765"><a href="#cb164-765" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb164-766"><a href="#cb164-766" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb164-767"><a href="#cb164-767" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb164-768"><a href="#cb164-768" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb164-769"><a href="#cb164-769" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb164-770"><a href="#cb164-770" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb164-771"><a href="#cb164-771" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb164-772"><a href="#cb164-772" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-773"><a href="#cb164-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-774"><a href="#cb164-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-775"><a href="#cb164-775" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb164-776"><a href="#cb164-776" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb164-777"><a href="#cb164-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-778"><a href="#cb164-778" aria-hidden="true" tabindex="-1"></a>temp</span>
<span id="cb164-779"><a href="#cb164-779" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-780"><a href="#cb164-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-781"><a href="#cb164-781" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ARIMA.c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_eco.reg))</span>
<span id="cb164-782"><a href="#cb164-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-783"><a href="#cb164-783" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb164-784"><a href="#cb164-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-787"><a href="#cb164-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-788"><a href="#cb164-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-789"><a href="#cb164-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-790"><a href="#cb164-790" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span>
<span id="cb164-791"><a href="#cb164-791" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-792"><a href="#cb164-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-795"><a href="#cb164-795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-796"><a href="#cb164-796" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-797"><a href="#cb164-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-798"><a href="#cb164-798" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span>
<span id="cb164-799"><a href="#cb164-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-800"><a href="#cb164-800" aria-hidden="true" tabindex="-1"></a>Model 1 (Best Model) : ARIMA(0,1,3)</span>
<span id="cb164-801"><a href="#cb164-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-802"><a href="#cb164-802" aria-hidden="true" tabindex="-1"></a>Model 2 (Second Best Model) : ARIMA(0,1,0)</span>
<span id="cb164-803"><a href="#cb164-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-804"><a href="#cb164-804" aria-hidden="true" tabindex="-1"></a>Model 3 (Auto Arima): ARIMA(0,1,0)(0,0,2)<span class="co">[</span><span class="ot">4</span><span class="co">]</span></span>
<span id="cb164-805"><a href="#cb164-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-806"><a href="#cb164-806" aria-hidden="true" tabindex="-1"></a>Although Auto Arima have seasonal components, I opted for an ARIMA model over SARIMA based on manual analysis, which indicated that the seasonal components (P=0, D=0, Q=0) were unnecessary. This simpler ARIMA model aligns with the principle of parsimony, avoiding overfitting while adequately modeling the data without the inclusion of statistically insignificant seasonal terms.</span>
<span id="cb164-807"><a href="#cb164-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-808"><a href="#cb164-808" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-809"><a href="#cb164-809" aria-hidden="true" tabindex="-1"></a>p = 1</span>
<span id="cb164-810"><a href="#cb164-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-811"><a href="#cb164-811" aria-hidden="true" tabindex="-1"></a>q = 1,2,3,4</span>
<span id="cb164-812"><a href="#cb164-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-813"><a href="#cb164-813" aria-hidden="true" tabindex="-1"></a>d = 0,1</span>
<span id="cb164-814"><a href="#cb164-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-817"><a href="#cb164-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-818"><a href="#cb164-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-819"><a href="#cb164-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-820"><a href="#cb164-820" aria-hidden="true" tabindex="-1"></a>ARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,data){</span>
<span id="cb164-821"><a href="#cb164-821" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb164-822"><a href="#cb164-822" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb164-823"><a href="#cb164-823" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb164-824"><a href="#cb164-824" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">30</span>),<span class="at">nrow=</span><span class="dv">30</span>)</span>
<span id="cb164-825"><a href="#cb164-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-826"><a href="#cb164-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-827"><a href="#cb164-827" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)<span class="co">#</span></span>
<span id="cb164-828"><a href="#cb164-828" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-829"><a href="#cb164-829" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)<span class="co">#</span></span>
<span id="cb164-830"><a href="#cb164-830" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb164-831"><a href="#cb164-831" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb164-832"><a href="#cb164-832" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb164-833"><a href="#cb164-833" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb164-834"><a href="#cb164-834" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb164-835"><a href="#cb164-835" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb164-836"><a href="#cb164-836" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb164-837"><a href="#cb164-837" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p,d,q))</span>
<span id="cb164-838"><a href="#cb164-838" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb164-839"><a href="#cb164-839" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb164-840"><a href="#cb164-840" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb164-841"><a href="#cb164-841" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb164-842"><a href="#cb164-842" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb164-843"><a href="#cb164-843" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb164-844"><a href="#cb164-844" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb164-845"><a href="#cb164-845" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb164-846"><a href="#cb164-846" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-847"><a href="#cb164-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-848"><a href="#cb164-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-849"><a href="#cb164-849" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb164-850"><a href="#cb164-850" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb164-851"><a href="#cb164-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-852"><a href="#cb164-852" aria-hidden="true" tabindex="-1"></a>temp</span>
<span id="cb164-853"><a href="#cb164-853" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-854"><a href="#cb164-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-855"><a href="#cb164-855" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ARIMA.c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_export.reg))</span>
<span id="cb164-856"><a href="#cb164-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-857"><a href="#cb164-857" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb164-858"><a href="#cb164-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-861"><a href="#cb164-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-862"><a href="#cb164-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-863"><a href="#cb164-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-864"><a href="#cb164-864" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span>
<span id="cb164-865"><a href="#cb164-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-866"><a href="#cb164-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-869"><a href="#cb164-869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-870"><a href="#cb164-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-871"><a href="#cb164-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-872"><a href="#cb164-872" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span>
<span id="cb164-873"><a href="#cb164-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-874"><a href="#cb164-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-875"><a href="#cb164-875" aria-hidden="true" tabindex="-1"></a>Model 1 (Best Model) : ARIMA(1,1,1)</span>
<span id="cb164-876"><a href="#cb164-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-877"><a href="#cb164-877" aria-hidden="true" tabindex="-1"></a>Model 2 (Second Best Model) : ARIMA(1,1,0)</span>
<span id="cb164-878"><a href="#cb164-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-879"><a href="#cb164-879" aria-hidden="true" tabindex="-1"></a>Model 3 (Auto Arima): ARIMA(1,0,0)</span>
<span id="cb164-880"><a href="#cb164-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-881"><a href="#cb164-881" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-882"><a href="#cb164-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-883"><a href="#cb164-883" aria-hidden="true" tabindex="-1"></a>p = 1,2,3</span>
<span id="cb164-884"><a href="#cb164-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-885"><a href="#cb164-885" aria-hidden="true" tabindex="-1"></a>q = 1</span>
<span id="cb164-886"><a href="#cb164-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-887"><a href="#cb164-887" aria-hidden="true" tabindex="-1"></a>d = 0,1</span>
<span id="cb164-888"><a href="#cb164-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-891"><a href="#cb164-891" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-892"><a href="#cb164-892" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-893"><a href="#cb164-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-894"><a href="#cb164-894" aria-hidden="true" tabindex="-1"></a>ARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,data){</span>
<span id="cb164-895"><a href="#cb164-895" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb164-896"><a href="#cb164-896" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb164-897"><a href="#cb164-897" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb164-898"><a href="#cb164-898" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">30</span>),<span class="at">nrow=</span><span class="dv">30</span>)</span>
<span id="cb164-899"><a href="#cb164-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-900"><a href="#cb164-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-901"><a href="#cb164-901" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)<span class="co">#</span></span>
<span id="cb164-902"><a href="#cb164-902" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-903"><a href="#cb164-903" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)<span class="co">#</span></span>
<span id="cb164-904"><a href="#cb164-904" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb164-905"><a href="#cb164-905" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb164-906"><a href="#cb164-906" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb164-907"><a href="#cb164-907" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb164-908"><a href="#cb164-908" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb164-909"><a href="#cb164-909" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb164-910"><a href="#cb164-910" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb164-911"><a href="#cb164-911" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p,d,q))</span>
<span id="cb164-912"><a href="#cb164-912" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb164-913"><a href="#cb164-913" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb164-914"><a href="#cb164-914" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb164-915"><a href="#cb164-915" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb164-916"><a href="#cb164-916" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb164-917"><a href="#cb164-917" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb164-918"><a href="#cb164-918" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb164-919"><a href="#cb164-919" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb164-920"><a href="#cb164-920" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-921"><a href="#cb164-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-922"><a href="#cb164-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-923"><a href="#cb164-923" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb164-924"><a href="#cb164-924" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb164-925"><a href="#cb164-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-926"><a href="#cb164-926" aria-hidden="true" tabindex="-1"></a>temp</span>
<span id="cb164-927"><a href="#cb164-927" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-928"><a href="#cb164-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-929"><a href="#cb164-929" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ARIMA.c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="at">data=</span><span class="fu">residuals</span>(fit_env_impact.reg))</span>
<span id="cb164-930"><a href="#cb164-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-931"><a href="#cb164-931" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb164-932"><a href="#cb164-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-935"><a href="#cb164-935" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-936"><a href="#cb164-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-937"><a href="#cb164-937" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-938"><a href="#cb164-938" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span>
<span id="cb164-939"><a href="#cb164-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-940"><a href="#cb164-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-943"><a href="#cb164-943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-944"><a href="#cb164-944" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-945"><a href="#cb164-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-946"><a href="#cb164-946" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span>
<span id="cb164-947"><a href="#cb164-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-948"><a href="#cb164-948" aria-hidden="true" tabindex="-1"></a>Model 1 (Best Model) : ARIMA(2,0,1)</span>
<span id="cb164-949"><a href="#cb164-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-950"><a href="#cb164-950" aria-hidden="true" tabindex="-1"></a>Model 2 (Second Best Model) : ARIMA(1,0,1)</span>
<span id="cb164-951"><a href="#cb164-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-952"><a href="#cb164-952" aria-hidden="true" tabindex="-1"></a>Model 3 (Auto Arima): ARIMA(0,0,1)(0,0,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb164-953"><a href="#cb164-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-954"><a href="#cb164-954" aria-hidden="true" tabindex="-1"></a>Although Auto Arima have seasonal components, I opted for an ARIMA model over SARIMA based on manual analysis, which indicated that the seasonal components (P=0, D=0, Q=0) were unnecessary. This simpler ARIMA model aligns with the principle of parsimony, avoiding overfitting while adequately modeling the data without the inclusion of statistically insignificant seasonal terms.</span>
<span id="cb164-955"><a href="#cb164-955" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-956"><a href="#cb164-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-957"><a href="#cb164-957" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Diagnostics</span></span>
<span id="cb164-958"><a href="#cb164-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-959"><a href="#cb164-959" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-960"><a href="#cb164-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-961"><a href="#cb164-961" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-962"><a href="#cb164-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-963"><a href="#cb164-963" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-964"><a href="#cb164-964" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb164-965"><a href="#cb164-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-968"><a href="#cb164-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-969"><a href="#cb164-969" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-970"><a href="#cb164-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-971"><a href="#cb164-971" aria-hidden="true" tabindex="-1"></a>model_output_demand1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_demand, <span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>)) </span>
<span id="cb164-972"><a href="#cb164-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-973"><a href="#cb164-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-976"><a href="#cb164-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-977"><a href="#cb164-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-978"><a href="#cb164-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-979"><a href="#cb164-979" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_demand1[<span class="dv">98</span><span class="sc">:</span><span class="dv">109</span>], model_output_demand1[<span class="fu">length</span>(model_output_demand1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-980"><a href="#cb164-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-981"><a href="#cb164-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-982"><a href="#cb164-982" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb164-983"><a href="#cb164-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-986"><a href="#cb164-986" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-987"><a href="#cb164-987" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-988"><a href="#cb164-988" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-989"><a href="#cb164-989" aria-hidden="true" tabindex="-1"></a>model_output_demand2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_demand, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>)) </span>
<span id="cb164-990"><a href="#cb164-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-991"><a href="#cb164-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-994"><a href="#cb164-994" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-995"><a href="#cb164-995" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-996"><a href="#cb164-996" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-997"><a href="#cb164-997" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_demand2[<span class="dv">28</span><span class="sc">:</span><span class="dv">38</span>], model_output_demand2[<span class="fu">length</span>(model_output_demand2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-998"><a href="#cb164-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-999"><a href="#cb164-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1000"><a href="#cb164-1000" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1001"><a href="#cb164-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1002"><a href="#cb164-1002" aria-hidden="true" tabindex="-1"></a>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for both the models. The Q-Q plot suggest that the residuals are normally distributed for both the models.From the Ljung-Box Test, the p-values for model 2 are typically above 0.05 suggesting that the residuals are  random, which is  desirable in a good model fit. On comparing AIC, AICc, model 2 has lower values indicating a better fit.</span>
<span id="cb164-1003"><a href="#cb164-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1004"><a href="#cb164-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-1005"><a href="#cb164-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1006"><a href="#cb164-1006" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1007"><a href="#cb164-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb164-1008"><a href="#cb164-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1011"><a href="#cb164-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1012"><a href="#cb164-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1013"><a href="#cb164-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1014"><a href="#cb164-1014" aria-hidden="true" tabindex="-1"></a>model_output_eco1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_eco, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)) </span>
<span id="cb164-1015"><a href="#cb164-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1018"><a href="#cb164-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1019"><a href="#cb164-1019" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1020"><a href="#cb164-1020" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1021"><a href="#cb164-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_eco1[<span class="dv">26</span><span class="sc">:</span><span class="dv">35</span>], model_output_eco1[<span class="fu">length</span>(model_output_eco1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1022"><a href="#cb164-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1023"><a href="#cb164-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1024"><a href="#cb164-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb164-1025"><a href="#cb164-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1028"><a href="#cb164-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1029"><a href="#cb164-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1030"><a href="#cb164-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1031"><a href="#cb164-1031" aria-hidden="true" tabindex="-1"></a>model_output_eco2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_eco, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb164-1032"><a href="#cb164-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1033"><a href="#cb164-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1034"><a href="#cb164-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1037"><a href="#cb164-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1038"><a href="#cb164-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1039"><a href="#cb164-1039" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1040"><a href="#cb164-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_eco2[<span class="dv">10</span><span class="sc">:</span><span class="dv">17</span>], model_output_eco2[<span class="fu">length</span>(model_output_eco2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1041"><a href="#cb164-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1042"><a href="#cb164-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1043"><a href="#cb164-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 3</span></span>
<span id="cb164-1044"><a href="#cb164-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1047"><a href="#cb164-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1048"><a href="#cb164-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1049"><a href="#cb164-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1050"><a href="#cb164-1050" aria-hidden="true" tabindex="-1"></a>model_output_eco3 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_eco, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>)) </span>
<span id="cb164-1051"><a href="#cb164-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1052"><a href="#cb164-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1055"><a href="#cb164-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1056"><a href="#cb164-1056" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1057"><a href="#cb164-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1058"><a href="#cb164-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_eco3[<span class="dv">25</span><span class="sc">:</span><span class="dv">34</span>], model_output_eco3[<span class="fu">length</span>(model_output_eco3)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1059"><a href="#cb164-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1060"><a href="#cb164-1060" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1061"><a href="#cb164-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1062"><a href="#cb164-1062" aria-hidden="true" tabindex="-1"></a>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for model 1 are typically above 0.05 suggesting that the residuals are random, which is  desirable in a good model fit. On comparing AIC, AICc, model 1 has lower values indicating a better fit.</span>
<span id="cb164-1063"><a href="#cb164-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1064"><a href="#cb164-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-1065"><a href="#cb164-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1066"><a href="#cb164-1066" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1067"><a href="#cb164-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb164-1068"><a href="#cb164-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1071"><a href="#cb164-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1072"><a href="#cb164-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1073"><a href="#cb164-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1074"><a href="#cb164-1074" aria-hidden="true" tabindex="-1"></a>model_output_export1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_export, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb164-1075"><a href="#cb164-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1078"><a href="#cb164-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1079"><a href="#cb164-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1080"><a href="#cb164-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1081"><a href="#cb164-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_export1[<span class="dv">152</span><span class="sc">:</span><span class="dv">161</span>], model_output_export1[<span class="fu">length</span>(model_output_export1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1082"><a href="#cb164-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1083"><a href="#cb164-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1084"><a href="#cb164-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb164-1085"><a href="#cb164-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1088"><a href="#cb164-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1089"><a href="#cb164-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1090"><a href="#cb164-1090" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1091"><a href="#cb164-1091" aria-hidden="true" tabindex="-1"></a>model_output_export2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_export, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb164-1092"><a href="#cb164-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1093"><a href="#cb164-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1096"><a href="#cb164-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1097"><a href="#cb164-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1098"><a href="#cb164-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1099"><a href="#cb164-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_export2[<span class="dv">20</span><span class="sc">:</span><span class="dv">28</span>], model_output_export2[<span class="fu">length</span>(model_output_export2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1100"><a href="#cb164-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1101"><a href="#cb164-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1102"><a href="#cb164-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 3</span></span>
<span id="cb164-1103"><a href="#cb164-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1106"><a href="#cb164-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1107"><a href="#cb164-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1108"><a href="#cb164-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1109"><a href="#cb164-1109" aria-hidden="true" tabindex="-1"></a>model_output_export3 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_export, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span>
<span id="cb164-1110"><a href="#cb164-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1111"><a href="#cb164-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1114"><a href="#cb164-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1115"><a href="#cb164-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1116"><a href="#cb164-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1117"><a href="#cb164-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_export3[<span class="dv">27</span><span class="sc">:</span><span class="dv">35</span>], model_output_export3[<span class="fu">length</span>(model_output_export3)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1118"><a href="#cb164-1118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1119"><a href="#cb164-1119" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1120"><a href="#cb164-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1121"><a href="#cb164-1121" aria-hidden="true" tabindex="-1"></a>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for all the models.From the Ljung-Box Test, the p-values for model 1 are typically above 0.05 suggesting that the residuals are random, which is  desirable in a good model fit. On comparing AIC, AICc, model 1 has lower values indicating a better fit.</span>
<span id="cb164-1122"><a href="#cb164-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1123"><a href="#cb164-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1124"><a href="#cb164-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-1125"><a href="#cb164-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1126"><a href="#cb164-1126" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1127"><a href="#cb164-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 1</span></span>
<span id="cb164-1128"><a href="#cb164-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1131"><a href="#cb164-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1132"><a href="#cb164-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1133"><a href="#cb164-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1134"><a href="#cb164-1134" aria-hidden="true" tabindex="-1"></a>model_output_env_impact1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_env_impact, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)) </span>
<span id="cb164-1135"><a href="#cb164-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1138"><a href="#cb164-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1139"><a href="#cb164-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1140"><a href="#cb164-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1141"><a href="#cb164-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_env_impact1[<span class="dv">26</span><span class="sc">:</span><span class="dv">37</span>], model_output_env_impact1[<span class="fu">length</span>(model_output_env_impact1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1142"><a href="#cb164-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1143"><a href="#cb164-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1144"><a href="#cb164-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 2</span></span>
<span id="cb164-1145"><a href="#cb164-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1148"><a href="#cb164-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1149"><a href="#cb164-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1150"><a href="#cb164-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1151"><a href="#cb164-1151" aria-hidden="true" tabindex="-1"></a>model_output_env_impact2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_env_impact, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)) </span>
<span id="cb164-1152"><a href="#cb164-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1153"><a href="#cb164-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1156"><a href="#cb164-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1157"><a href="#cb164-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1158"><a href="#cb164-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1159"><a href="#cb164-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_env_impact2[<span class="dv">29</span><span class="sc">:</span><span class="dv">37</span>], model_output_env_impact2[<span class="fu">length</span>(model_output_env_impact2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1160"><a href="#cb164-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1161"><a href="#cb164-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1162"><a href="#cb164-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model 3</span></span>
<span id="cb164-1163"><a href="#cb164-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1166"><a href="#cb164-1166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1167"><a href="#cb164-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1168"><a href="#cb164-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1169"><a href="#cb164-1169" aria-hidden="true" tabindex="-1"></a>model_output_env_impact3 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit_env_impact, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">12</span>)) </span>
<span id="cb164-1170"><a href="#cb164-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1171"><a href="#cb164-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1174"><a href="#cb164-1174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1175"><a href="#cb164-1175" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1176"><a href="#cb164-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1177"><a href="#cb164-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output_env_impact3[<span class="dv">38</span><span class="sc">:</span><span class="dv">47</span>], model_output_env_impact3[<span class="fu">length</span>(model_output_env_impact3)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb164-1178"><a href="#cb164-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1179"><a href="#cb164-1179" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1180"><a href="#cb164-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1181"><a href="#cb164-1181" aria-hidden="true" tabindex="-1"></a>The ACF plot reveals that most autocorrelation values are indeed within the confidence interval, indicating a good fit for all the models. The Q-Q plot suggest that the residuals are normally distributed for model 3.From the Ljung-Box Test, the p-values for model 1 and 2 are typically above 0.05 suggesting that the residuals are  random, which is  desirable in a good model fit. On comparing AIC, AICc, model 3 has lower values indicating a better fit.</span>
<span id="cb164-1182"><a href="#cb164-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1183"><a href="#cb164-1183" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1184"><a href="#cb164-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1185"><a href="#cb164-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cross Validation</span></span>
<span id="cb164-1186"><a href="#cb164-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1187"><a href="#cb164-1187" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1188"><a href="#cb164-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1189"><a href="#cb164-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-1190"><a href="#cb164-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1191"><a href="#cb164-1191" aria-hidden="true" tabindex="-1"></a>Model 1 (Best Model) : ARIMA(3,0,2)(0,1,0)<span class="co">[</span><span class="ot">12</span><span class="co">]</span>  </span>
<span id="cb164-1192"><a href="#cb164-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1193"><a href="#cb164-1193" aria-hidden="true" tabindex="-1"></a>Model 2 (Auto Arima): ARIMA(0,0,2)(0,1,2)<span class="co">[</span><span class="ot">12</span><span class="co">]</span></span>
<span id="cb164-1194"><a href="#cb164-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1197"><a href="#cb164-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1198"><a href="#cb164-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1199"><a href="#cb164-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1200"><a href="#cb164-1200" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_demand</span>
<span id="cb164-1201"><a href="#cb164-1201" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1202"><a href="#cb164-1202" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-1203"><a href="#cb164-1203" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">124</span><span class="co"># first training set length </span></span>
<span id="cb164-1204"><a href="#cb164-1204" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb164-1205"><a href="#cb164-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1206"><a href="#cb164-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb164-1207"><a href="#cb164-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1208"><a href="#cb164-1208" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb164-1209"><a href="#cb164-1209" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1210"><a href="#cb164-1210" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1211"><a href="#cb164-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1212"><a href="#cb164-1212" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1213"><a href="#cb164-1213" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1214"><a href="#cb164-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1215"><a href="#cb164-1215" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb164-1216"><a href="#cb164-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1217"><a href="#cb164-1217" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb164-1218"><a href="#cb164-1218" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-1219"><a href="#cb164-1219" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb164-1220"><a href="#cb164-1220" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb164-1221"><a href="#cb164-1221" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb164-1222"><a href="#cb164-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1223"><a href="#cb164-1223" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb164-1224"><a href="#cb164-1224" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb164-1225"><a href="#cb164-1225" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb164-1226"><a href="#cb164-1226" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1227"><a href="#cb164-1227" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb164-1228"><a href="#cb164-1228" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb164-1229"><a href="#cb164-1229" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb164-1230"><a href="#cb164-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1231"><a href="#cb164-1231" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1232"><a href="#cb164-1232" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1233"><a href="#cb164-1233" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1234"><a href="#cb164-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1235"><a href="#cb164-1235" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb164-1236"><a href="#cb164-1236" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1237"><a href="#cb164-1237" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1238"><a href="#cb164-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1239"><a href="#cb164-1239" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-1240"><a href="#cb164-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1241"><a href="#cb164-1241" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb164-1242"><a href="#cb164-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1243"><a href="#cb164-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:SARIMA(3,0,2)x(0,1,0)"</span>,<span class="st">"Fit2:SARIMA(0,0,2)x(0,1,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1244"><a href="#cb164-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1245"><a href="#cb164-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1248"><a href="#cb164-1248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1249"><a href="#cb164-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1250"><a href="#cb164-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1251"><a href="#cb164-1251" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb164-1252"><a href="#cb164-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1253"><a href="#cb164-1253" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1254"><a href="#cb164-1254" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1255"><a href="#cb164-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1256"><a href="#cb164-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb164-1257"><a href="#cb164-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1258"><a href="#cb164-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1259"><a href="#cb164-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:SARIMA(3,0,2)x(0,1,0)"</span>,<span class="st">"Fit2:SARIMA(0,0,2)x(0,1,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1260"><a href="#cb164-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1261"><a href="#cb164-1261" aria-hidden="true" tabindex="-1"></a>Fit2:SARIMA(0,0,2)x(0,1,2) is better as it has lower MSE and RMSE.</span>
<span id="cb164-1262"><a href="#cb164-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1263"><a href="#cb164-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-1266"><a href="#cb164-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1267"><a href="#cb164-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1268"><a href="#cb164-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1269"><a href="#cb164-1269" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_eco</span>
<span id="cb164-1270"><a href="#cb164-1270" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1271"><a href="#cb164-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-1272"><a href="#cb164-1272" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">51</span><span class="co"># first training set length </span></span>
<span id="cb164-1273"><a href="#cb164-1273" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb164-1274"><a href="#cb164-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1275"><a href="#cb164-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb164-1276"><a href="#cb164-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1277"><a href="#cb164-1277" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb164-1278"><a href="#cb164-1278" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1279"><a href="#cb164-1279" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1280"><a href="#cb164-1280" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1281"><a href="#cb164-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1282"><a href="#cb164-1282" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1283"><a href="#cb164-1283" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1284"><a href="#cb164-1284" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1285"><a href="#cb164-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1286"><a href="#cb164-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1287"><a href="#cb164-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1288"><a href="#cb164-1288" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb164-1289"><a href="#cb164-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1290"><a href="#cb164-1290" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb164-1291"><a href="#cb164-1291" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-1292"><a href="#cb164-1292" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb164-1293"><a href="#cb164-1293" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb164-1294"><a href="#cb164-1294" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb164-1295"><a href="#cb164-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1296"><a href="#cb164-1296" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1297"><a href="#cb164-1297" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb164-1298"><a href="#cb164-1298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1299"><a href="#cb164-1299" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1300"><a href="#cb164-1300" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb164-1301"><a href="#cb164-1301" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb164-1302"><a href="#cb164-1302" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">4</span>),</span>
<span id="cb164-1303"><a href="#cb164-1303" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb164-1304"><a href="#cb164-1304" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb164-1305"><a href="#cb164-1305" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1306"><a href="#cb164-1306" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1307"><a href="#cb164-1307" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1308"><a href="#cb164-1308" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1309"><a href="#cb164-1309" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1310"><a href="#cb164-1310" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb164-1311"><a href="#cb164-1311" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1312"><a href="#cb164-1312" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1313"><a href="#cb164-1313" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1314"><a href="#cb164-1314" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1315"><a href="#cb164-1315" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1316"><a href="#cb164-1316" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-1317"><a href="#cb164-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1318"><a href="#cb164-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb164-1319"><a href="#cb164-1319" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1320"><a href="#cb164-1320" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1321"><a href="#cb164-1321" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(0,1,3)"</span>,<span class="st">"Fit2:ARIMA(0,1,0)"</span>,<span class="st">"Fit3:ARIMA(0,1,0)(0,0,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1322"><a href="#cb164-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1325"><a href="#cb164-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1326"><a href="#cb164-1326" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1327"><a href="#cb164-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1328"><a href="#cb164-1328" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb164-1329"><a href="#cb164-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1330"><a href="#cb164-1330" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1331"><a href="#cb164-1331" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1332"><a href="#cb164-1332" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1333"><a href="#cb164-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1334"><a href="#cb164-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1335"><a href="#cb164-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb164-1336"><a href="#cb164-1336" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1337"><a href="#cb164-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1338"><a href="#cb164-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(0,1,3)"</span>,<span class="st">"Fit2:ARIMA(0,1,0)"</span>,<span class="st">"Fit3:ARIMA(0,1,0)(0,0,2)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1339"><a href="#cb164-1339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1340"><a href="#cb164-1340" aria-hidden="true" tabindex="-1"></a>Fit2:ARIMA(0,1,0) is better as it has overall lower MSE and RMSE.</span>
<span id="cb164-1341"><a href="#cb164-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1342"><a href="#cb164-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-1343"><a href="#cb164-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1346"><a href="#cb164-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1347"><a href="#cb164-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1348"><a href="#cb164-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1349"><a href="#cb164-1349" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_export</span>
<span id="cb164-1350"><a href="#cb164-1350" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1351"><a href="#cb164-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-1352"><a href="#cb164-1352" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">51</span><span class="co"># first training set length </span></span>
<span id="cb164-1353"><a href="#cb164-1353" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb164-1354"><a href="#cb164-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1355"><a href="#cb164-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb164-1356"><a href="#cb164-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1357"><a href="#cb164-1357" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb164-1358"><a href="#cb164-1358" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1359"><a href="#cb164-1359" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1360"><a href="#cb164-1360" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1361"><a href="#cb164-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1362"><a href="#cb164-1362" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1363"><a href="#cb164-1363" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1364"><a href="#cb164-1364" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb164-1365"><a href="#cb164-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1366"><a href="#cb164-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1367"><a href="#cb164-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1368"><a href="#cb164-1368" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb164-1369"><a href="#cb164-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1370"><a href="#cb164-1370" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb164-1371"><a href="#cb164-1371" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-1372"><a href="#cb164-1372" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb164-1373"><a href="#cb164-1373" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb164-1374"><a href="#cb164-1374" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb164-1375"><a href="#cb164-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1376"><a href="#cb164-1376" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1377"><a href="#cb164-1377" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb164-1378"><a href="#cb164-1378" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1379"><a href="#cb164-1379" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1380"><a href="#cb164-1380" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb164-1381"><a href="#cb164-1381" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1382"><a href="#cb164-1382" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1383"><a href="#cb164-1383" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb164-1384"><a href="#cb164-1384" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1385"><a href="#cb164-1385" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1386"><a href="#cb164-1386" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1387"><a href="#cb164-1387" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1388"><a href="#cb164-1388" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1389"><a href="#cb164-1389" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb164-1390"><a href="#cb164-1390" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1391"><a href="#cb164-1391" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1392"><a href="#cb164-1392" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1393"><a href="#cb164-1393" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1394"><a href="#cb164-1394" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1395"><a href="#cb164-1395" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-1396"><a href="#cb164-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1397"><a href="#cb164-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb164-1398"><a href="#cb164-1398" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1399"><a href="#cb164-1399" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1400"><a href="#cb164-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(1,1,1)"</span>,<span class="st">"Fit2:ARIMA(1,1,0)"</span>,<span class="st">"Fit3:ARIMA(1,0,0)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1401"><a href="#cb164-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1402"><a href="#cb164-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1405"><a href="#cb164-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1406"><a href="#cb164-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1407"><a href="#cb164-1407" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1408"><a href="#cb164-1408" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb164-1409"><a href="#cb164-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1410"><a href="#cb164-1410" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1411"><a href="#cb164-1411" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1412"><a href="#cb164-1412" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1413"><a href="#cb164-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1414"><a href="#cb164-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1415"><a href="#cb164-1415" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb164-1416"><a href="#cb164-1416" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1417"><a href="#cb164-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1418"><a href="#cb164-1418" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(1,1,1)"</span>,<span class="st">"Fit2:ARIMA(1,1,0)"</span>,<span class="st">"Fit3:ARIMA(1,0,0)"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1419"><a href="#cb164-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1420"><a href="#cb164-1420" aria-hidden="true" tabindex="-1"></a>Fit3:ARIMA(1,0,0) is better as it has overall lower MSE and RMSE.</span>
<span id="cb164-1421"><a href="#cb164-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1422"><a href="#cb164-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-1423"><a href="#cb164-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1426"><a href="#cb164-1426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1427"><a href="#cb164-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1428"><a href="#cb164-1428" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1429"><a href="#cb164-1429" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>res.fit_env_impact</span>
<span id="cb164-1430"><a href="#cb164-1430" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1431"><a href="#cb164-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-1432"><a href="#cb164-1432" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">144</span><span class="co"># first training set length </span></span>
<span id="cb164-1433"><a href="#cb164-1433" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb164-1434"><a href="#cb164-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1435"><a href="#cb164-1435" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k=168; 168/12=14; k=144</span></span>
<span id="cb164-1436"><a href="#cb164-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1437"><a href="#cb164-1437" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix(NA,(n-k)/4,4)</span></span>
<span id="cb164-1438"><a href="#cb164-1438" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1439"><a href="#cb164-1439" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1440"><a href="#cb164-1440" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1441"><a href="#cb164-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1442"><a href="#cb164-1442" aria-hidden="true" tabindex="-1"></a>mae1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1443"><a href="#cb164-1443" aria-hidden="true" tabindex="-1"></a>mae2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1444"><a href="#cb164-1444" aria-hidden="true" tabindex="-1"></a>mae3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">4</span>,<span class="dv">12</span>)</span>
<span id="cb164-1445"><a href="#cb164-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1446"><a href="#cb164-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1447"><a href="#cb164-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1448"><a href="#cb164-1448" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(x)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb164-1449"><a href="#cb164-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1450"><a href="#cb164-1450" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k)<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb164-1451"><a href="#cb164-1451" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-1452"><a href="#cb164-1452" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xtrain &lt;- window(a10, start=st+(i-k+1)/4, end=st+i/4)</span></span>
<span id="cb164-1453"><a href="#cb164-1453" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb164-1454"><a href="#cb164-1454" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(x, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb164-1455"><a href="#cb164-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1456"><a href="#cb164-1456" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1457"><a href="#cb164-1457" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb164-1458"><a href="#cb164-1458" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1459"><a href="#cb164-1459" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span><span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>)</span>
<span id="cb164-1460"><a href="#cb164-1460" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb164-1461"><a href="#cb164-1461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1462"><a href="#cb164-1462" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>),</span>
<span id="cb164-1463"><a href="#cb164-1463" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>,  <span class="at">method=</span><span class="st">"CSS"</span>)</span>
<span id="cb164-1464"><a href="#cb164-1464" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb164-1465"><a href="#cb164-1465" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1466"><a href="#cb164-1466" aria-hidden="true" tabindex="-1"></a>  mae1[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1467"><a href="#cb164-1467" aria-hidden="true" tabindex="-1"></a>  mae2[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1468"><a href="#cb164-1468" aria-hidden="true" tabindex="-1"></a>  mae3[i,] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)</span>
<span id="cb164-1469"><a href="#cb164-1469" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1470"><a href="#cb164-1470" aria-hidden="true" tabindex="-1"></a>  <span class="do">####### to calculate RMSE ##########</span></span>
<span id="cb164-1471"><a href="#cb164-1471" aria-hidden="true" tabindex="-1"></a>  res1[i,] <span class="ot">&lt;-</span> (fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1472"><a href="#cb164-1472" aria-hidden="true" tabindex="-1"></a>  res2[i,] <span class="ot">&lt;-</span> (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1473"><a href="#cb164-1473" aria-hidden="true" tabindex="-1"></a>  res3[i,] <span class="ot">&lt;-</span> (fcast3<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb164-1474"><a href="#cb164-1474" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1475"><a href="#cb164-1475" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1476"><a href="#cb164-1476" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-1477"><a href="#cb164-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1478"><a href="#cb164-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"MAE"</span>)</span>
<span id="cb164-1479"><a href="#cb164-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1480"><a href="#cb164-1480" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(mae3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1481"><a href="#cb164-1481" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(2,0,1)"</span>,<span class="st">"Fit2:ARIMA(1,0,1)"</span>,<span class="st">"Fit3:ARIMA(0,0,1)(0,0,2)[12]"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1482"><a href="#cb164-1482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1485"><a href="#cb164-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1486"><a href="#cb164-1486" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1487"><a href="#cb164-1487" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1488"><a href="#cb164-1488" aria-hidden="true" tabindex="-1"></a><span class="do">########### RMSE ############</span></span>
<span id="cb164-1489"><a href="#cb164-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1490"><a href="#cb164-1490" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res1,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1491"><a href="#cb164-1491" aria-hidden="true" tabindex="-1"></a>rmse2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res2,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1492"><a href="#cb164-1492" aria-hidden="true" tabindex="-1"></a>rmse3<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">colMeans</span>(res3,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb164-1493"><a href="#cb164-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1494"><a href="#cb164-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1495"><a href="#cb164-1495" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb164-1496"><a href="#cb164-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse2, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1497"><a href="#cb164-1497" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, rmse3, <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1498"><a href="#cb164-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Fit1:ARIMA(2,0,1)"</span>,<span class="st">"Fit2:ARIMA(1,0,1)"</span>,<span class="st">"Fit3:ARIMA(0,0,1)(0,0,2)[12]"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1499"><a href="#cb164-1499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1500"><a href="#cb164-1500" aria-hidden="true" tabindex="-1"></a>Fit1:ARIMA(2,0,1) is better as it has overall lower MSE and RMSE.</span>
<span id="cb164-1501"><a href="#cb164-1501" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1502"><a href="#cb164-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1503"><a href="#cb164-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final Model Fitting</span></span>
<span id="cb164-1504"><a href="#cb164-1504" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1505"><a href="#cb164-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1506"><a href="#cb164-1506" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-1509"><a href="#cb164-1509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1510"><a href="#cb164-1510" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1511"><a href="#cb164-1511" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1512"><a href="#cb164-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb164-1513"><a href="#cb164-1513" aria-hidden="true" tabindex="-1"></a>xreg_demand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">temperature =</span> demand_ts[, <span class="st">"temperature"</span>], <span class="at">Production =</span> demand_ts[, <span class="st">"Production"</span>],</span>
<span id="cb164-1514"><a href="#cb164-1514" aria-hidden="true" tabindex="-1"></a>              <span class="at">storage =</span>  demand_ts[, <span class="st">"storage"</span>])</span>
<span id="cb164-1515"><a href="#cb164-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1516"><a href="#cb164-1516" aria-hidden="true" tabindex="-1"></a>fit_demand_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(demand_ts[, <span class="st">"Consumption"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">xreg=</span>xreg_demand)</span>
<span id="cb164-1517"><a href="#cb164-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_demand_ts)</span>
<span id="cb164-1518"><a href="#cb164-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1519"><a href="#cb164-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1520"><a href="#cb164-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1521"><a href="#cb164-1521" aria-hidden="true" tabindex="-1"></a>**Model_Equation**</span>
<span id="cb164-1522"><a href="#cb164-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb164-1523"><a href="#cb164-1523" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;p&gt;</span></span>
<span id="cb164-1524"><a href="#cb164-1524" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;span class="math display"&gt;</span></span>
<span id="cb164-1525"><a href="#cb164-1525" aria-hidden="true" tabindex="-1"></a><span class="in">        \(consumption_{t} = \mu+0.4815\varepsilon_{t-1} +0.2300\varepsilon_{t-2}−0.6999\varepsilon_{t-12}−0.1436\varepsilon_{t-24} \)&lt;/br&gt;</span></span>
<span id="cb164-1526"><a href="#cb164-1526" aria-hidden="true" tabindex="-1"></a><span class="in">        \(−30050.877temperature_t+0.5029Production_t−0.0279Storage_t+\varepsilon_t\)</span></span>
<span id="cb164-1527"><a href="#cb164-1527" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/span&gt;</span></span>
<span id="cb164-1528"><a href="#cb164-1528" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/p&gt;</span></span>
<span id="cb164-1529"><a href="#cb164-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1530"><a href="#cb164-1530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1531"><a href="#cb164-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1532"><a href="#cb164-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-1535"><a href="#cb164-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1536"><a href="#cb164-1536" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1537"><a href="#cb164-1537" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1538"><a href="#cb164-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb164-1539"><a href="#cb164-1539" aria-hidden="true" tabindex="-1"></a>xreg_eco <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="at">gdp =</span>  eco_ts[, <span class="st">"gdp"</span>],<span class="at">unemp =</span> eco_ts[, <span class="st">"unemp"</span>])</span>
<span id="cb164-1540"><a href="#cb164-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1541"><a href="#cb164-1541" aria-hidden="true" tabindex="-1"></a>fit_eco_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(eco_ts[, <span class="st">"price"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">xreg=</span>xreg_eco)</span>
<span id="cb164-1542"><a href="#cb164-1542" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_eco_ts)</span>
<span id="cb164-1543"><a href="#cb164-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1544"><a href="#cb164-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1545"><a href="#cb164-1545" aria-hidden="true" tabindex="-1"></a>**Model_Equation**</span>
<span id="cb164-1546"><a href="#cb164-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1547"><a href="#cb164-1547" aria-hidden="true" tabindex="-1"></a>$price_{t} = \mu+ (2e-04)gdp_t-0.0586unemp_t+\varepsilon_t$</span>
<span id="cb164-1548"><a href="#cb164-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1549"><a href="#cb164-1549" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-1552"><a href="#cb164-1552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1553"><a href="#cb164-1553" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1554"><a href="#cb164-1554" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1555"><a href="#cb164-1555" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb164-1556"><a href="#cb164-1556" aria-hidden="true" tabindex="-1"></a>xreg_export <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb164-1557"><a href="#cb164-1557" aria-hidden="true" tabindex="-1"></a>              <span class="at">consumption =</span>  export_ts[, <span class="st">"consumption"</span>],<span class="at">fx_rate =</span> export_ts[, <span class="st">"fx_rate"</span>],<span class="at">gdp_nl =</span> export_ts[, <span class="st">"gdp_nl"</span>])</span>
<span id="cb164-1558"><a href="#cb164-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1559"><a href="#cb164-1559" aria-hidden="true" tabindex="-1"></a>fit_export_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(export_ts[, <span class="st">"exports"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">xreg=</span>xreg_export)</span>
<span id="cb164-1560"><a href="#cb164-1560" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_export_ts)</span>
<span id="cb164-1561"><a href="#cb164-1561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1562"><a href="#cb164-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1563"><a href="#cb164-1563" aria-hidden="true" tabindex="-1"></a>**Model_Equation**</span>
<span id="cb164-1564"><a href="#cb164-1564" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb164-1565"><a href="#cb164-1565" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;p&gt;</span></span>
<span id="cb164-1566"><a href="#cb164-1566" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;span class="math display"&gt;</span></span>
<span id="cb164-1567"><a href="#cb164-1567" aria-hidden="true" tabindex="-1"></a><span class="in">        \(exports_{t} = -66757.46+0.9658\varepsilon_{t-1} +0.0257consumption_t \)&lt;/br&gt;</span></span>
<span id="cb164-1568"><a href="#cb164-1568" aria-hidden="true" tabindex="-1"></a><span class="in">        \(-2370.611fxrate_t+2.7993gdpnl_t+\varepsilon_t\)</span></span>
<span id="cb164-1569"><a href="#cb164-1569" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/span&gt;</span></span>
<span id="cb164-1570"><a href="#cb164-1570" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/p&gt;</span></span>
<span id="cb164-1571"><a href="#cb164-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1572"><a href="#cb164-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1573"><a href="#cb164-1573" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-1576"><a href="#cb164-1576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1577"><a href="#cb164-1577" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1578"><a href="#cb164-1578" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1579"><a href="#cb164-1579" aria-hidden="true" tabindex="-1"></a><span class="co"># best model fit for forcasting</span></span>
<span id="cb164-1580"><a href="#cb164-1580" aria-hidden="true" tabindex="-1"></a>xreg_env_impact <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Consumption =</span> env_impact_ts[, <span class="st">"Consumption"</span>],</span>
<span id="cb164-1581"><a href="#cb164-1581" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span>  env_impact_ts[, <span class="st">"Production"</span>])</span>
<span id="cb164-1582"><a href="#cb164-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1583"><a href="#cb164-1583" aria-hidden="true" tabindex="-1"></a>fit_env_impact_ts <span class="ot">&lt;-</span> <span class="fu">Arima</span>(env_impact_ts[, <span class="st">"co2_value"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xreg=</span>xreg_env_impact)</span>
<span id="cb164-1584"><a href="#cb164-1584" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_env_impact_ts)</span>
<span id="cb164-1585"><a href="#cb164-1585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1586"><a href="#cb164-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1587"><a href="#cb164-1587" aria-hidden="true" tabindex="-1"></a>**Model_Equation**</span>
<span id="cb164-1588"><a href="#cb164-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb164-1589"><a href="#cb164-1589" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;p&gt;</span></span>
<span id="cb164-1590"><a href="#cb164-1590" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;span class="math display"&gt;</span></span>
<span id="cb164-1591"><a href="#cb164-1591" aria-hidden="true" tabindex="-1"></a><span class="in">        \(co2emissions_{t} = -247.0346 +0.2072\varepsilon_{t-1} -0.1185 \varepsilon_{t-2}-0.8299\varepsilon_{t-12} \)&lt;/br&gt;</span></span>
<span id="cb164-1592"><a href="#cb164-1592" aria-hidden="true" tabindex="-1"></a><span class="in">        \(+(4e-04) consumption_t-(1e-04)production_t+\varepsilon_t\)</span></span>
<span id="cb164-1593"><a href="#cb164-1593" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/span&gt;</span></span>
<span id="cb164-1594"><a href="#cb164-1594" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/p&gt;</span></span>
<span id="cb164-1595"><a href="#cb164-1595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1596"><a href="#cb164-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1597"><a href="#cb164-1597" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1598"><a href="#cb164-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1599"><a href="#cb164-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting</span></span>
<span id="cb164-1600"><a href="#cb164-1600" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1601"><a href="#cb164-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1602"><a href="#cb164-1602" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Natural gas demand</span></span>
<span id="cb164-1603"><a href="#cb164-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1606"><a href="#cb164-1606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1607"><a href="#cb164-1607" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1608"><a href="#cb164-1608" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1609"><a href="#cb164-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the temperature variable</span></span>
<span id="cb164-1610"><a href="#cb164-1610" aria-hidden="true" tabindex="-1"></a>temperature_fit_demand<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(demand<span class="sc">$</span>temperature) </span>
<span id="cb164-1611"><a href="#cb164-1611" aria-hidden="true" tabindex="-1"></a>ftemperature_demand<span class="ot">&lt;-</span><span class="fu">forecast</span>(temperature_fit_demand)</span>
<span id="cb164-1612"><a href="#cb164-1612" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(temperature_fit_demand) </span>
<span id="cb164-1613"><a href="#cb164-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1614"><a href="#cb164-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1617"><a href="#cb164-1617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1618"><a href="#cb164-1618" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1619"><a href="#cb164-1619" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1620"><a href="#cb164-1620" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the Production variable</span></span>
<span id="cb164-1621"><a href="#cb164-1621" aria-hidden="true" tabindex="-1"></a>Production_fit_demand<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(demand<span class="sc">$</span>Production) </span>
<span id="cb164-1622"><a href="#cb164-1622" aria-hidden="true" tabindex="-1"></a>fProduction_demand<span class="ot">&lt;-</span><span class="fu">forecast</span>(Production_fit_demand)</span>
<span id="cb164-1623"><a href="#cb164-1623" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Production_fit_demand) </span>
<span id="cb164-1624"><a href="#cb164-1624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1625"><a href="#cb164-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1628"><a href="#cb164-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1629"><a href="#cb164-1629" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1630"><a href="#cb164-1630" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1631"><a href="#cb164-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the storage variable</span></span>
<span id="cb164-1632"><a href="#cb164-1632" aria-hidden="true" tabindex="-1"></a>storage_fit_demand<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(demand<span class="sc">$</span>storage) </span>
<span id="cb164-1633"><a href="#cb164-1633" aria-hidden="true" tabindex="-1"></a>fstorage_demand<span class="ot">&lt;-</span><span class="fu">forecast</span>(storage_fit_demand)</span>
<span id="cb164-1634"><a href="#cb164-1634" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(storage_fit_demand) </span>
<span id="cb164-1635"><a href="#cb164-1635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1636"><a href="#cb164-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1639"><a href="#cb164-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1640"><a href="#cb164-1640" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1641"><a href="#cb164-1641" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1642"><a href="#cb164-1642" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast Natural gas demand using feature variables</span></span>
<span id="cb164-1643"><a href="#cb164-1643" aria-hidden="true" tabindex="-1"></a>fxreg_demand_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">temperature =</span> ftemperature_demand<span class="sc">$</span>mean, <span class="at">Production =</span> fProduction_demand<span class="sc">$</span>mean,</span>
<span id="cb164-1644"><a href="#cb164-1644" aria-hidden="true" tabindex="-1"></a>              <span class="at">storage =</span> fstorage_demand<span class="sc">$</span>mean)</span>
<span id="cb164-1645"><a href="#cb164-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1646"><a href="#cb164-1646" aria-hidden="true" tabindex="-1"></a>fcast_demand_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_demand_ts, <span class="at">xreg=</span>fxreg_demand_ts) </span>
<span id="cb164-1647"><a href="#cb164-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1648"><a href="#cb164-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_demand_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb164-1649"><a href="#cb164-1649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Consumption"</span>)</span>
<span id="cb164-1650"><a href="#cb164-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1651"><a href="#cb164-1651" aria-hidden="true" tabindex="-1"></a>**Findings:** The data shows pronounced seasonal patterns, with sharp peaks and troughs occurring regularly each year. This pattern suggests strong seasonal influences on consumption.The amplitude of the seasonal fluctuations appears to be relatively stable over time, indicating consistent seasonal effects across the years. The forecast continues the pattern of seasonal peaks and troughs observed in the historical data, indicating that the model expects future behavior to be similar to past behavior.</span>
<span id="cb164-1652"><a href="#cb164-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1653"><a href="#cb164-1653" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Econometric Dynamics</span></span>
<span id="cb164-1654"><a href="#cb164-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1657"><a href="#cb164-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1658"><a href="#cb164-1658" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1659"><a href="#cb164-1659" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1660"><a href="#cb164-1660" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the unemp variable</span></span>
<span id="cb164-1661"><a href="#cb164-1661" aria-hidden="true" tabindex="-1"></a>unemp_fit_eco<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(eco<span class="sc">$</span>unemp) </span>
<span id="cb164-1662"><a href="#cb164-1662" aria-hidden="true" tabindex="-1"></a>funemp_eco<span class="ot">&lt;-</span><span class="fu">forecast</span>(unemp_fit_eco)</span>
<span id="cb164-1663"><a href="#cb164-1663" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(unemp_fit_eco) </span>
<span id="cb164-1664"><a href="#cb164-1664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1665"><a href="#cb164-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1668"><a href="#cb164-1668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1669"><a href="#cb164-1669" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1670"><a href="#cb164-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1671"><a href="#cb164-1671" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the GDP variable</span></span>
<span id="cb164-1672"><a href="#cb164-1672" aria-hidden="true" tabindex="-1"></a>gdp_fit_eco<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(eco<span class="sc">$</span>gdp) </span>
<span id="cb164-1673"><a href="#cb164-1673" aria-hidden="true" tabindex="-1"></a>fgdp_eco<span class="ot">&lt;-</span><span class="fu">forecast</span>(gdp_fit_eco)</span>
<span id="cb164-1674"><a href="#cb164-1674" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gdp_fit_eco) </span>
<span id="cb164-1675"><a href="#cb164-1675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1676"><a href="#cb164-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1679"><a href="#cb164-1679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1680"><a href="#cb164-1680" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1681"><a href="#cb164-1681" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1682"><a href="#cb164-1682" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast price using feature variables</span></span>
<span id="cb164-1683"><a href="#cb164-1683" aria-hidden="true" tabindex="-1"></a>fxreg_eco_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">gdp =</span> fgdp_eco<span class="sc">$</span>mean,</span>
<span id="cb164-1684"><a href="#cb164-1684" aria-hidden="true" tabindex="-1"></a>              <span class="at">unemp=</span>funemp_eco<span class="sc">$</span>mean)</span>
<span id="cb164-1685"><a href="#cb164-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1686"><a href="#cb164-1686" aria-hidden="true" tabindex="-1"></a>fcast_eco_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_eco_ts, <span class="at">xreg=</span>fxreg_eco_ts) </span>
<span id="cb164-1687"><a href="#cb164-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1688"><a href="#cb164-1688" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_eco_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-1689"><a href="#cb164-1689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prices influenced by macroeconomic factors"</span>)</span>
<span id="cb164-1690"><a href="#cb164-1690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1691"><a href="#cb164-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1692"><a href="#cb164-1692" aria-hidden="true" tabindex="-1"></a>**Findings:** The time series shows significant fluctuations and a couple of sharp peaks, particularly notable around the years 2005, 2010, and 2020. These peaks indicates market disruptions impacting the prices modeled.</span>
<span id="cb164-1693"><a href="#cb164-1693" aria-hidden="true" tabindex="-1"></a>The general trend between the peaks appears relatively stable or slowly declining, especially from around 2010 to 2015 and stabilizing with slight fluctuations thereafter until 2020. The forecast suggests a potential continuation of the recent trend seen just before 2022, which appears to be upward, suggesting an expectation of rising prices influenced by macroeconomic factors.</span>
<span id="cb164-1694"><a href="#cb164-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1695"><a href="#cb164-1695" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exports</span></span>
<span id="cb164-1696"><a href="#cb164-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1699"><a href="#cb164-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1700"><a href="#cb164-1700" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1701"><a href="#cb164-1701" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1702"><a href="#cb164-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the consumption variable</span></span>
<span id="cb164-1703"><a href="#cb164-1703" aria-hidden="true" tabindex="-1"></a>consumption_fit_export<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(export<span class="sc">$</span>consumption) </span>
<span id="cb164-1704"><a href="#cb164-1704" aria-hidden="true" tabindex="-1"></a>fconsumption_export<span class="ot">&lt;-</span><span class="fu">forecast</span>(consumption_fit_export)</span>
<span id="cb164-1705"><a href="#cb164-1705" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(consumption_fit_export) </span>
<span id="cb164-1706"><a href="#cb164-1706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1707"><a href="#cb164-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1710"><a href="#cb164-1710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1711"><a href="#cb164-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1712"><a href="#cb164-1712" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1713"><a href="#cb164-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the exchange rate variable</span></span>
<span id="cb164-1714"><a href="#cb164-1714" aria-hidden="true" tabindex="-1"></a>fx_rate_fit_export<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(export<span class="sc">$</span>fx_rate) </span>
<span id="cb164-1715"><a href="#cb164-1715" aria-hidden="true" tabindex="-1"></a>ffx_rate_export<span class="ot">&lt;-</span><span class="fu">forecast</span>(fx_rate_fit_export)</span>
<span id="cb164-1716"><a href="#cb164-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fx_rate_fit_export) </span>
<span id="cb164-1717"><a href="#cb164-1717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1718"><a href="#cb164-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1721"><a href="#cb164-1721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1722"><a href="#cb164-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1723"><a href="#cb164-1723" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1724"><a href="#cb164-1724" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the GDP variable</span></span>
<span id="cb164-1725"><a href="#cb164-1725" aria-hidden="true" tabindex="-1"></a>gdp_nl_fit_export<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(export<span class="sc">$</span>gdp_nl) </span>
<span id="cb164-1726"><a href="#cb164-1726" aria-hidden="true" tabindex="-1"></a>fgdp_nl_export<span class="ot">&lt;-</span><span class="fu">forecast</span>(gdp_nl_fit_export)</span>
<span id="cb164-1727"><a href="#cb164-1727" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gdp_nl_fit_export) </span>
<span id="cb164-1728"><a href="#cb164-1728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1729"><a href="#cb164-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1732"><a href="#cb164-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1733"><a href="#cb164-1733" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1734"><a href="#cb164-1734" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1735"><a href="#cb164-1735" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast export using feature variables</span></span>
<span id="cb164-1736"><a href="#cb164-1736" aria-hidden="true" tabindex="-1"></a>fxreg_export_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">consumption =</span> fconsumption_export<span class="sc">$</span>mean,</span>
<span id="cb164-1737"><a href="#cb164-1737" aria-hidden="true" tabindex="-1"></a>              <span class="at">fx_rate=</span>ffx_rate_export<span class="sc">$</span>mean,</span>
<span id="cb164-1738"><a href="#cb164-1738" aria-hidden="true" tabindex="-1"></a>             <span class="at">gdp_nl=</span>fgdp_nl_export<span class="sc">$</span>mean )</span>
<span id="cb164-1739"><a href="#cb164-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1740"><a href="#cb164-1740" aria-hidden="true" tabindex="-1"></a>fcast_export_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_export_ts, <span class="at">xreg=</span>fxreg_export_ts) </span>
<span id="cb164-1741"><a href="#cb164-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1742"><a href="#cb164-1742" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_export_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-1743"><a href="#cb164-1743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Exports"</span>)</span>
<span id="cb164-1744"><a href="#cb164-1744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1745"><a href="#cb164-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1746"><a href="#cb164-1746" aria-hidden="true" tabindex="-1"></a>**Findings:** There's a clear upward trend in the exports from around 2005 to approximately 2022. This suggests growth over these years.There is a particularly sharp increase in exports around the years 2015 through 2022, indicating a period of significant growth. Overall, the forecast suggests optimism about the future direction of exports, albeit with growing uncertainty as predictions extend further into the future.</span>
<span id="cb164-1747"><a href="#cb164-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1748"><a href="#cb164-1748" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CO2 Emissions</span></span>
<span id="cb164-1749"><a href="#cb164-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1752"><a href="#cb164-1752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1753"><a href="#cb164-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1754"><a href="#cb164-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1755"><a href="#cb164-1755" aria-hidden="true" tabindex="-1"></a><span class="co">#fiting an ARIMA model to the Consumption variable</span></span>
<span id="cb164-1756"><a href="#cb164-1756" aria-hidden="true" tabindex="-1"></a>Consumption_fit_env_impact<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(env_impact<span class="sc">$</span>Consumption) </span>
<span id="cb164-1757"><a href="#cb164-1757" aria-hidden="true" tabindex="-1"></a>fConsumption_env_impact<span class="ot">&lt;-</span><span class="fu">forecast</span>(Consumption_fit_env_impact)</span>
<span id="cb164-1758"><a href="#cb164-1758" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Consumption_fit_env_impact) </span>
<span id="cb164-1759"><a href="#cb164-1759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1760"><a href="#cb164-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1763"><a href="#cb164-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1764"><a href="#cb164-1764" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1765"><a href="#cb164-1765" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1766"><a href="#cb164-1766" aria-hidden="true" tabindex="-1"></a><span class="co">#fitting an ARIMA model to the Production variable</span></span>
<span id="cb164-1767"><a href="#cb164-1767" aria-hidden="true" tabindex="-1"></a>Production_fit_env_impact<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(env_impact<span class="sc">$</span>Production) </span>
<span id="cb164-1768"><a href="#cb164-1768" aria-hidden="true" tabindex="-1"></a>fProduction_env_impact<span class="ot">&lt;-</span><span class="fu">forecast</span>(Production_fit_env_impact)</span>
<span id="cb164-1769"><a href="#cb164-1769" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Production_fit_env_impact) </span>
<span id="cb164-1770"><a href="#cb164-1770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1771"><a href="#cb164-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1774"><a href="#cb164-1774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1775"><a href="#cb164-1775" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1776"><a href="#cb164-1776" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1777"><a href="#cb164-1777" aria-hidden="true" tabindex="-1"></a><span class="co"># Forcast co2 emmisions using feature variables</span></span>
<span id="cb164-1778"><a href="#cb164-1778" aria-hidden="true" tabindex="-1"></a>fxreg_env_impact_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Consumption =</span> fConsumption_env_impact<span class="sc">$</span>mean,</span>
<span id="cb164-1779"><a href="#cb164-1779" aria-hidden="true" tabindex="-1"></a>              <span class="at">Production =</span> fProduction_env_impact<span class="sc">$</span>mean)</span>
<span id="cb164-1780"><a href="#cb164-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1781"><a href="#cb164-1781" aria-hidden="true" tabindex="-1"></a>fcast_env_impact_ts <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_env_impact_ts, <span class="at">xreg=</span>fxreg_env_impact_ts) </span>
<span id="cb164-1782"><a href="#cb164-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1783"><a href="#cb164-1783" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_env_impact_ts,<span class="at">fcol =</span> <span class="st">'#92c54b'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb164-1784"><a href="#cb164-1784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"CO2 Emissions"</span>)</span>
<span id="cb164-1785"><a href="#cb164-1785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1786"><a href="#cb164-1786" aria-hidden="true" tabindex="-1"></a>**Findings:** The best model forecast maintains the seasonal pattern, but with a diminishing intensity compared to the observed trend. However, the observed trend line depicts a growing intensity, suggesting that this model may not fully capture the trend. This discrepancy indicates that the chosen exogenous variables alone might not exert a significant influence on CO2 emissions, suggesting additional regressors for a more comprehensive analysis</span>
<span id="cb164-1787"><a href="#cb164-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1788"><a href="#cb164-1788" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1789"><a href="#cb164-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1790"><a href="#cb164-1790" aria-hidden="true" tabindex="-1"></a><span class="fu">## VAR Modeling</span></span>
<span id="cb164-1791"><a href="#cb164-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1794"><a href="#cb164-1794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1795"><a href="#cb164-1795" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1796"><a href="#cb164-1796" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1797"><a href="#cb164-1797" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">cbind</span>(<span class="at">price=</span>price[, <span class="sc">-</span><span class="dv">1</span>] , <span class="at">production=</span>production[, <span class="sc">-</span><span class="dv">1</span>] , <span class="at">imports=</span>imports[, <span class="sc">-</span><span class="dv">1</span>] ))</span>
<span id="cb164-1798"><a href="#cb164-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1799"><a href="#cb164-1799" aria-hidden="true" tabindex="-1"></a>data_no_date <span class="ot">&lt;-</span> supply_dynamics[, <span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb164-1800"><a href="#cb164-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(data_no_date), <span class="at">method=</span><span class="st">'color'</span>)</span>
<span id="cb164-1801"><a href="#cb164-1801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1802"><a href="#cb164-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1803"><a href="#cb164-1803" aria-hidden="true" tabindex="-1"></a>The plots above display the relationships between price, production, and imports using scatter plots and correlation matrices. The scatter plots show potential nonlinear relationships among the variables, particularly between imports and the other two variables, while the correlation matrix reveals strong negative correlations between production and imports, and moderate correlations between prices and the other variables.</span>
<span id="cb164-1804"><a href="#cb164-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1805"><a href="#cb164-1805" aria-hidden="true" tabindex="-1"></a><span class="fu">### Time series plot</span></span>
<span id="cb164-1808"><a href="#cb164-1808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1809"><a href="#cb164-1809" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1810"><a href="#cb164-1810" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1811"><a href="#cb164-1811" aria-hidden="true" tabindex="-1"></a>price_ts <span class="ot">=</span> <span class="fu">ts</span>(price<span class="sc">$</span>price, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1812"><a href="#cb164-1812" aria-hidden="true" tabindex="-1"></a><span class="co"># # storage_ts = ts(storage$storage, start = 2005,end = c(2022,12),frequency = 12)</span></span>
<span id="cb164-1813"><a href="#cb164-1813" aria-hidden="true" tabindex="-1"></a><span class="co"># # exports_ts = ts(exports$exports, start = 2005,end = c(2022,12),frequency = 12)</span></span>
<span id="cb164-1814"><a href="#cb164-1814" aria-hidden="true" tabindex="-1"></a>imports_ts <span class="ot">=</span> <span class="fu">ts</span>(imports<span class="sc">$</span>imports, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1815"><a href="#cb164-1815" aria-hidden="true" tabindex="-1"></a><span class="co"># # temp_ts = ts(temperature$temperature, start = 2005,end = c(2022,12),frequency = 12)</span></span>
<span id="cb164-1816"><a href="#cb164-1816" aria-hidden="true" tabindex="-1"></a>production_ts <span class="ot">=</span> <span class="fu">ts</span>(production<span class="sc">$</span>Production, <span class="at">start =</span> <span class="dv">2005</span>,<span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">12</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1817"><a href="#cb164-1817" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-1818"><a href="#cb164-1818" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine precipitation and temp</span></span>
<span id="cb164-1819"><a href="#cb164-1819" aria-hidden="true" tabindex="-1"></a>supply <span class="ot">=</span> <span class="fu">cbind</span>(price_ts,imports_ts,production_ts)</span>
<span id="cb164-1820"><a href="#cb164-1820" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(supply) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"price"</span>, <span class="st">"imports"</span>,<span class="st">"production"</span>)</span>
<span id="cb164-1821"><a href="#cb164-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1822"><a href="#cb164-1822" aria-hidden="true" tabindex="-1"></a><span class="co"># supply.ts&lt;-ts(supply_dynamics,star=decimal_date(as.Date("2005-01-01",format = "%Y-%m-%d")),frequency = 12)</span></span>
<span id="cb164-1823"><a href="#cb164-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1824"><a href="#cb164-1824" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(supply, <span class="at">facets=</span><span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">"#92c54b"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb164-1825"><a href="#cb164-1825" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb164-1826"><a href="#cb164-1826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Supply Dynamics in the US"</span>)</span>
<span id="cb164-1827"><a href="#cb164-1827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1828"><a href="#cb164-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1829"><a href="#cb164-1829" aria-hidden="true" tabindex="-1"></a>The plot depicts the dynamics of U.S. natural gas prices, imports, and production over time. Prices experienced significant fluctuations, particularly with notable peaks around 2005 and 2008, stabilizing and then increasing gradually post-2015, reflecting market conditions and economic factors. Imports show a general decline from 2005 until 2012, stabilizing afterward, suggesting increased self-sufficiency in domestic production or shifts in energy policy. Production consistently rose from 2005, indicating advances in extraction technologies like hydraulic fracturing.</span>
<span id="cb164-1830"><a href="#cb164-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1831"><a href="#cb164-1831" aria-hidden="true" tabindex="-1"></a><span class="fu">### Finding Best p</span></span>
<span id="cb164-1832"><a href="#cb164-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1835"><a href="#cb164-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1836"><a href="#cb164-1836" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1837"><a href="#cb164-1837" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1838"><a href="#cb164-1838" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(supply, <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span>
<span id="cb164-1839"><a href="#cb164-1839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1840"><a href="#cb164-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1841"><a href="#cb164-1841" aria-hidden="true" tabindex="-1"></a>According to the selection criterion, p = 2, 3 and 6.Therefore, I'm fitting several models with p=1(for simplicity), 2, 3 and 6.=&gt; VAR(1), VAR(2), VAR(3), VAR(6)</span>
<span id="cb164-1842"><a href="#cb164-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1843"><a href="#cb164-1843" aria-hidden="true" tabindex="-1"></a><span class="fu">### VAR model fitting</span></span>
<span id="cb164-1844"><a href="#cb164-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1845"><a href="#cb164-1845" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb164-1846"><a href="#cb164-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1847"><a href="#cb164-1847" aria-hidden="true" tabindex="-1"></a><span class="fu">#### VAR(1)</span></span>
<span id="cb164-1848"><a href="#cb164-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1851"><a href="#cb164-1851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1852"><a href="#cb164-1852" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1853"><a href="#cb164-1853" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1854"><a href="#cb164-1854" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span>
<span id="cb164-1855"><a href="#cb164-1855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1856"><a href="#cb164-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1857"><a href="#cb164-1857" aria-hidden="true" tabindex="-1"></a><span class="fu">#### VAR(2)</span></span>
<span id="cb164-1858"><a href="#cb164-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1861"><a href="#cb164-1861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1862"><a href="#cb164-1862" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1863"><a href="#cb164-1863" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1864"><a href="#cb164-1864" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">'both'</span>))</span>
<span id="cb164-1865"><a href="#cb164-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1866"><a href="#cb164-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1867"><a href="#cb164-1867" aria-hidden="true" tabindex="-1"></a><span class="fu">#### VAR(3)</span></span>
<span id="cb164-1870"><a href="#cb164-1870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1871"><a href="#cb164-1871" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1872"><a href="#cb164-1872" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1873"><a href="#cb164-1873" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>))</span>
<span id="cb164-1874"><a href="#cb164-1874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1875"><a href="#cb164-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1876"><a href="#cb164-1876" aria-hidden="true" tabindex="-1"></a><span class="fu">#### VAR(6)</span></span>
<span id="cb164-1877"><a href="#cb164-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1880"><a href="#cb164-1880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1881"><a href="#cb164-1881" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1882"><a href="#cb164-1882" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1883"><a href="#cb164-1883" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">6</span>, <span class="at">type=</span><span class="st">'both'</span>))</span>
<span id="cb164-1884"><a href="#cb164-1884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-1885"><a href="#cb164-1885" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb164-1886"><a href="#cb164-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1887"><a href="#cb164-1887" aria-hidden="true" tabindex="-1"></a>We can see that some models have some variables significant but not all. Let's proceed with cross validation.</span>
<span id="cb164-1888"><a href="#cb164-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1889"><a href="#cb164-1889" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cross validation</span></span>
<span id="cb164-1890"><a href="#cb164-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1891"><a href="#cb164-1891" aria-hidden="true" tabindex="-1"></a>I’m using Cross validation to find the best model.</span>
<span id="cb164-1892"><a href="#cb164-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1895"><a href="#cb164-1895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-1896"><a href="#cb164-1896" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-1897"><a href="#cb164-1897" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-1898"><a href="#cb164-1898" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(price_ts)</span>
<span id="cb164-1899"><a href="#cb164-1899" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">15</span></span>
<span id="cb164-1900"><a href="#cb164-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1901"><a href="#cb164-1901" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb164-1902"><a href="#cb164-1902" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb164-1903"><a href="#cb164-1903" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb164-1904"><a href="#cb164-1904" aria-hidden="true" tabindex="-1"></a>rmse4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n<span class="sc">-</span>k,<span class="dv">12</span>)</span>
<span id="cb164-1905"><a href="#cb164-1905" aria-hidden="true" tabindex="-1"></a>year<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb164-1906"><a href="#cb164-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1907"><a href="#cb164-1907" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data frame to time series object</span></span>
<span id="cb164-1908"><a href="#cb164-1908" aria-hidden="true" tabindex="-1"></a>ts_obj <span class="ot">&lt;-</span> <span class="fu">ts</span>(supply, <span class="at">star=</span><span class="fu">decimal_date</span>(<span class="fu">as.Date</span>(<span class="st">"2005-01-01"</span>,<span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1909"><a href="#cb164-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1910"><a href="#cb164-1910" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(ts_obj )[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb164-1911"><a href="#cb164-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1912"><a href="#cb164-1912" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb164-1913"><a href="#cb164-1913" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb164-1914"><a href="#cb164-1914" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1915"><a href="#cb164-1915" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_obj, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb164-1916"><a href="#cb164-1916" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_obj, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb164-1917"><a href="#cb164-1917" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1918"><a href="#cb164-1918" aria-hidden="true" tabindex="-1"></a>  <span class="do">######## first Model ############</span></span>
<span id="cb164-1919"><a href="#cb164-1919" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb164-1920"><a href="#cb164-1920" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb164-1921"><a href="#cb164-1921" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1922"><a href="#cb164-1922" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb164-1923"><a href="#cb164-1923" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb164-1924"><a href="#cb164-1924" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb164-1925"><a href="#cb164-1925" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb164-1926"><a href="#cb164-1926" aria-hidden="true" tabindex="-1"></a>  ff<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>]) <span class="co">#collecting the forecasts for 3 variables</span></span>
<span id="cb164-1927"><a href="#cb164-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1928"><a href="#cb164-1928" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span> <span class="co">#starting year</span></span>
<span id="cb164-1929"><a href="#cb164-1929" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1930"><a href="#cb164-1930" aria-hidden="true" tabindex="-1"></a>  ff<span class="ot">&lt;-</span><span class="fu">ts</span>(ff,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1931"><a href="#cb164-1931" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1932"><a href="#cb164-1932" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb164-1933"><a href="#cb164-1933" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb164-1934"><a href="#cb164-1934" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1935"><a href="#cb164-1935" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### collecting errors ######</span></span>
<span id="cb164-1936"><a href="#cb164-1936" aria-hidden="true" tabindex="-1"></a>  rmse1[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb164-1937"><a href="#cb164-1937" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1938"><a href="#cb164-1938" aria-hidden="true" tabindex="-1"></a>  <span class="do">######## Second Model ############</span></span>
<span id="cb164-1939"><a href="#cb164-1939" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb164-1940"><a href="#cb164-1940" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb164-1941"><a href="#cb164-1941" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1942"><a href="#cb164-1942" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast2<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb164-1943"><a href="#cb164-1943" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast2<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb164-1944"><a href="#cb164-1944" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast2<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb164-1945"><a href="#cb164-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1946"><a href="#cb164-1946" aria-hidden="true" tabindex="-1"></a>  ff2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>])</span>
<span id="cb164-1947"><a href="#cb164-1947" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1948"><a href="#cb164-1948" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb164-1949"><a href="#cb164-1949" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1950"><a href="#cb164-1950" aria-hidden="true" tabindex="-1"></a>  ff2<span class="ot">&lt;-</span><span class="fu">ts</span>(ff2,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1951"><a href="#cb164-1951" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1952"><a href="#cb164-1952" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb164-1953"><a href="#cb164-1953" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb164-1954"><a href="#cb164-1954" aria-hidden="true" tabindex="-1"></a>  rmse2[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff2<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb164-1955"><a href="#cb164-1955" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1956"><a href="#cb164-1956" aria-hidden="true" tabindex="-1"></a>    <span class="do">######## Third Model ############</span></span>
<span id="cb164-1957"><a href="#cb164-1957" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb164-1958"><a href="#cb164-1958" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit3, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb164-1959"><a href="#cb164-1959" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1960"><a href="#cb164-1960" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast3<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb164-1961"><a href="#cb164-1961" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast3<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb164-1962"><a href="#cb164-1962" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast3<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb164-1963"><a href="#cb164-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1964"><a href="#cb164-1964" aria-hidden="true" tabindex="-1"></a>  ff3<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>])</span>
<span id="cb164-1965"><a href="#cb164-1965" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1966"><a href="#cb164-1966" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb164-1967"><a href="#cb164-1967" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1968"><a href="#cb164-1968" aria-hidden="true" tabindex="-1"></a>  ff3<span class="ot">&lt;-</span><span class="fu">ts</span>(ff3,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1969"><a href="#cb164-1969" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1970"><a href="#cb164-1970" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb164-1971"><a href="#cb164-1971" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb164-1972"><a href="#cb164-1972" aria-hidden="true" tabindex="-1"></a>  rmse3[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff3<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb164-1973"><a href="#cb164-1973" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1974"><a href="#cb164-1974" aria-hidden="true" tabindex="-1"></a>      <span class="do">######## Fourth Model ############</span></span>
<span id="cb164-1975"><a href="#cb164-1975" aria-hidden="true" tabindex="-1"></a>  fit4 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(ts_obj, <span class="at">p=</span><span class="dv">6</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb164-1976"><a href="#cb164-1976" aria-hidden="true" tabindex="-1"></a>  fcast4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit4, <span class="at">n.ahead =</span> <span class="dv">3</span>)</span>
<span id="cb164-1977"><a href="#cb164-1977" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1978"><a href="#cb164-1978" aria-hidden="true" tabindex="-1"></a>  fprice<span class="ot">&lt;-</span>fcast4<span class="sc">$</span>fcst<span class="sc">$</span>price</span>
<span id="cb164-1979"><a href="#cb164-1979" aria-hidden="true" tabindex="-1"></a>  fimports<span class="ot">&lt;-</span>fcast4<span class="sc">$</span>fcst<span class="sc">$</span>imports</span>
<span id="cb164-1980"><a href="#cb164-1980" aria-hidden="true" tabindex="-1"></a>  fprod<span class="ot">&lt;-</span>fcast4<span class="sc">$</span>fcst<span class="sc">$</span>production</span>
<span id="cb164-1981"><a href="#cb164-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1982"><a href="#cb164-1982" aria-hidden="true" tabindex="-1"></a>  ff4<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fprice[,<span class="dv">1</span>],fimports[,<span class="dv">1</span>],fprod[,<span class="dv">1</span>])</span>
<span id="cb164-1983"><a href="#cb164-1983" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1984"><a href="#cb164-1984" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">&lt;-</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb164-1985"><a href="#cb164-1985" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1986"><a href="#cb164-1986" aria-hidden="true" tabindex="-1"></a>  ff4<span class="ot">&lt;-</span><span class="fu">ts</span>(ff4,<span class="at">start=</span><span class="fu">c</span>(year,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb164-1987"><a href="#cb164-1987" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1988"><a href="#cb164-1988" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i<span class="dv">-11</span> <span class="co">#going from 1,13,25,37</span></span>
<span id="cb164-1989"><a href="#cb164-1989" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>i <span class="co">#12, 24, 36</span></span>
<span id="cb164-1990"><a href="#cb164-1990" aria-hidden="true" tabindex="-1"></a>  rmse4[<span class="fu">c</span>(a<span class="sc">:</span>b),]  <span class="ot">&lt;-</span><span class="fu">sqrt</span>((ff4<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb164-1991"><a href="#cb164-1991" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-1992"><a href="#cb164-1992" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-1993"><a href="#cb164-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-1994"><a href="#cb164-1994" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>, <span class="at">main=</span><span class="st">"RMSE plot for supply"</span>)</span>
<span id="cb164-1995"><a href="#cb164-1995" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb164-1996"><a href="#cb164-1996" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse3,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb164-1997"><a href="#cb164-1997" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">colMeans</span>(rmse4,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">5</span>)</span>
<span id="cb164-1998"><a href="#cb164-1998" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"VAR 1"</span>,<span class="st">"VAR 2"</span>,<span class="st">"VAR 3"</span>,<span class="st">"VAR 6"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb164-1999"><a href="#cb164-1999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-2000"><a href="#cb164-2000" aria-hidden="true" tabindex="-1"></a>VAR(1) has lower RMSE than other VAR models , therefore VAR(1) is a better fit. </span>
<span id="cb164-2001"><a href="#cb164-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2002"><a href="#cb164-2002" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Equation   </span></span>
<span id="cb164-2003"><a href="#cb164-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2004"><a href="#cb164-2004" aria-hidden="true" tabindex="-1"></a>Model Equation for best model VAR(1)</span>
<span id="cb164-2005"><a href="#cb164-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2006"><a href="#cb164-2006" aria-hidden="true" tabindex="-1"></a>Using notation I= imports, t= time, Pr= prices, and P= production</span>
<span id="cb164-2007"><a href="#cb164-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2008"><a href="#cb164-2008" aria-hidden="true" tabindex="-1"></a>$\hat{Pr}=-(9.641e-01) -(8.060e-03)t+(8.913e-01)Pr_{t-1}+(7.834e-07)I_{t-1}+(7.985e-07)P_{t-1}$</span>
<span id="cb164-2009"><a href="#cb164-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2010"><a href="#cb164-2010" aria-hidden="true" tabindex="-1"></a>$\hat{I}=(1.099e+05) -(8.361e+01)t+(2.603e+03)Pr_{t-1}+(6.790e-01)I_{t-1}-(9.263e-03)P_{t-1}$</span>
<span id="cb164-2011"><a href="#cb164-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2012"><a href="#cb164-2012" aria-hidden="true" tabindex="-1"></a>$\hat{P}=( 8.823e+05) +( 3.814e+03 )t+(1.924e+04 )Pr_{t-1}-(6.366e-01)I_{t-1}-(5.458e-01)P_{t-1}$</span>
<span id="cb164-2013"><a href="#cb164-2013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2014"><a href="#cb164-2014" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting</span></span>
<span id="cb164-2015"><a href="#cb164-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-2018"><a href="#cb164-2018" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb164-2019"><a href="#cb164-2019" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb164-2020"><a href="#cb164-2020" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb164-2021"><a href="#cb164-2021" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(supply, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">"const"</span>)</span>
<span id="cb164-2022"><a href="#cb164-2022" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(var1) <span class="sc">%&gt;%</span></span>
<span id="cb164-2023"><a href="#cb164-2023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">color =</span> <span class="st">'#68893c'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb164-2024"><a href="#cb164-2024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb164-2025"><a href="#cb164-2025" aria-hidden="true" tabindex="-1"></a>**Findings:** Imports shows a generally stable trend in imports, with minor fluctuations but no significant changes indicated towards the future. The price forecast indicates a slight uptick following a period of stability, suggesting a possible increase in market prices in the near future. This could be due to external market pressures. The production forecast shows a slight decline. This suggests potential challenges or constraints that might affect production capabilities in the future. These observations suggest that while imports remain stable and prices might see a small decrease, production could face some downward pressure moving forward.</span>
<span id="cb164-2026"><a href="#cb164-2026" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2024, Samiksha Rajendra Thikekar</div>
  </div>
</footer>



</body></html>